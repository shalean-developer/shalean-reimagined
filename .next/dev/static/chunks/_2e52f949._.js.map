{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/27825/shalean-v2/shalean-reimagined/app/admin/actions.ts"],"sourcesContent":["'use server';\r\n\r\nimport { createClient } from '@/lib/supabase/server';\r\nimport { createAdminClient } from '@/lib/supabase/server-admin';\r\nimport { Booking } from '@/types/booking';\r\nimport { Cleaner } from '@/types/booking';\r\nimport { Profile } from '@/types/profile';\r\n\r\n/**\r\n * Check if user is an admin\r\n * Admins are identified by email pattern: *@admin.shalean.local\r\n * or user metadata with role: 'admin'\r\n */\r\nfunction isAdminUser(email: string | undefined, userMetadata?: any): boolean {\r\n  if (!email) return false;\r\n  \r\n  // Check email pattern\r\n  if (email.includes('@admin.shalean.local')) {\r\n    return true;\r\n  }\r\n  \r\n  // Check user metadata\r\n  if (userMetadata?.role === 'admin') {\r\n    return true;\r\n  }\r\n  \r\n  // Hardcoded admin emails (fallback)\r\n  const adminEmails = [\r\n    'admin@shalean.local',\r\n    'admin@admin.shalean.local',\r\n    'admin@shalean.com',\r\n  ];\r\n  \r\n  return adminEmails.includes(email.toLowerCase());\r\n}\r\n\r\n/**\r\n * Get current authenticated admin\r\n */\r\nexport async function getCurrentAdmin(): Promise<{\r\n  success: boolean;\r\n  admin?: {\r\n    id: string;\r\n    email: string;\r\n    name?: string;\r\n  };\r\n  error?: string;\r\n}> {\r\n  try {\r\n    const supabase = await createClient();\r\n    const { data: { user }, error: authError } = await supabase.auth.getUser();\r\n\r\n    if (authError || !user) {\r\n      return { success: false, error: 'Not authenticated' };\r\n    }\r\n\r\n    // Check if user is admin\r\n    if (!isAdminUser(user.email, user.user_metadata)) {\r\n      return { success: false, error: 'Not an admin user' };\r\n    }\r\n\r\n    return {\r\n      success: true,\r\n      admin: {\r\n        id: user.id,\r\n        email: user.email!,\r\n        name: user.user_metadata?.name || user.email?.split('@')[0],\r\n      },\r\n    };\r\n  } catch (error) {\r\n    console.error('Error in getCurrentAdmin:', error);\r\n    return {\r\n      success: false,\r\n      error: error instanceof Error ? error.message : 'Failed to get admin',\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * Authenticate admin (server-side)\r\n * Note: Actual authentication happens client-side, this just verifies the result\r\n */\r\nexport async function authenticateAdmin(\r\n  email: string,\r\n  password: string\r\n): Promise<{\r\n  success: boolean;\r\n  admin?: {\r\n    id: string;\r\n    email: string;\r\n    name?: string;\r\n  };\r\n  error?: string;\r\n}> {\r\n  try {\r\n    // Check if email matches admin pattern\r\n    if (!isAdminUser(email)) {\r\n      return { success: false, error: 'Not an admin email' };\r\n    }\r\n\r\n    // Authentication happens client-side, this is just validation\r\n    const supabase = await createClient();\r\n    const { data, error } = await supabase.auth.signInWithPassword({\r\n      email,\r\n      password,\r\n    });\r\n\r\n    if (error || !data.user) {\r\n      return { success: false, error: 'Invalid credentials' };\r\n    }\r\n\r\n    return {\r\n      success: true,\r\n      admin: {\r\n        id: data.user.id,\r\n        email: data.user.email!,\r\n        name: data.user.user_metadata?.name || data.user.email?.split('@')[0],\r\n      },\r\n    };\r\n  } catch (error) {\r\n    console.error('Error in authenticateAdmin:', error);\r\n    return {\r\n      success: false,\r\n      error: error instanceof Error ? error.message : 'Authentication failed',\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * Get admin statistics\r\n */\r\nexport async function getAdminStats(): Promise<{\r\n  success: boolean;\r\n  stats?: {\r\n    totalBookings: number;\r\n    activeBookings: number;\r\n    totalRevenue: number;\r\n    monthlyRevenue: number;\r\n    totalCustomers: number;\r\n    totalCleaners: number;\r\n    activeCleaners: number;\r\n    completionRate: number;\r\n  };\r\n  error?: string;\r\n}> {\r\n  try {\r\n    // Verify admin access\r\n    const adminResult = await getCurrentAdmin();\r\n    if (!adminResult.success) {\r\n      return { success: false, error: 'Not authenticated as admin' };\r\n    }\r\n\r\n    const supabase = createAdminClient();\r\n\r\n    // Get all bookings\r\n    const { data: bookings, error: bookingsError } = await supabase\r\n      .from('bookings')\r\n      .select('status, total_amount, payment_status, service_date, created_at');\r\n\r\n    if (bookingsError) {\r\n      console.error('Error fetching bookings:', bookingsError);\r\n      return { success: false, error: bookingsError.message };\r\n    }\r\n\r\n    // Get all customers (profiles)\r\n    const { data: customers, error: customersError } = await supabase\r\n      .from('profiles')\r\n      .select('id');\r\n\r\n    if (customersError) {\r\n      console.error('Error fetching customers:', customersError);\r\n      return { success: false, error: customersError.message };\r\n    }\r\n\r\n    // Get all cleaners\r\n    const { data: cleaners, error: cleanersError } = await supabase\r\n      .from('cleaners')\r\n      .select('id, is_active');\r\n\r\n    if (cleanersError) {\r\n      console.error('Error fetching cleaners:', cleanersError);\r\n      return { success: false, error: cleanersError.message };\r\n    }\r\n\r\n    const today = new Date().toISOString().split('T')[0];\r\n    const now = new Date();\r\n    const firstDayOfMonth = new Date(now.getFullYear(), now.getMonth(), 1).toISOString().split('T')[0];\r\n\r\n    const allBookings = bookings || [];\r\n    const activeBookings = allBookings.filter(\r\n      (b) => ['pending', 'confirmed', 'on_my_way', 'started'].includes(b.status)\r\n    ).length;\r\n    \r\n    const paidBookings = allBookings.filter((b) => b.payment_status === 'paid');\r\n    const totalRevenue = paidBookings.reduce((sum, b) => sum + (b.total_amount || 0), 0);\r\n    \r\n    const monthlyPaidBookings = allBookings.filter(\r\n      (b) => b.payment_status === 'paid' && b.service_date >= firstDayOfMonth\r\n    );\r\n    const monthlyRevenue = monthlyPaidBookings.reduce((sum, b) => sum + (b.total_amount || 0), 0);\r\n\r\n    const completedBookings = allBookings.filter((b) => b.status === 'completed').length;\r\n    const completionRate = allBookings.length > 0 ? (completedBookings / allBookings.length) * 100 : 0;\r\n\r\n    const allCleaners = cleaners || [];\r\n    const activeCleaners = allCleaners.filter((c) => c.is_active).length;\r\n\r\n    return {\r\n      success: true,\r\n      stats: {\r\n        totalBookings: allBookings.length,\r\n        activeBookings,\r\n        totalRevenue,\r\n        monthlyRevenue,\r\n        totalCustomers: customers?.length || 0,\r\n        totalCleaners: allCleaners.length,\r\n        activeCleaners,\r\n        completionRate: Math.round(completionRate * 100) / 100,\r\n      },\r\n    };\r\n  } catch (error) {\r\n    console.error('Error in getAdminStats:', error);\r\n    return {\r\n      success: false,\r\n      error: error instanceof Error ? error.message : 'Failed to fetch stats',\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * Get all bookings with optional filters\r\n */\r\nexport async function getAllBookings(\r\n  filter?: {\r\n    status?: string;\r\n    dateFrom?: string;\r\n    dateTo?: string;\r\n    customerEmail?: string;\r\n    cleanerId?: string;\r\n  }\r\n): Promise<{\r\n  success: boolean;\r\n  bookings?: Booking[];\r\n  error?: string;\r\n}> {\r\n  try {\r\n    // Verify admin access\r\n    const adminResult = await getCurrentAdmin();\r\n    if (!adminResult.success) {\r\n      return { success: false, error: 'Not authenticated as admin' };\r\n    }\r\n\r\n    const supabase = createAdminClient();\r\n\r\n    let query = supabase\r\n      .from('bookings')\r\n      .select('*')\r\n      .order('service_date', { ascending: false })\r\n      .order('created_at', { ascending: false });\r\n\r\n    if (filter) {\r\n      if (filter.status && filter.status !== 'all') {\r\n        query = query.eq('status', filter.status);\r\n      }\r\n      if (filter.dateFrom) {\r\n        query = query.gte('service_date', filter.dateFrom);\r\n      }\r\n      if (filter.dateTo) {\r\n        query = query.lte('service_date', filter.dateTo);\r\n      }\r\n      if (filter.customerEmail) {\r\n        query = query.eq('customer_email', filter.customerEmail);\r\n      }\r\n      if (filter.cleanerId) {\r\n        query = query.eq('preferred_cleaner_id', filter.cleanerId);\r\n      }\r\n    }\r\n\r\n    const { data, error } = await query;\r\n\r\n    if (error) {\r\n      console.error('Error fetching bookings:', error);\r\n      return { success: false, error: error.message };\r\n    }\r\n\r\n    return { success: true, bookings: data || [] };\r\n  } catch (error) {\r\n    console.error('Error in getAllBookings:', error);\r\n    return {\r\n      success: false,\r\n      error: error instanceof Error ? error.message : 'Failed to fetch bookings',\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * Get all customers\r\n */\r\nexport async function getAllCustomers(): Promise<{\r\n  success: boolean;\r\n  customers?: Profile[];\r\n  error?: string;\r\n}> {\r\n  try {\r\n    // Verify admin access\r\n    const adminResult = await getCurrentAdmin();\r\n    if (!adminResult.success) {\r\n      return { success: false, error: 'Not authenticated as admin' };\r\n    }\r\n\r\n    const supabase = createAdminClient();\r\n\r\n    const { data, error } = await supabase\r\n      .from('profiles')\r\n      .select('*')\r\n      .order('created_at', { ascending: false });\r\n\r\n    if (error) {\r\n      console.error('Error fetching customers:', error);\r\n      return { success: false, error: error.message };\r\n    }\r\n\r\n    return { success: true, customers: data || [] };\r\n  } catch (error) {\r\n    console.error('Error in getAllCustomers:', error);\r\n    return {\r\n      success: false,\r\n      error: error instanceof Error ? error.message : 'Failed to fetch customers',\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * Get all cleaners\r\n */\r\nexport async function getAllCleaners(): Promise<{\r\n  success: boolean;\r\n  cleaners?: Cleaner[];\r\n  error?: string;\r\n}> {\r\n  try {\r\n    // Verify admin access\r\n    const adminResult = await getCurrentAdmin();\r\n    if (!adminResult.success) {\r\n      return { success: false, error: 'Not authenticated as admin' };\r\n    }\r\n\r\n    const supabase = createAdminClient();\r\n\r\n    const { data, error } = await supabase\r\n      .from('cleaners')\r\n      .select('*')\r\n      .order('created_at', { ascending: false });\r\n\r\n    if (error) {\r\n      console.error('Error fetching cleaners:', error);\r\n      return { success: false, error: error.message };\r\n    }\r\n\r\n    return { success: true, cleaners: data || [] };\r\n  } catch (error) {\r\n    console.error('Error in getAllCleaners:', error);\r\n    return {\r\n      success: false,\r\n      error: error instanceof Error ? error.message : 'Failed to fetch cleaners',\r\n    };\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;;MA0SsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,mDAAA"}},
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/27825/shalean-v2/shalean-reimagined/app/admin/actions.ts"],"sourcesContent":["'use server';\r\n\r\nimport { createClient } from '@/lib/supabase/server';\r\nimport { createAdminClient } from '@/lib/supabase/server-admin';\r\nimport { Booking } from '@/types/booking';\r\nimport { Cleaner } from '@/types/booking';\r\nimport { Profile } from '@/types/profile';\r\n\r\n/**\r\n * Check if user is an admin\r\n * Admins are identified by email pattern: *@admin.shalean.local\r\n * or user metadata with role: 'admin'\r\n */\r\nfunction isAdminUser(email: string | undefined, userMetadata?: any): boolean {\r\n  if (!email) return false;\r\n  \r\n  // Check email pattern\r\n  if (email.includes('@admin.shalean.local')) {\r\n    return true;\r\n  }\r\n  \r\n  // Check user metadata\r\n  if (userMetadata?.role === 'admin') {\r\n    return true;\r\n  }\r\n  \r\n  // Hardcoded admin emails (fallback)\r\n  const adminEmails = [\r\n    'admin@shalean.local',\r\n    'admin@admin.shalean.local',\r\n    'admin@shalean.com',\r\n  ];\r\n  \r\n  return adminEmails.includes(email.toLowerCase());\r\n}\r\n\r\n/**\r\n * Get current authenticated admin\r\n */\r\nexport async function getCurrentAdmin(): Promise<{\r\n  success: boolean;\r\n  admin?: {\r\n    id: string;\r\n    email: string;\r\n    name?: string;\r\n  };\r\n  error?: string;\r\n}> {\r\n  try {\r\n    const supabase = await createClient();\r\n    const { data: { user }, error: authError } = await supabase.auth.getUser();\r\n\r\n    if (authError || !user) {\r\n      return { success: false, error: 'Not authenticated' };\r\n    }\r\n\r\n    // Check if user is admin\r\n    if (!isAdminUser(user.email, user.user_metadata)) {\r\n      return { success: false, error: 'Not an admin user' };\r\n    }\r\n\r\n    return {\r\n      success: true,\r\n      admin: {\r\n        id: user.id,\r\n        email: user.email!,\r\n        name: user.user_metadata?.name || user.email?.split('@')[0],\r\n      },\r\n    };\r\n  } catch (error) {\r\n    console.error('Error in getCurrentAdmin:', error);\r\n    return {\r\n      success: false,\r\n      error: error instanceof Error ? error.message : 'Failed to get admin',\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * Authenticate admin (server-side)\r\n * Note: Actual authentication happens client-side, this just verifies the result\r\n */\r\nexport async function authenticateAdmin(\r\n  email: string,\r\n  password: string\r\n): Promise<{\r\n  success: boolean;\r\n  admin?: {\r\n    id: string;\r\n    email: string;\r\n    name?: string;\r\n  };\r\n  error?: string;\r\n}> {\r\n  try {\r\n    // Check if email matches admin pattern\r\n    if (!isAdminUser(email)) {\r\n      return { success: false, error: 'Not an admin email' };\r\n    }\r\n\r\n    // Authentication happens client-side, this is just validation\r\n    const supabase = await createClient();\r\n    const { data, error } = await supabase.auth.signInWithPassword({\r\n      email,\r\n      password,\r\n    });\r\n\r\n    if (error || !data.user) {\r\n      return { success: false, error: 'Invalid credentials' };\r\n    }\r\n\r\n    return {\r\n      success: true,\r\n      admin: {\r\n        id: data.user.id,\r\n        email: data.user.email!,\r\n        name: data.user.user_metadata?.name || data.user.email?.split('@')[0],\r\n      },\r\n    };\r\n  } catch (error) {\r\n    console.error('Error in authenticateAdmin:', error);\r\n    return {\r\n      success: false,\r\n      error: error instanceof Error ? error.message : 'Authentication failed',\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * Get admin statistics\r\n */\r\nexport async function getAdminStats(): Promise<{\r\n  success: boolean;\r\n  stats?: {\r\n    totalBookings: number;\r\n    activeBookings: number;\r\n    totalRevenue: number;\r\n    monthlyRevenue: number;\r\n    totalCustomers: number;\r\n    totalCleaners: number;\r\n    activeCleaners: number;\r\n    completionRate: number;\r\n  };\r\n  error?: string;\r\n}> {\r\n  try {\r\n    // Verify admin access\r\n    const adminResult = await getCurrentAdmin();\r\n    if (!adminResult.success) {\r\n      return { success: false, error: 'Not authenticated as admin' };\r\n    }\r\n\r\n    const supabase = createAdminClient();\r\n\r\n    // Get all bookings\r\n    const { data: bookings, error: bookingsError } = await supabase\r\n      .from('bookings')\r\n      .select('status, total_amount, payment_status, service_date, created_at');\r\n\r\n    if (bookingsError) {\r\n      console.error('Error fetching bookings:', bookingsError);\r\n      return { success: false, error: bookingsError.message };\r\n    }\r\n\r\n    // Get all customers (profiles)\r\n    const { data: customers, error: customersError } = await supabase\r\n      .from('profiles')\r\n      .select('id');\r\n\r\n    if (customersError) {\r\n      console.error('Error fetching customers:', customersError);\r\n      return { success: false, error: customersError.message };\r\n    }\r\n\r\n    // Get all cleaners\r\n    const { data: cleaners, error: cleanersError } = await supabase\r\n      .from('cleaners')\r\n      .select('id, is_active');\r\n\r\n    if (cleanersError) {\r\n      console.error('Error fetching cleaners:', cleanersError);\r\n      return { success: false, error: cleanersError.message };\r\n    }\r\n\r\n    const today = new Date().toISOString().split('T')[0];\r\n    const now = new Date();\r\n    const firstDayOfMonth = new Date(now.getFullYear(), now.getMonth(), 1).toISOString().split('T')[0];\r\n\r\n    const allBookings = bookings || [];\r\n    const activeBookings = allBookings.filter(\r\n      (b) => ['pending', 'confirmed', 'on_my_way', 'started'].includes(b.status)\r\n    ).length;\r\n    \r\n    const paidBookings = allBookings.filter((b) => b.payment_status === 'paid');\r\n    const totalRevenue = paidBookings.reduce((sum, b) => sum + (b.total_amount || 0), 0);\r\n    \r\n    const monthlyPaidBookings = allBookings.filter(\r\n      (b) => b.payment_status === 'paid' && b.service_date >= firstDayOfMonth\r\n    );\r\n    const monthlyRevenue = monthlyPaidBookings.reduce((sum, b) => sum + (b.total_amount || 0), 0);\r\n\r\n    const completedBookings = allBookings.filter((b) => b.status === 'completed').length;\r\n    const completionRate = allBookings.length > 0 ? (completedBookings / allBookings.length) * 100 : 0;\r\n\r\n    const allCleaners = cleaners || [];\r\n    const activeCleaners = allCleaners.filter((c) => c.is_active).length;\r\n\r\n    return {\r\n      success: true,\r\n      stats: {\r\n        totalBookings: allBookings.length,\r\n        activeBookings,\r\n        totalRevenue,\r\n        monthlyRevenue,\r\n        totalCustomers: customers?.length || 0,\r\n        totalCleaners: allCleaners.length,\r\n        activeCleaners,\r\n        completionRate: Math.round(completionRate * 100) / 100,\r\n      },\r\n    };\r\n  } catch (error) {\r\n    console.error('Error in getAdminStats:', error);\r\n    return {\r\n      success: false,\r\n      error: error instanceof Error ? error.message : 'Failed to fetch stats',\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * Get all bookings with optional filters\r\n */\r\nexport async function getAllBookings(\r\n  filter?: {\r\n    status?: string;\r\n    dateFrom?: string;\r\n    dateTo?: string;\r\n    customerEmail?: string;\r\n    cleanerId?: string;\r\n  }\r\n): Promise<{\r\n  success: boolean;\r\n  bookings?: Booking[];\r\n  error?: string;\r\n}> {\r\n  try {\r\n    // Verify admin access\r\n    const adminResult = await getCurrentAdmin();\r\n    if (!adminResult.success) {\r\n      return { success: false, error: 'Not authenticated as admin' };\r\n    }\r\n\r\n    const supabase = createAdminClient();\r\n\r\n    let query = supabase\r\n      .from('bookings')\r\n      .select('*')\r\n      .order('service_date', { ascending: false })\r\n      .order('created_at', { ascending: false });\r\n\r\n    if (filter) {\r\n      if (filter.status && filter.status !== 'all') {\r\n        query = query.eq('status', filter.status);\r\n      }\r\n      if (filter.dateFrom) {\r\n        query = query.gte('service_date', filter.dateFrom);\r\n      }\r\n      if (filter.dateTo) {\r\n        query = query.lte('service_date', filter.dateTo);\r\n      }\r\n      if (filter.customerEmail) {\r\n        query = query.eq('customer_email', filter.customerEmail);\r\n      }\r\n      if (filter.cleanerId) {\r\n        query = query.eq('preferred_cleaner_id', filter.cleanerId);\r\n      }\r\n    }\r\n\r\n    const { data, error } = await query;\r\n\r\n    if (error) {\r\n      console.error('Error fetching bookings:', error);\r\n      return { success: false, error: error.message };\r\n    }\r\n\r\n    return { success: true, bookings: data || [] };\r\n  } catch (error) {\r\n    console.error('Error in getAllBookings:', error);\r\n    return {\r\n      success: false,\r\n      error: error instanceof Error ? error.message : 'Failed to fetch bookings',\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * Get all customers\r\n */\r\nexport async function getAllCustomers(): Promise<{\r\n  success: boolean;\r\n  customers?: Profile[];\r\n  error?: string;\r\n}> {\r\n  try {\r\n    // Verify admin access\r\n    const adminResult = await getCurrentAdmin();\r\n    if (!adminResult.success) {\r\n      return { success: false, error: 'Not authenticated as admin' };\r\n    }\r\n\r\n    const supabase = createAdminClient();\r\n\r\n    const { data, error } = await supabase\r\n      .from('profiles')\r\n      .select('*')\r\n      .order('created_at', { ascending: false });\r\n\r\n    if (error) {\r\n      console.error('Error fetching customers:', error);\r\n      return { success: false, error: error.message };\r\n    }\r\n\r\n    return { success: true, customers: data || [] };\r\n  } catch (error) {\r\n    console.error('Error in getAllCustomers:', error);\r\n    return {\r\n      success: false,\r\n      error: error instanceof Error ? error.message : 'Failed to fetch customers',\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * Get all cleaners\r\n */\r\nexport async function getAllCleaners(): Promise<{\r\n  success: boolean;\r\n  cleaners?: Cleaner[];\r\n  error?: string;\r\n}> {\r\n  try {\r\n    // Verify admin access\r\n    const adminResult = await getCurrentAdmin();\r\n    if (!adminResult.success) {\r\n      return { success: false, error: 'Not authenticated as admin' };\r\n    }\r\n\r\n    const supabase = createAdminClient();\r\n\r\n    const { data, error } = await supabase\r\n      .from('cleaners')\r\n      .select('*')\r\n      .order('created_at', { ascending: false });\r\n\r\n    if (error) {\r\n      console.error('Error fetching cleaners:', error);\r\n      return { success: false, error: error.message };\r\n    }\r\n\r\n    return { success: true, cleaners: data || [] };\r\n  } catch (error) {\r\n    console.error('Error in getAllCleaners:', error);\r\n    return {\r\n      success: false,\r\n      error: error instanceof Error ? error.message : 'Failed to fetch cleaners',\r\n    };\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;;MA+UsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,kDAAA"}},
    {"offset": {"line": 38, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/27825/shalean-v2/shalean-reimagined/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\";\r\n\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nconst Card = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(({ className, ...props }, ref) => (\r\n  <div ref={ref} className={cn(\"rounded-lg border bg-card text-card-foreground shadow-sm\", className)} {...props} />\r\n));\r\nCard.displayName = \"Card\";\r\n\r\nconst CardHeader = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(\r\n  ({ className, ...props }, ref) => (\r\n    <div ref={ref} className={cn(\"flex flex-col space-y-1.5 p-6\", className)} {...props} />\r\n  ),\r\n);\r\nCardHeader.displayName = \"CardHeader\";\r\n\r\nconst CardTitle = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLHeadingElement>>(\r\n  ({ className, ...props }, ref) => (\r\n    <h3 ref={ref} className={cn(\"text-2xl font-semibold leading-none tracking-tight\", className)} {...props} />\r\n  ),\r\n);\r\nCardTitle.displayName = \"CardTitle\";\r\n\r\nconst CardDescription = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLParagraphElement>>(\r\n  ({ className, ...props }, ref) => (\r\n    <p ref={ref} className={cn(\"text-sm text-muted-foreground\", className)} {...props} />\r\n  ),\r\n);\r\nCardDescription.displayName = \"CardDescription\";\r\n\r\nconst CardContent = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(\r\n  ({ className, ...props }, ref) => <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />,\r\n);\r\nCardContent.displayName = \"CardContent\";\r\n\r\nconst CardFooter = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(\r\n  ({ className, ...props }, ref) => (\r\n    <div ref={ref} className={cn(\"flex items-center p-6 pt-0\", className)} {...props} />\r\n  ),\r\n);\r\nCardFooter.displayName = \"CardFooter\";\r\n\r\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent };\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA;AAEA;;;;AAEA,MAAM,qBAAO,2KAAgB,MAAuD,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC5G,6LAAC;QAAI,KAAK;QAAK,WAAW,IAAA,4HAAE,EAAC,4DAA4D;QAAa,GAAG,KAAK;;;;;;;AAEhH,KAAK,WAAW,GAAG;AAEnB,MAAM,2BAAa,2KAAgB,OACjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBACxB,6LAAC;QAAI,KAAK;QAAK,WAAW,IAAA,4HAAE,EAAC,iCAAiC;QAAa,GAAG,KAAK;;;;;;;AAGvF,WAAW,WAAW,GAAG;AAEzB,MAAM,0BAAY,2KAAgB,OAChC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBACxB,6LAAC;QAAG,KAAK;QAAK,WAAW,IAAA,4HAAE,EAAC,sDAAsD;QAAa,GAAG,KAAK;;;;;;;AAG3G,UAAU,WAAW,GAAG;AAExB,MAAM,gCAAkB,2KAAgB,OACtC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBACxB,6LAAC;QAAE,KAAK;QAAK,WAAW,IAAA,4HAAE,EAAC,iCAAiC;QAAa,GAAG,KAAK;;;;;;;AAGrF,gBAAgB,WAAW,GAAG;AAE9B,MAAM,4BAAc,2KAAgB,OAClC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAAQ,6LAAC;QAAI,KAAK;QAAK,WAAW,IAAA,4HAAE,EAAC,YAAY;QAAa,GAAG,KAAK;;;;;;;AAElG,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,2KAAgB,QACjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBACxB,6LAAC;QAAI,KAAK;QAAK,WAAW,IAAA,4HAAE,EAAC,8BAA8B;QAAa,GAAG,KAAK;;;;;;;AAGpF,WAAW,WAAW,GAAG"}},
    {"offset": {"line": 145, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/27825/shalean-v2/shalean-reimagined/app/admin/%28dashboard%29/users/%5Bid%5D/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { useParams } from 'next/navigation';\r\nimport { useQuery } from '@tanstack/react-query';\r\nimport { getAllCustomers, getAllCleaners } from '../../../actions';\r\nimport { Profile } from '@/types/profile';\r\nimport { Cleaner } from '@/types/booking';\r\nimport { Loader2, ArrowLeft, User, Mail, Phone, Calendar } from 'lucide-react';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport Link from 'next/link';\r\n\r\nexport default function UserDetailPage() {\r\n  const params = useParams();\r\n  const userId = params.id as string;\r\n  const [user, setUser] = useState<Profile | Cleaner | null>(null);\r\n  const [userType, setUserType] = useState<'customer' | 'cleaner' | null>(null);\r\n\r\n  // Get all customers and cleaners to find the user\r\n  const { data: customers } = useQuery({\r\n    queryKey: ['all-customers'],\r\n    queryFn: async () => {\r\n      const result = await getAllCustomers();\r\n      return result.success ? result.customers || [] : [];\r\n    },\r\n    staleTime: 2 * 60 * 1000,\r\n  });\r\n\r\n  const { data: cleaners } = useQuery({\r\n    queryKey: ['all-cleaners'],\r\n    queryFn: async () => {\r\n      const result = await getAllCleaners();\r\n      return result.success ? result.cleaners || [] : [];\r\n    },\r\n    staleTime: 2 * 60 * 1000,\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (customers && cleaners) {\r\n      // Try to find as customer first\r\n      const customer = customers.find((c) => c.id === userId);\r\n      if (customer) {\r\n        setUser(customer);\r\n        setUserType('customer');\r\n        return;\r\n      }\r\n\r\n      // Try to find as cleaner\r\n      const cleaner = cleaners.find((c) => c.id === userId);\r\n      if (cleaner) {\r\n        setUser(cleaner);\r\n        setUserType('cleaner');\r\n        return;\r\n      }\r\n    }\r\n  }, [customers, cleaners, userId]);\r\n\r\n  if (!user || !userType) {\r\n    return (\r\n      <div className=\"flex items-center justify-center py-12\">\r\n        <Loader2 className=\"w-6 h-6 animate-spin text-primary\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const isCustomer = userType === 'customer';\r\n  const customer = isCustomer ? (user as Profile) : null;\r\n  const cleaner = !isCustomer ? (user as Cleaner) : null;\r\n\r\n  return (\r\n    <div className=\"space-y-6 w-full max-w-full overflow-x-hidden\">\r\n      <div className=\"flex items-center gap-4\">\r\n        <Button variant=\"outline\" size=\"sm\" asChild>\r\n          <Link href=\"/admin/users\">\r\n            <ArrowLeft className=\"h-4 w-4 mr-2\" />\r\n            Back to Users\r\n          </Link>\r\n        </Button>\r\n      </div>\r\n\r\n      <div className=\"space-y-2\">\r\n        <h1 className=\"text-2xl sm:text-3xl md:text-4xl font-bold\">\r\n          {isCustomer\r\n            ? `${customer?.first_name} ${customer?.last_name}`\r\n            : cleaner?.name}\r\n        </h1>\r\n        <p className=\"text-muted-foreground\">\r\n          {isCustomer ? 'Customer' : 'Cleaner'} Profile\r\n        </p>\r\n      </div>\r\n\r\n      <div className=\"grid gap-4 md:grid-cols-2\">\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle>Profile Information</CardTitle>\r\n            <CardDescription>Basic user details</CardDescription>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            {isCustomer && customer ? (\r\n              <>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <User className=\"h-4 w-4 text-muted-foreground\" />\r\n                  <div>\r\n                    <p className=\"text-sm font-medium\">Name</p>\r\n                    <p className=\"text-sm text-muted-foreground\">\r\n                      {customer.first_name} {customer.last_name}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <Mail className=\"h-4 w-4 text-muted-foreground\" />\r\n                  <div>\r\n                    <p className=\"text-sm font-medium\">Email</p>\r\n                    <p className=\"text-sm text-muted-foreground\">{customer.email}</p>\r\n                  </div>\r\n                </div>\r\n                {customer.phone && (\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <Phone className=\"h-4 w-4 text-muted-foreground\" />\r\n                    <div>\r\n                      <p className=\"text-sm font-medium\">Phone</p>\r\n                      <p className=\"text-sm text-muted-foreground\">{customer.phone}</p>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n                <div className=\"flex items-center gap-2\">\r\n                  <Calendar className=\"h-4 w-4 text-muted-foreground\" />\r\n                  <div>\r\n                    <p className=\"text-sm font-medium\">Joined</p>\r\n                    <p className=\"text-sm text-muted-foreground\">\r\n                      {customer.created_at\r\n                        ? new Date(customer.created_at).toLocaleDateString()\r\n                        : '—'}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </>\r\n            ) : cleaner ? (\r\n              <>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <User className=\"h-4 w-4 text-muted-foreground\" />\r\n                  <div>\r\n                    <p className=\"text-sm font-medium\">Name</p>\r\n                    <p className=\"text-sm text-muted-foreground\">{cleaner.name}</p>\r\n                  </div>\r\n                </div>\r\n                {cleaner.email && (\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <Mail className=\"h-4 w-4 text-muted-foreground\" />\r\n                    <div>\r\n                      <p className=\"text-sm font-medium\">Email</p>\r\n                      <p className=\"text-sm text-muted-foreground\">{cleaner.email}</p>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n                <div className=\"flex items-center gap-2\">\r\n                  <Phone className=\"h-4 w-4 text-muted-foreground\" />\r\n                  <div>\r\n                    <p className=\"text-sm font-medium\">Phone</p>\r\n                    <p className=\"text-sm text-muted-foreground\">{cleaner.phone}</p>\r\n                  </div>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <Calendar className=\"h-4 w-4 text-muted-foreground\" />\r\n                  <div>\r\n                    <p className=\"text-sm font-medium\">Status</p>\r\n                    <p className=\"text-sm text-muted-foreground\">\r\n                      {cleaner.is_active ? 'Active' : 'Inactive'}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n                {cleaner.rating && (\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <User className=\"h-4 w-4 text-muted-foreground\" />\r\n                    <div>\r\n                      <p className=\"text-sm font-medium\">Rating</p>\r\n                      <p className=\"text-sm text-muted-foreground\">\r\n                        {cleaner.rating.toFixed(1)}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n                <div className=\"flex items-center gap-2\">\r\n                  <Calendar className=\"h-4 w-4 text-muted-foreground\" />\r\n                  <div>\r\n                    <p className=\"text-sm font-medium\">Joined</p>\r\n                    <p className=\"text-sm text-muted-foreground\">\r\n                      {cleaner.created_at\r\n                        ? new Date(cleaner.created_at).toLocaleDateString()\r\n                        : '—'}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </>\r\n            ) : null}\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle>Additional Information</CardTitle>\r\n            <CardDescription>Additional details</CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <p className=\"text-sm text-muted-foreground\">\r\n              More information about this user will be available here in the future.\r\n            </p>\r\n            <p className=\"text-sm text-muted-foreground mt-2\">\r\n              Booking history, activity logs, and other details can be added later.\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}