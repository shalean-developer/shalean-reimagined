(globalThis.TURBOPACK || (globalThis.TURBOPACK = [])).push([typeof document === "object" ? document.currentScript : undefined,
"[project]/src/components/ui/badge.tsx [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Badge",
    ()=>Badge,
    "badgeVariants",
    ()=>badgeVariants
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/jsx-dev-runtime.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$class$2d$variance$2d$authority$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/class-variance-authority/dist/index.mjs [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/lib/utils.ts [app-client] (ecmascript)");
;
;
;
const badgeVariants = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$class$2d$variance$2d$authority$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["cva"])("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2", {
    variants: {
        variant: {
            default: "border-transparent bg-primary text-primary-foreground hover:bg-primary/80",
            secondary: "border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",
            destructive: "border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",
            outline: "text-foreground"
        }
    },
    defaultVariants: {
        variant: "default"
    }
});
function Badge({ className, variant, ...props }) {
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
        className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["cn"])(badgeVariants({
            variant
        }), className),
        ...props
    }, void 0, false, {
        fileName: "[project]/src/components/ui/badge.tsx",
        lineNumber: 26,
        columnNumber: 10
    }, this);
}
_c = Badge;
;
var _c;
__turbopack_context__.k.register(_c, "Badge");
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
}),
"[project]/src/components/ui/card.tsx [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Card",
    ()=>Card,
    "CardContent",
    ()=>CardContent,
    "CardDescription",
    ()=>CardDescription,
    "CardFooter",
    ()=>CardFooter,
    "CardHeader",
    ()=>CardHeader,
    "CardTitle",
    ()=>CardTitle
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/jsx-dev-runtime.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/index.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/lib/utils.ts [app-client] (ecmascript)");
;
;
;
const Card = /*#__PURE__*/ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["forwardRef"](_c = ({ className, ...props }, ref)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
        ref: ref,
        className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["cn"])("rounded-lg border bg-card text-card-foreground shadow-sm", className),
        ...props
    }, void 0, false, {
        fileName: "[project]/src/components/ui/card.tsx",
        lineNumber: 6,
        columnNumber: 3
    }, ("TURBOPACK compile-time value", void 0)));
_c1 = Card;
Card.displayName = "Card";
const CardHeader = /*#__PURE__*/ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["forwardRef"](_c2 = ({ className, ...props }, ref)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
        ref: ref,
        className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["cn"])("flex flex-col space-y-1.5 p-6", className),
        ...props
    }, void 0, false, {
        fileName: "[project]/src/components/ui/card.tsx",
        lineNumber: 12,
        columnNumber: 5
    }, ("TURBOPACK compile-time value", void 0)));
_c3 = CardHeader;
CardHeader.displayName = "CardHeader";
const CardTitle = /*#__PURE__*/ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["forwardRef"](_c4 = ({ className, ...props }, ref)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("h3", {
        ref: ref,
        className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["cn"])("text-2xl font-semibold leading-none tracking-tight", className),
        ...props
    }, void 0, false, {
        fileName: "[project]/src/components/ui/card.tsx",
        lineNumber: 19,
        columnNumber: 5
    }, ("TURBOPACK compile-time value", void 0)));
_c5 = CardTitle;
CardTitle.displayName = "CardTitle";
const CardDescription = /*#__PURE__*/ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["forwardRef"](_c6 = ({ className, ...props }, ref)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
        ref: ref,
        className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["cn"])("text-sm text-muted-foreground", className),
        ...props
    }, void 0, false, {
        fileName: "[project]/src/components/ui/card.tsx",
        lineNumber: 26,
        columnNumber: 5
    }, ("TURBOPACK compile-time value", void 0)));
_c7 = CardDescription;
CardDescription.displayName = "CardDescription";
const CardContent = /*#__PURE__*/ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["forwardRef"](_c8 = ({ className, ...props }, ref)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
        ref: ref,
        className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["cn"])("p-6 pt-0", className),
        ...props
    }, void 0, false, {
        fileName: "[project]/src/components/ui/card.tsx",
        lineNumber: 32,
        columnNumber: 37
    }, ("TURBOPACK compile-time value", void 0)));
_c9 = CardContent;
CardContent.displayName = "CardContent";
const CardFooter = /*#__PURE__*/ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["forwardRef"](_c10 = ({ className, ...props }, ref)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
        ref: ref,
        className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["cn"])("flex items-center p-6 pt-0", className),
        ...props
    }, void 0, false, {
        fileName: "[project]/src/components/ui/card.tsx",
        lineNumber: 38,
        columnNumber: 5
    }, ("TURBOPACK compile-time value", void 0)));
_c11 = CardFooter;
CardFooter.displayName = "CardFooter";
;
var _c, _c1, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c10, _c11;
__turbopack_context__.k.register(_c, "Card$React.forwardRef");
__turbopack_context__.k.register(_c1, "Card");
__turbopack_context__.k.register(_c2, "CardHeader$React.forwardRef");
__turbopack_context__.k.register(_c3, "CardHeader");
__turbopack_context__.k.register(_c4, "CardTitle$React.forwardRef");
__turbopack_context__.k.register(_c5, "CardTitle");
__turbopack_context__.k.register(_c6, "CardDescription$React.forwardRef");
__turbopack_context__.k.register(_c7, "CardDescription");
__turbopack_context__.k.register(_c8, "CardContent$React.forwardRef");
__turbopack_context__.k.register(_c9, "CardContent");
__turbopack_context__.k.register(_c10, "CardFooter$React.forwardRef");
__turbopack_context__.k.register(_c11, "CardFooter");
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
}),
"[project]/app/cleaner/data:126878 [app-client] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "getCleanerBookingById",
    ()=>$$RSC_SERVER_ACTION_5
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-client] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"407424f522637094128af18ea51884b5441885865a":"getCleanerBookingById"},"app/cleaner/actions.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_5 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createServerReference"])("407424f522637094128af18ea51884b5441885865a", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["findSourceMapURL"], "getCleanerBookingById");
;
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vYWN0aW9ucy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHNlcnZlcic7XHJcblxyXG5pbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAL2xpYi9zdXBhYmFzZS9zZXJ2ZXInO1xyXG5pbXBvcnQgeyBjcmVhdGVBZG1pbkNsaWVudCB9IGZyb20gJ0AvbGliL3N1cGFiYXNlL3NlcnZlci1hZG1pbic7XHJcbmltcG9ydCB7IEJvb2tpbmcgfSBmcm9tICdAL3R5cGVzL2Jvb2tpbmcnO1xyXG5pbXBvcnQgeyBDbGVhbmVyIH0gZnJvbSAnQC90eXBlcy9ib29raW5nJztcclxuaW1wb3J0IHtcclxuICBjYWxjdWxhdGVDbGVhbmVyVGVudXJlLFxyXG4gIGNhbGN1bGF0ZVRvdGFsSG91cnMsXHJcbiAgZ2V0RWFybmluZ3NQZXJjZW50YWdlLFxyXG4gIGNhbGN1bGF0ZVRvdGFsRWFybmluZ3NGcm9tQm9va2luZyxcclxuICBjYWxjdWxhdGVDbGVhbmVyRWFybmluZ3MsXHJcbiAgY2FsY3VsYXRlVGlwUGVyQ2xlYW5lcixcclxufSBmcm9tICdAL2xpYi91dGlscy9jbGVhbmVyLWVhcm5pbmdzJztcclxuXHJcbi8qKlxyXG4gKiBHZXQgY2xlYW5lciBieSBwaG9uZSBudW1iZXJcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDbGVhbmVyQnlQaG9uZShwaG9uZTogc3RyaW5nKTogUHJvbWlzZTx7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBjbGVhbmVyPzogQ2xlYW5lcjtcclxuICBlcnJvcj86IHN0cmluZztcclxufT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xyXG4gICAgXHJcbiAgICAvLyBOb3JtYWxpemUgcGhvbmUgbnVtYmVyIChyZW1vdmUgc3BhY2VzLCBkYXNoZXMsIGV0Yy4pXHJcbiAgICBjb25zdCBub3JtYWxpemVkUGhvbmUgPSBwaG9uZS5yZXBsYWNlKC9cXHMrL2csICcnKS50cmltKCk7XHJcbiAgICBcclxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdjbGVhbmVycycpXHJcbiAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAub3IoYHBob25lLmVxLiR7bm9ybWFsaXplZFBob25lfSxwaG9uZS5lcS4rJHtub3JtYWxpemVkUGhvbmV9YClcclxuICAgICAgLmVxKCdpc19hY3RpdmUnLCB0cnVlKVxyXG4gICAgICAubWF5YmVTaW5nbGUoKTtcclxuXHJcbiAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY2xlYW5lciBieSBwaG9uZTonLCBlcnJvcik7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG5cclxuICAgIGlmICghZGF0YSkge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdDbGVhbmVyIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBjbGVhbmVyOiBkYXRhIGFzIENsZWFuZXIgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gZ2V0Q2xlYW5lckJ5UGhvbmU6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdGYWlsZWQgdG8gZmV0Y2ggY2xlYW5lcicsXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEF1dGhlbnRpY2F0ZSBjbGVhbmVyIHdpdGggcGhvbmUgYW5kIHBhc3N3b3JkXHJcbiAqIFVzZXMgU3VwYWJhc2UgQXV0aCAtIGV4cGVjdHMgZW1haWwgZm9ybWF0OiB7cGhvbmV9QGNsZWFuZXJzLnNoYWxlYW4ubG9jYWxcclxuICogQWRtaW4gc2hvdWxkIGNyZWF0ZSBhdXRoIGFjY291bnRzIHdpdGggdGhpcyBlbWFpbCBmb3JtYXQgd2hlbiBjcmVhdGluZyBjbGVhbmVyIGFjY291bnRzXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXV0aGVudGljYXRlQ2xlYW5lcihcclxuICBwaG9uZTogc3RyaW5nLFxyXG4gIHBhc3N3b3JkOiBzdHJpbmdcclxuKTogUHJvbWlzZTx7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBjbGVhbmVyPzogQ2xlYW5lcjtcclxuICBlcnJvcj86IHN0cmluZztcclxufT4ge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBGaXJzdCwgZmluZCB0aGUgY2xlYW5lciBieSBwaG9uZSB0byB2ZXJpZnkgdGhleSBleGlzdFxyXG4gICAgY29uc3QgY2xlYW5lclJlc3VsdCA9IGF3YWl0IGdldENsZWFuZXJCeVBob25lKHBob25lKTtcclxuICAgIGlmICghY2xlYW5lclJlc3VsdC5zdWNjZXNzIHx8ICFjbGVhbmVyUmVzdWx0LmNsZWFuZXIpIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnSW52YWxpZCBwaG9uZSBudW1iZXIgb3IgcGFzc3dvcmQnIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgY2xlYW5lciA9IGNsZWFuZXJSZXN1bHQuY2xlYW5lcjtcclxuXHJcbiAgICAvLyBVc2UgcGhvbmUtYmFzZWQgZW1haWwgZm9ybWF0IGZvciBsb2dpblxyXG4gICAgLy8gRm9ybWF0OiB7cGhvbmV9QGNsZWFuZXJzLnNoYWxlYW4ubG9jYWxcclxuICAgIC8vIE5vcm1hbGl6ZSBwaG9uZSAocmVtb3ZlIHNwYWNlcywga2VlcCArIGlmIHByZXNlbnQpXHJcbiAgICBjb25zdCBub3JtYWxpemVkUGhvbmUgPSBwaG9uZS5yZXBsYWNlKC9cXHMrL2csICcnKS50cmltKCk7XHJcbiAgICBjb25zdCBhdXRoRW1haWwgPSBgJHtub3JtYWxpemVkUGhvbmV9QGNsZWFuZXJzLnNoYWxlYW4ubG9jYWxgO1xyXG5cclxuICAgIC8vIEF1dGhlbnRpY2F0ZSB3aXRoIFN1cGFiYXNlIEF1dGggdXNpbmcgY2xpZW50LXNpZGUgKHRoaXMgc2hvdWxkIGJlIGNhbGxlZCBmcm9tIGNsaWVudClcclxuICAgIC8vIE5vdGU6IFRoaXMgZnVuY3Rpb24gc2hvdWxkIGlkZWFsbHkgYmUgY2FsbGVkIGZyb20gYSBjbGllbnQgY29tcG9uZW50XHJcbiAgICAvLyBGb3Igc2VydmVyLXNpZGUsIHdlJ2xsIHJldHVybiB0aGUgY2xlYW5lciBpbmZvIGFuZCBsZXQgY2xpZW50IGhhbmRsZSBhdXRoXHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xyXG4gICAgXHJcbiAgICAvLyBUcnkgdG8gYXV0aGVudGljYXRlXHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLnNpZ25JbldpdGhQYXNzd29yZCh7XHJcbiAgICAgIGVtYWlsOiBhdXRoRW1haWwsXHJcbiAgICAgIHBhc3N3b3JkLFxyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0F1dGhlbnRpY2F0aW9uIGVycm9yOicsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnSW52YWxpZCBwaG9uZSBudW1iZXIgb3IgcGFzc3dvcmQnIH07XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCFkYXRhLnVzZXIpIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnQXV0aGVudGljYXRpb24gZmFpbGVkJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFVwZGF0ZSBjbGVhbmVyJ3MgYXV0aF91c2VyX2lkIGlmIG5vdCBzZXRcclxuICAgIGlmICghY2xlYW5lci5hdXRoX3VzZXJfaWQpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBhZG1pblN1cGFiYXNlID0gY3JlYXRlQWRtaW5DbGllbnQoKTtcclxuICAgICAgICBhd2FpdCBhZG1pblN1cGFiYXNlXHJcbiAgICAgICAgICAuZnJvbSgnY2xlYW5lcnMnKVxyXG4gICAgICAgICAgLnVwZGF0ZSh7IGF1dGhfdXNlcl9pZDogZGF0YS51c2VyLmlkIH0pXHJcbiAgICAgICAgICAuZXEoJ2lkJywgY2xlYW5lci5pZCk7XHJcbiAgICAgIH0gY2F0Y2ggKHVwZGF0ZUVycm9yKSB7XHJcbiAgICAgICAgLy8gTG9nIGJ1dCBkb24ndCBmYWlsIC0gYXV0aF91c2VyX2lkIHVwZGF0ZSBpcyBvcHRpb25hbFxyXG4gICAgICAgIGNvbnNvbGUud2FybignQ291bGQgbm90IHVwZGF0ZSBhdXRoX3VzZXJfaWQ6JywgdXBkYXRlRXJyb3IpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgY2xlYW5lciB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBhdXRoZW50aWNhdGVDbGVhbmVyOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnQXV0aGVudGljYXRpb24gZmFpbGVkJyxcclxuICAgIH07XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogR2V0IGN1cnJlbnQgYXV0aGVudGljYXRlZCBjbGVhbmVyXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q3VycmVudENsZWFuZXIoKTogUHJvbWlzZTx7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBjbGVhbmVyPzogQ2xlYW5lcjtcclxuICBlcnJvcj86IHN0cmluZztcclxufT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xyXG4gICAgY29uc3QgeyBkYXRhOiB7IHVzZXIgfSwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5nZXRVc2VyKCk7XHJcblxyXG4gICAgaWYgKGF1dGhFcnJvciB8fCAhdXNlcikge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdOb3QgYXV0aGVudGljYXRlZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBUcnkgdG8gZmluZCBjbGVhbmVyIGJ5IGF1dGhfdXNlcl9pZCBmaXJzdFxyXG4gICAgbGV0IGNsZWFuZXJRdWVyeSA9IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdjbGVhbmVycycpXHJcbiAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAuZXEoJ2F1dGhfdXNlcl9pZCcsIHVzZXIuaWQpXHJcbiAgICAgIC5lcSgnaXNfYWN0aXZlJywgdHJ1ZSlcclxuICAgICAgLm1heWJlU2luZ2xlKCk7XHJcblxyXG4gICAgbGV0IHsgZGF0YTogY2xlYW5lciwgZXJyb3I6IGNsZWFuZXJFcnJvciB9ID0gYXdhaXQgY2xlYW5lclF1ZXJ5O1xyXG5cclxuICAgIC8vIElmIG5vdCBmb3VuZCBieSBhdXRoX3VzZXJfaWQsIHRyeSB0byBtYXRjaCBieSBwaG9uZSBmcm9tIGVtYWlsXHJcbiAgICBpZiAoIWNsZWFuZXIgJiYgIWNsZWFuZXJFcnJvciAmJiB1c2VyLmVtYWlsKSB7XHJcbiAgICAgIC8vIEV4dHJhY3QgcGhvbmUgZnJvbSBlbWFpbCBmb3JtYXQ6IHtwaG9uZX1AY2xlYW5lcnMuc2hhbGVhbi5sb2NhbFxyXG4gICAgICBjb25zdCBwaG9uZU1hdGNoID0gdXNlci5lbWFpbC5tYXRjaCgvXiguKylAY2xlYW5lcnNcXC5zaGFsZWFuXFwubG9jYWwkLyk7XHJcbiAgICAgIGlmIChwaG9uZU1hdGNoKSB7XHJcbiAgICAgICAgY29uc3QgcGhvbmUgPSBwaG9uZU1hdGNoWzFdO1xyXG4gICAgICAgIGNvbnN0IHBob25lUmVzdWx0ID0gYXdhaXQgZ2V0Q2xlYW5lckJ5UGhvbmUocGhvbmUpO1xyXG4gICAgICAgIGlmIChwaG9uZVJlc3VsdC5zdWNjZXNzICYmIHBob25lUmVzdWx0LmNsZWFuZXIpIHtcclxuICAgICAgICAgIGNsZWFuZXIgPSBwaG9uZVJlc3VsdC5jbGVhbmVyO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChjbGVhbmVyRXJyb3IgfHwgIWNsZWFuZXIpIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnQ2xlYW5lciBwcm9maWxlIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBjbGVhbmVyOiBjbGVhbmVyIGFzIENsZWFuZXIgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gZ2V0Q3VycmVudENsZWFuZXI6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdGYWlsZWQgdG8gZ2V0IGNsZWFuZXInLFxyXG4gICAgfTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZXQgYm9va2luZ3MgYXNzaWduZWQgdG8gdGhlIGF1dGhlbnRpY2F0ZWQgY2xlYW5lclxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENsZWFuZXJCb29raW5ncyhcclxuICBmaWx0ZXI/OiAnYWxsJyB8ICd0b2RheScgfCAndXBjb21pbmcnIHwgJ3Bhc3QnIHwgJ29uX215X3dheScgfCAnc3RhcnRlZCdcclxuKTogUHJvbWlzZTx7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBib29raW5ncz86IEJvb2tpbmdbXTtcclxuICBlcnJvcj86IHN0cmluZztcclxufT4ge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBHZXQgYXV0aGVudGljYXRlZCBjbGVhbmVyIGZpcnN0XHJcbiAgICBjb25zdCBjbGVhbmVyUmVzdWx0ID0gYXdhaXQgZ2V0Q3VycmVudENsZWFuZXIoKTtcclxuICAgIGlmICghY2xlYW5lclJlc3VsdC5zdWNjZXNzIHx8ICFjbGVhbmVyUmVzdWx0LmNsZWFuZXIpIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnTm90IGF1dGhlbnRpY2F0ZWQgb3IgY2xlYW5lciBwcm9maWxlIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBjbGVhbmVySWQgPSBjbGVhbmVyUmVzdWx0LmNsZWFuZXIuaWQ7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xyXG4gICAgXHJcbiAgICAvLyBGZXRjaCBib29raW5ncyB3aGVyZSBjbGVhbmVyIGlzIGFzc2lnbmVkIHZpYSBwcmVmZXJyZWRfY2xlYW5lcl9pZCAoc2luZ2xlKVxyXG4gICAgbGV0IHNpbmdsZVF1ZXJ5ID0gc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2Jvb2tpbmdzJylcclxuICAgICAgLnNlbGVjdCgnKicpXHJcbiAgICAgIC5lcSgncHJlZmVycmVkX2NsZWFuZXJfaWQnLCBjbGVhbmVySWQpO1xyXG5cclxuICAgIC8vIEZldGNoIGJvb2tpbmdzIHdpdGggcHJlZmVycmVkX2NsZWFuZXJfaWRzIChhcnJheSkgLSBmZXRjaCBhbGwgd2l0aCBhcnJheXMsIHRoZW4gZmlsdGVyXHJcbiAgICBsZXQgYXJyYXlRdWVyeSA9IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdib29raW5ncycpXHJcbiAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAubm90KCdwcmVmZXJyZWRfY2xlYW5lcl9pZHMnLCAnaXMnLCBudWxsKTtcclxuXHJcbiAgICAvLyBBcHBseSBmaWx0ZXJzIHRvIGJvdGggcXVlcmllc1xyXG4gICAgaWYgKGZpbHRlciAmJiBmaWx0ZXIgIT09ICdhbGwnKSB7XHJcbiAgICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XHJcbiAgICAgIFxyXG4gICAgICBzd2l0Y2ggKGZpbHRlcikge1xyXG4gICAgICAgIGNhc2UgJ3RvZGF5JzpcclxuICAgICAgICAgIHNpbmdsZVF1ZXJ5ID0gc2luZ2xlUXVlcnkuZXEoJ3NlcnZpY2VfZGF0ZScsIHRvZGF5KTtcclxuICAgICAgICAgIGFycmF5UXVlcnkgPSBhcnJheVF1ZXJ5LmVxKCdzZXJ2aWNlX2RhdGUnLCB0b2RheSk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICd1cGNvbWluZyc6XHJcbiAgICAgICAgICBzaW5nbGVRdWVyeSA9IHNpbmdsZVF1ZXJ5Lmd0ZSgnc2VydmljZV9kYXRlJywgdG9kYXkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAuaW4oJ3N0YXR1cycsIFsncGVuZGluZycsICdjb25maXJtZWQnLCAnb25fbXlfd2F5JywgJ3N0YXJ0ZWQnXSk7XHJcbiAgICAgICAgICBhcnJheVF1ZXJ5ID0gYXJyYXlRdWVyeS5ndGUoJ3NlcnZpY2VfZGF0ZScsIHRvZGF5KVxyXG4gICAgICAgICAgICAgICAgICAgICAgLmluKCdzdGF0dXMnLCBbJ3BlbmRpbmcnLCAnY29uZmlybWVkJywgJ29uX215X3dheScsICdzdGFydGVkJ10pO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAncGFzdCc6XHJcbiAgICAgICAgICBzaW5nbGVRdWVyeSA9IHNpbmdsZVF1ZXJ5Lmx0KCdzZXJ2aWNlX2RhdGUnLCB0b2RheSlcclxuICAgICAgICAgICAgICAgICAgICAgIC5vcignc3RhdHVzLmVxLmNvbXBsZXRlZCxzdGF0dXMuZXEuY2FuY2VsbGVkJyk7XHJcbiAgICAgICAgICBhcnJheVF1ZXJ5ID0gYXJyYXlRdWVyeS5sdCgnc2VydmljZV9kYXRlJywgdG9kYXkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAub3IoJ3N0YXR1cy5lcS5jb21wbGV0ZWQsc3RhdHVzLmVxLmNhbmNlbGxlZCcpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnb25fbXlfd2F5JzpcclxuICAgICAgICAgIHNpbmdsZVF1ZXJ5ID0gc2luZ2xlUXVlcnkuZXEoJ3N0YXR1cycsICdvbl9teV93YXknKTtcclxuICAgICAgICAgIGFycmF5UXVlcnkgPSBhcnJheVF1ZXJ5LmVxKCdzdGF0dXMnLCAnb25fbXlfd2F5Jyk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdzdGFydGVkJzpcclxuICAgICAgICAgIHNpbmdsZVF1ZXJ5ID0gc2luZ2xlUXVlcnkuZXEoJ3N0YXR1cycsICdzdGFydGVkJyk7XHJcbiAgICAgICAgICBhcnJheVF1ZXJ5ID0gYXJyYXlRdWVyeS5lcSgnc3RhdHVzJywgJ3N0YXJ0ZWQnKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRXhlY3V0ZSBib3RoIHF1ZXJpZXNcclxuICAgIGNvbnN0IFtzaW5nbGVSZXN1bHQsIGFycmF5UmVzdWx0XSA9IGF3YWl0IFByb21pc2UuYWxsKFtcclxuICAgICAgc2luZ2xlUXVlcnkub3JkZXIoJ3NlcnZpY2VfZGF0ZScsIHsgYXNjZW5kaW5nOiB0cnVlIH0pLm9yZGVyKCdzZXJ2aWNlX3RpbWUnLCB7IGFzY2VuZGluZzogdHJ1ZSB9KSxcclxuICAgICAgYXJyYXlRdWVyeS5vcmRlcignc2VydmljZV9kYXRlJywgeyBhc2NlbmRpbmc6IHRydWUgfSkub3JkZXIoJ3NlcnZpY2VfdGltZScsIHsgYXNjZW5kaW5nOiB0cnVlIH0pXHJcbiAgICBdKTtcclxuXHJcbiAgICBpZiAoc2luZ2xlUmVzdWx0LmVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGNsZWFuZXIgYm9va2luZ3MgKHNpbmdsZSk6Jywgc2luZ2xlUmVzdWx0LmVycm9yKTtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBzaW5nbGVSZXN1bHQuZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChhcnJheVJlc3VsdC5lcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBjbGVhbmVyIGJvb2tpbmdzIChhcnJheSk6JywgYXJyYXlSZXN1bHQuZXJyb3IpO1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGFycmF5UmVzdWx0LmVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBEZWJ1ZyBsb2dnaW5nXHJcbiAgICBjb25zb2xlLmxvZygnW2dldENsZWFuZXJCb29raW5nc10gRmV0Y2hlZCBib29raW5nczonLCB7XHJcbiAgICAgIGNsZWFuZXJJZCxcclxuICAgICAgZmlsdGVyLFxyXG4gICAgICBzaW5nbGVCb29raW5nc0NvdW50OiBzaW5nbGVSZXN1bHQuZGF0YT8ubGVuZ3RoIHx8IDAsXHJcbiAgICAgIGFycmF5Qm9va2luZ3NDb3VudDogYXJyYXlSZXN1bHQuZGF0YT8ubGVuZ3RoIHx8IDAsXHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBGaWx0ZXIgYm9va2luZ3Mgd2hlcmUgcHJlZmVycmVkX2NsZWFuZXJfaWRzIGFycmF5IGNvbnRhaW5zIHRoaXMgY2xlYW5lcklkXHJcbiAgICAvLyBOb3JtYWxpemUgVVVJRHMgZm9yIGNvbXBhcmlzb24gKGhhbmRsZSBjYXNlIGRpZmZlcmVuY2VzIGFuZCBzdHJpbmcgZm9ybWF0cylcclxuICAgIGNvbnN0IG5vcm1hbGl6ZVV1aWQgPSAoaWQ6IGFueSk6IHN0cmluZyA9PiB7XHJcbiAgICAgIGlmICghaWQpIHJldHVybiAnJztcclxuICAgICAgcmV0dXJuIFN0cmluZyhpZCkudG9Mb3dlckNhc2UoKS50cmltKCk7XHJcbiAgICB9O1xyXG4gICAgY29uc3Qgbm9ybWFsaXplZENsZWFuZXJJZCA9IG5vcm1hbGl6ZVV1aWQoY2xlYW5lcklkKTtcclxuICAgIFxyXG4gICAgY29uc3QgZmlsdGVyZWRBcnJheUJvb2tpbmdzID0gKGFycmF5UmVzdWx0LmRhdGEgfHwgW10pLmZpbHRlcigoYm9va2luZzogYW55KSA9PiB7XHJcbiAgICAgIGlmICghYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMgfHwgIUFycmF5LmlzQXJyYXkoYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMpKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICAgIC8vIENoZWNrIGlmIGFycmF5IGlzIGVtcHR5XHJcbiAgICAgIGlmIChib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgLy8gQ2hlY2sgaWYgYW55IElEIGluIHRoZSBhcnJheSBtYXRjaGVzIHRoZSBjbGVhbmVySWQgKGNhc2UtaW5zZW5zaXRpdmUpXHJcbiAgICAgIHJldHVybiBib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcy5zb21lKChpZDogc3RyaW5nKSA9PiBub3JtYWxpemVVdWlkKGlkKSA9PT0gbm9ybWFsaXplZENsZWFuZXJJZCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBDb21iaW5lIHJlc3VsdHMgYW5kIHJlbW92ZSBkdXBsaWNhdGVzXHJcbiAgICBjb25zdCBhbGxCb29raW5ncyA9IFtcclxuICAgICAgLi4uKHNpbmdsZVJlc3VsdC5kYXRhIHx8IFtdKSxcclxuICAgICAgLi4uZmlsdGVyZWRBcnJheUJvb2tpbmdzXHJcbiAgICBdO1xyXG5cclxuICAgIC8vIFJlbW92ZSBkdXBsaWNhdGVzIGJ5IGJvb2tpbmcgSURcclxuICAgIGNvbnN0IHVuaXF1ZUJvb2tpbmdzTWFwID0gbmV3IE1hcDxzdHJpbmcsIEJvb2tpbmc+KCk7XHJcbiAgICBhbGxCb29raW5ncy5mb3JFYWNoKChib29raW5nOiBhbnkpID0+IHtcclxuICAgICAgaWYgKGJvb2tpbmcuaWQgJiYgIXVuaXF1ZUJvb2tpbmdzTWFwLmhhcyhib29raW5nLmlkKSkge1xyXG4gICAgICAgIHVuaXF1ZUJvb2tpbmdzTWFwLnNldChib29raW5nLmlkLCBib29raW5nIGFzIEJvb2tpbmcpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBib29raW5ncyA9IEFycmF5LmZyb20odW5pcXVlQm9va2luZ3NNYXAudmFsdWVzKCkpO1xyXG5cclxuICAgIC8vIFNvcnQgYnkgc2VydmljZV9kYXRlIGFuZCBzZXJ2aWNlX3RpbWVcclxuICAgIGJvb2tpbmdzLnNvcnQoKGEsIGIpID0+IHtcclxuICAgICAgY29uc3QgZGF0ZUNvbXBhcmUgPSBhLnNlcnZpY2VfZGF0ZS5sb2NhbGVDb21wYXJlKGIuc2VydmljZV9kYXRlKTtcclxuICAgICAgaWYgKGRhdGVDb21wYXJlICE9PSAwKSByZXR1cm4gZGF0ZUNvbXBhcmU7XHJcbiAgICAgIHJldHVybiBhLnNlcnZpY2VfdGltZS5sb2NhbGVDb21wYXJlKGIuc2VydmljZV90aW1lKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGJvb2tpbmdzIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIGdldENsZWFuZXJCb29raW5nczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0ZhaWxlZCB0byBmZXRjaCBib29raW5ncycsXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIENhbGN1bGF0ZSBjbGVhbmVyIGVhcm5pbmdzIGZvciBhIHNwZWNpZmljIGJvb2tpbmdcclxuICogVGhpcyBoZWxwZXIgZnVuY3Rpb24gaXMgdXNlZCB0byBkaXNwbGF5IGVhcm5pbmdzIG9uIGJvb2tpbmcgZGV0YWlscyBwYWdlXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2FsY3VsYXRlQm9va2luZ0Vhcm5pbmdzKGJvb2tpbmdJZDogc3RyaW5nKTogUHJvbWlzZTx7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBlYXJuaW5ncz86IHtcclxuICAgIGJhc2VFYXJuaW5nczogbnVtYmVyO1xyXG4gICAgdGlwQW1vdW50OiBudW1iZXI7XHJcbiAgICB0b3RhbEVhcm5pbmdzOiBudW1iZXI7XHJcbiAgICBlYXJuaW5nc1BlcmNlbnRhZ2U6IG51bWJlcjtcclxuICB9O1xyXG4gIGVycm9yPzogc3RyaW5nO1xyXG59PiB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIEdldCBhdXRoZW50aWNhdGVkIGNsZWFuZXIgZmlyc3RcclxuICAgIGNvbnN0IGNsZWFuZXJSZXN1bHQgPSBhd2FpdCBnZXRDdXJyZW50Q2xlYW5lcigpO1xyXG4gICAgaWYgKCFjbGVhbmVyUmVzdWx0LnN1Y2Nlc3MgfHwgIWNsZWFuZXJSZXN1bHQuY2xlYW5lcikge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdOb3QgYXV0aGVudGljYXRlZCBvciBjbGVhbmVyIHByb2ZpbGUgbm90IGZvdW5kJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGNsZWFuZXJJZCA9IGNsZWFuZXJSZXN1bHQuY2xlYW5lci5pZDtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQ2xpZW50KCk7XHJcblxyXG4gICAgLy8gR2V0IGNsZWFuZXIgaW5mbyBmb3IgdGVudXJlIGNhbGN1bGF0aW9uXHJcbiAgICBjb25zdCB7IGRhdGE6IGNsZWFuZXIsIGVycm9yOiBjbGVhbmVyRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdjbGVhbmVycycpXHJcbiAgICAgIC5zZWxlY3QoJ2NyZWF0ZWRfYXQnKVxyXG4gICAgICAuZXEoJ2lkJywgY2xlYW5lcklkKVxyXG4gICAgICAubWF5YmVTaW5nbGUoKTtcclxuXHJcbiAgICBpZiAoY2xlYW5lckVycm9yIHx8ICFjbGVhbmVyKSB7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0NsZWFuZXIgbm90IGZvdW5kJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEdldCB0aGUgYm9va2luZ1xyXG4gICAgY29uc3QgeyBkYXRhOiBib29raW5nLCBlcnJvcjogYm9va2luZ0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnYm9va2luZ3MnKVxyXG4gICAgICAuc2VsZWN0KCcqJylcclxuICAgICAgLmVxKCdpZCcsIGJvb2tpbmdJZClcclxuICAgICAgLm1heWJlU2luZ2xlKCk7XHJcblxyXG4gICAgaWYgKGJvb2tpbmdFcnJvciB8fCAhYm9va2luZykge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdCb29raW5nIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDYWxjdWxhdGUgdGVudXJlIGFuZCB0b3RhbCBob3VycyB0byBkZXRlcm1pbmUgcGVyY2VudGFnZVxyXG4gICAgLy8gRm9yIHNpbmdsZSBib29raW5nIGRpc3BsYXksIHdlIG5lZWQgYWxsIHBhaWQgY29tcGxldGVkIGJvb2tpbmdzIHRvIGNhbGN1bGF0ZSBob3Vyc1xyXG4gICAgLy8gVXNlIHRoZSBzYW1lIGFwcHJvYWNoIGFzIGdldENsZWFuZXJTdGF0c1xyXG4gICAgY29uc3QgeyBkYXRhOiBzaW5nbGVCb29raW5ncyB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2Jvb2tpbmdzJylcclxuICAgICAgLnNlbGVjdCgnc3RhdHVzLCBwYXltZW50X3N0YXR1cywgc2VydmljZV9kdXJhdGlvbiwgcHJlZmVycmVkX2NsZWFuZXJfaWQsIHByZWZlcnJlZF9jbGVhbmVyX2lkcycpXHJcbiAgICAgIC5lcSgncHJlZmVycmVkX2NsZWFuZXJfaWQnLCBjbGVhbmVySWQpO1xyXG5cclxuICAgIGNvbnN0IHsgZGF0YTogYWxsTXVsdGlCb29raW5ncyB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2Jvb2tpbmdzJylcclxuICAgICAgLnNlbGVjdCgnc3RhdHVzLCBwYXltZW50X3N0YXR1cywgc2VydmljZV9kdXJhdGlvbiwgcHJlZmVycmVkX2NsZWFuZXJfaWQsIHByZWZlcnJlZF9jbGVhbmVyX2lkcycpXHJcbiAgICAgIC5ub3QoJ3ByZWZlcnJlZF9jbGVhbmVyX2lkcycsICdpcycsIG51bGwpO1xyXG5cclxuICAgIC8vIEZpbHRlciBib29raW5ncyBhc3NpZ25lZCB0byB0aGlzIGNsZWFuZXJcclxuICAgIGNvbnN0IG5vcm1hbGl6ZVV1aWQgPSAoaWQ6IGFueSk6IHN0cmluZyA9PiB7XHJcbiAgICAgIGlmICghaWQpIHJldHVybiAnJztcclxuICAgICAgcmV0dXJuIFN0cmluZyhpZCkudG9Mb3dlckNhc2UoKS50cmltKCk7XHJcbiAgICB9O1xyXG4gICAgY29uc3Qgbm9ybWFsaXplZENsZWFuZXJJZCA9IG5vcm1hbGl6ZVV1aWQoY2xlYW5lcklkKTtcclxuXHJcbiAgICBjb25zdCBhcnJheUJvb2tpbmdzID0gKGFsbE11bHRpQm9va2luZ3MgfHwgW10pLmZpbHRlcigoYjogYW55KSA9PiB7XHJcbiAgICAgIGlmICghYi5wcmVmZXJyZWRfY2xlYW5lcl9pZHMgfHwgIUFycmF5LmlzQXJyYXkoYi5wcmVmZXJyZWRfY2xlYW5lcl9pZHMpKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChiLnByZWZlcnJlZF9jbGVhbmVyX2lkcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGIucHJlZmVycmVkX2NsZWFuZXJfaWRzLnNvbWUoKGlkOiBzdHJpbmcpID0+IG5vcm1hbGl6ZVV1aWQoaWQpID09PSBub3JtYWxpemVkQ2xlYW5lcklkKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIENvbWJpbmUgYW5kIHJlbW92ZSBkdXBsaWNhdGVzXHJcbiAgICBjb25zdCBhbGxCb29raW5nc01hcCA9IG5ldyBNYXA8c3RyaW5nLCBhbnk+KCk7XHJcbiAgICAoc2luZ2xlQm9va2luZ3MgfHwgW10pLmZvckVhY2goKGI6IGFueSkgPT4ge1xyXG4gICAgICBpZiAoYi5pZCkge1xyXG4gICAgICAgIGFsbEJvb2tpbmdzTWFwLnNldChiLmlkLCBiKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBhcnJheUJvb2tpbmdzLmZvckVhY2goKGI6IGFueSkgPT4ge1xyXG4gICAgICBpZiAoYi5pZCAmJiAhYWxsQm9va2luZ3NNYXAuaGFzKGIuaWQpKSB7XHJcbiAgICAgICAgYWxsQm9va2luZ3NNYXAuc2V0KGIuaWQsIGIpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBjbGVhbmVyQm9va2luZ3MgPSBBcnJheS5mcm9tKGFsbEJvb2tpbmdzTWFwLnZhbHVlcygpKTtcclxuXHJcbiAgICBjb25zdCB0ZW51cmVNb250aHMgPSBjYWxjdWxhdGVDbGVhbmVyVGVudXJlKGNsZWFuZXIuY3JlYXRlZF9hdCk7XHJcbiAgICBjb25zdCB0b3RhbEhvdXJzID0gY2FsY3VsYXRlVG90YWxIb3VycyhjbGVhbmVyQm9va2luZ3MpO1xyXG4gICAgY29uc3QgZWFybmluZ3NQZXJjZW50YWdlID0gZ2V0RWFybmluZ3NQZXJjZW50YWdlKHRlbnVyZU1vbnRocywgdG90YWxIb3Vycyk7XHJcblxyXG4gICAgLy8gQ2FsY3VsYXRlIGJhc2UgZWFybmluZ3NcclxuICAgIC8vIEVxdWlwbWVudCBmZWUgYW5kIGFkZGl0aW9uYWwgY2xlYW5lcnMgY2hhcmdlcyBhcmUgZXhjbHVkZWQgZnJvbSBjbGVhbmVyIGVhcm5pbmdzXHJcbiAgICBjb25zdCBiYXNlRWFybmluZ3MgPSBjYWxjdWxhdGVDbGVhbmVyRWFybmluZ3MoXHJcbiAgICAgIHtcclxuICAgICAgICBzZXJ2aWNlX3R5cGU6IGJvb2tpbmcuc2VydmljZV90eXBlIHx8ICcnLFxyXG4gICAgICAgIHRvdGFsX2Ftb3VudDogTnVtYmVyKGJvb2tpbmcudG90YWxfYW1vdW50KSB8fCAwLFxyXG4gICAgICAgIHNlcnZpY2VfZmVlOiBOdW1iZXIoYm9va2luZy5zZXJ2aWNlX2ZlZSkgfHwgMCxcclxuICAgICAgICBlcXVpcG1lbnRfc3VwcGx5X3ByaWNlOiBOdW1iZXIoYm9va2luZy5lcXVpcG1lbnRfc3VwcGx5X3ByaWNlKSB8fCAwLFxyXG4gICAgICAgIGFkZGl0aW9uYWxfY2xlYW5lcnNfcHJpY2U6IE51bWJlcihib29raW5nLmFkZGl0aW9uYWxfY2xlYW5lcnNfcHJpY2UpIHx8IDAsXHJcbiAgICAgICAgcHJlZmVycmVkX2NsZWFuZXJfaWRzOiBib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcyxcclxuICAgICAgICBwcmVmZXJyZWRfY2xlYW5lcl9pZDogYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZCxcclxuICAgICAgfSxcclxuICAgICAgY2xlYW5lcklkLFxyXG4gICAgICBlYXJuaW5nc1BlcmNlbnRhZ2UsXHJcbiAgICAgIGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWRzXHJcbiAgICApO1xyXG5cclxuICAgIC8vIENhbGN1bGF0ZSB0aXAgcGVyIGNsZWFuZXJcclxuICAgIGNvbnN0IHRpcEFtb3VudCA9IGNhbGN1bGF0ZVRpcFBlckNsZWFuZXIoXHJcbiAgICAgIE51bWJlcihib29raW5nLnRpcF9hbW91bnQpIHx8IDAsXHJcbiAgICAgIGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWRzLFxyXG4gICAgICBib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkXHJcbiAgICApO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIGVhcm5pbmdzOiB7XHJcbiAgICAgICAgYmFzZUVhcm5pbmdzLFxyXG4gICAgICAgIHRpcEFtb3VudCxcclxuICAgICAgICB0b3RhbEVhcm5pbmdzOiBiYXNlRWFybmluZ3MgKyB0aXBBbW91bnQsXHJcbiAgICAgICAgZWFybmluZ3NQZXJjZW50YWdlLFxyXG4gICAgICB9LFxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY2FsY3VsYXRpbmcgYm9va2luZyBlYXJuaW5nczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0ZhaWxlZCB0byBjYWxjdWxhdGUgZWFybmluZ3MnLFxyXG4gICAgfTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZXQgYSBzcGVjaWZpYyBib29raW5nIGJ5IElEIChvbmx5IGlmIGFzc2lnbmVkIHRvIGF1dGhlbnRpY2F0ZWQgY2xlYW5lcilcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDbGVhbmVyQm9va2luZ0J5SWQoXHJcbiAgYm9va2luZ0lkOiBzdHJpbmdcclxuKTogUHJvbWlzZTx7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBib29raW5nPzogQm9va2luZztcclxuICBlcnJvcj86IHN0cmluZztcclxufT4ge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBHZXQgYXV0aGVudGljYXRlZCBjbGVhbmVyIGZpcnN0XHJcbiAgICBjb25zdCBjbGVhbmVyUmVzdWx0ID0gYXdhaXQgZ2V0Q3VycmVudENsZWFuZXIoKTtcclxuICAgIGlmICghY2xlYW5lclJlc3VsdC5zdWNjZXNzIHx8ICFjbGVhbmVyUmVzdWx0LmNsZWFuZXIpIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnTm90IGF1dGhlbnRpY2F0ZWQgb3IgY2xlYW5lciBwcm9maWxlIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBjbGVhbmVySWQgPSBjbGVhbmVyUmVzdWx0LmNsZWFuZXIuaWQ7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xyXG5cclxuICAgIC8vIEZldGNoIHRoZSBib29raW5nXHJcbiAgICBjb25zdCB7IGRhdGE6IGJvb2tpbmcsIGVycm9yOiBmZXRjaEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnYm9va2luZ3MnKVxyXG4gICAgICAuc2VsZWN0KCcqJylcclxuICAgICAgLmVxKCdpZCcsIGJvb2tpbmdJZClcclxuICAgICAgLm1heWJlU2luZ2xlKCk7XHJcblxyXG4gICAgaWYgKGZldGNoRXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgYm9va2luZzonLCBmZXRjaEVycm9yKTtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnQm9va2luZyBub3QgZm91bmQnIH07XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCFib29raW5nKSB7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0Jvb2tpbmcgbm90IGZvdW5kJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFZlcmlmeSB0aGUgY2xlYW5lciBpcyBhc3NpZ25lZCB0byB0aGlzIGJvb2tpbmdcclxuICAgIGNvbnN0IG5vcm1hbGl6ZVV1aWQgPSAoaWQ6IGFueSk6IHN0cmluZyA9PiB7XHJcbiAgICAgIGlmICghaWQpIHJldHVybiAnJztcclxuICAgICAgcmV0dXJuIFN0cmluZyhpZCkudG9Mb3dlckNhc2UoKS50cmltKCk7XHJcbiAgICB9O1xyXG4gICAgY29uc3Qgbm9ybWFsaXplZENsZWFuZXJJZCA9IG5vcm1hbGl6ZVV1aWQoY2xlYW5lcklkKTtcclxuXHJcbiAgICAvLyBDaGVjayBzaW5nbGUgY2xlYW5lciBhc3NpZ25tZW50XHJcbiAgICBjb25zdCBpc0Fzc2lnbmVkU2luZ2xlID0gYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZCAmJiBcclxuICAgICAgbm9ybWFsaXplVXVpZChib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkKSA9PT0gbm9ybWFsaXplZENsZWFuZXJJZDtcclxuXHJcbiAgICAvLyBDaGVjayBtdWx0aXBsZSBjbGVhbmVyIGFzc2lnbm1lbnRcclxuICAgIGxldCBpc0Fzc2lnbmVkTXVsdGlwbGUgPSBmYWxzZTtcclxuICAgIGlmIChib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcyAmJiBBcnJheS5pc0FycmF5KGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWRzKSkge1xyXG4gICAgICBpc0Fzc2lnbmVkTXVsdGlwbGUgPSBib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcy5zb21lKFxyXG4gICAgICAgIChpZDogc3RyaW5nKSA9PiBub3JtYWxpemVVdWlkKGlkKSA9PT0gbm9ybWFsaXplZENsZWFuZXJJZFxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICghaXNBc3NpZ25lZFNpbmdsZSAmJiAhaXNBc3NpZ25lZE11bHRpcGxlKSB7XHJcbiAgICAgIHJldHVybiB7IFxyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcclxuICAgICAgICBlcnJvcjogJ1VuYXV0aG9yaXplZDogWW91IGFyZSBub3QgYXNzaWduZWQgdG8gdGhpcyBib29raW5nJyBcclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBib29raW5nOiBib29raW5nIGFzIEJvb2tpbmcgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gZ2V0Q2xlYW5lckJvb2tpbmdCeUlkOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnRmFpbGVkIHRvIGZldGNoIGJvb2tpbmcnLFxyXG4gICAgfTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBVcGRhdGUgYm9va2luZyBzdGF0dXMgKHdpdGggYXV0aG9yaXphdGlvbiBjaGVjayBmb3IgYXV0aGVudGljYXRlZCBjbGVhbmVyKVxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUJvb2tpbmdTdGF0dXMoXHJcbiAgYm9va2luZ0lkOiBzdHJpbmcsXHJcbiAgc3RhdHVzOiBCb29raW5nWydzdGF0dXMnXVxyXG4pOiBQcm9taXNlPHtcclxuICBzdWNjZXNzOiBib29sZWFuO1xyXG4gIGJvb2tpbmc/OiBCb29raW5nO1xyXG4gIGVycm9yPzogc3RyaW5nO1xyXG59PiB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIEdldCBhdXRoZW50aWNhdGVkIGNsZWFuZXIgZmlyc3RcclxuICAgIGNvbnN0IGNsZWFuZXJSZXN1bHQgPSBhd2FpdCBnZXRDdXJyZW50Q2xlYW5lcigpO1xyXG4gICAgaWYgKCFjbGVhbmVyUmVzdWx0LnN1Y2Nlc3MgfHwgIWNsZWFuZXJSZXN1bHQuY2xlYW5lcikge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdOb3QgYXV0aGVudGljYXRlZCBvciBjbGVhbmVyIHByb2ZpbGUgbm90IGZvdW5kJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGNsZWFuZXJJZCA9IGNsZWFuZXJSZXN1bHQuY2xlYW5lci5pZDtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQ2xpZW50KCk7XHJcblxyXG4gICAgLy8gRmlyc3QsIHZlcmlmeSB0aGUgY2xlYW5lciBpcyBhc3NpZ25lZCB0byB0aGlzIGJvb2tpbmdcclxuICAgIGNvbnN0IHsgZGF0YTogYm9va2luZywgZXJyb3I6IGZldGNoRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdib29raW5ncycpXHJcbiAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAuZXEoJ2lkJywgYm9va2luZ0lkKVxyXG4gICAgICAubWF5YmVTaW5nbGUoKTtcclxuXHJcbiAgICBpZiAoZmV0Y2hFcnJvciB8fCAhYm9va2luZykge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdCb29raW5nIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDaGVjayBhdXRob3JpemF0aW9uOiBjbGVhbmVyIG11c3QgYmUgYXNzaWduZWQgdG8gdGhpcyBib29raW5nXHJcbiAgICBjb25zdCBub3JtYWxpemVVdWlkID0gKGlkOiBhbnkpOiBzdHJpbmcgPT4ge1xyXG4gICAgICBpZiAoIWlkKSByZXR1cm4gJyc7XHJcbiAgICAgIHJldHVybiBTdHJpbmcoaWQpLnRvTG93ZXJDYXNlKCkudHJpbSgpO1xyXG4gICAgfTtcclxuICAgIGNvbnN0IG5vcm1hbGl6ZWRDbGVhbmVySWQgPSBub3JtYWxpemVVdWlkKGNsZWFuZXJJZCk7XHJcblxyXG4gICAgY29uc3QgaXNBc3NpZ25lZFNpbmdsZSA9IGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWQgJiYgXHJcbiAgICAgIG5vcm1hbGl6ZVV1aWQoYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZCkgPT09IG5vcm1hbGl6ZWRDbGVhbmVySWQ7XHJcblxyXG4gICAgbGV0IGlzQXNzaWduZWRNdWx0aXBsZSA9IGZhbHNlO1xyXG4gICAgaWYgKGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWRzICYmIEFycmF5LmlzQXJyYXkoYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMpKSB7XHJcbiAgICAgIGlzQXNzaWduZWRNdWx0aXBsZSA9IGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWRzLnNvbWUoXHJcbiAgICAgICAgKGlkOiBzdHJpbmcpID0+IG5vcm1hbGl6ZVV1aWQoaWQpID09PSBub3JtYWxpemVkQ2xlYW5lcklkXHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgaXNBc3NpZ25lZCA9IGlzQXNzaWduZWRTaW5nbGUgfHwgaXNBc3NpZ25lZE11bHRpcGxlO1xyXG5cclxuICAgIGlmICghaXNBc3NpZ25lZCkge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdVbmF1dGhvcml6ZWQ6IFlvdSBhcmUgbm90IGFzc2lnbmVkIHRvIHRoaXMgYm9va2luZycgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBWYWxpZGF0ZSBzdGF0dXMgdHJhbnNpdGlvblxyXG4gICAgY29uc3QgdmFsaWRUcmFuc2l0aW9uczogUmVjb3JkPHN0cmluZywgc3RyaW5nW10+ID0ge1xyXG4gICAgICAncGVuZGluZyc6IFsnY29uZmlybWVkJywgJ2NhbmNlbGxlZCddLFxyXG4gICAgICAnY29uZmlybWVkJzogWydvbl9teV93YXknLCAnY2FuY2VsbGVkJ10sXHJcbiAgICAgICdvbl9teV93YXknOiBbJ3N0YXJ0ZWQnLCAnY2FuY2VsbGVkJ10sXHJcbiAgICAgICdzdGFydGVkJzogWydjb21wbGV0ZWQnLCAnY2FuY2VsbGVkJ10sXHJcbiAgICAgICdjb21wbGV0ZWQnOiBbXSxcclxuICAgICAgJ2NhbmNlbGxlZCc6IFtdLFxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCBjdXJyZW50U3RhdHVzID0gYm9va2luZy5zdGF0dXM7XHJcbiAgICBjb25zdCBhbGxvd2VkU3RhdHVzZXMgPSB2YWxpZFRyYW5zaXRpb25zW2N1cnJlbnRTdGF0dXNdIHx8IFtdO1xyXG4gICAgXHJcbiAgICBpZiAoIWFsbG93ZWRTdGF0dXNlcy5pbmNsdWRlcyhzdGF0dXMpICYmIHN0YXR1cyAhPT0gY3VycmVudFN0YXR1cykge1xyXG4gICAgICByZXR1cm4geyBcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSwgXHJcbiAgICAgICAgZXJyb3I6IGBJbnZhbGlkIHN0YXR1cyB0cmFuc2l0aW9uOiBjYW5ub3QgY2hhbmdlIGZyb20gJHtjdXJyZW50U3RhdHVzfSB0byAke3N0YXR1c31gIFxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFVwZGF0ZSBib29raW5nIHN0YXR1c1xyXG4gICAgY29uc3QgeyBkYXRhOiB1cGRhdGVkQm9va2luZywgZXJyb3I6IHVwZGF0ZUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnYm9va2luZ3MnKVxyXG4gICAgICAudXBkYXRlKHsgXHJcbiAgICAgICAgc3RhdHVzLFxyXG4gICAgICAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgfSlcclxuICAgICAgLmVxKCdpZCcsIGJvb2tpbmdJZClcclxuICAgICAgLnNlbGVjdCgpXHJcbiAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICBpZiAodXBkYXRlRXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgYm9va2luZyBzdGF0dXM6JywgdXBkYXRlRXJyb3IpO1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IHVwZGF0ZUVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBib29raW5nOiB1cGRhdGVkQm9va2luZyBhcyBCb29raW5nIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIHVwZGF0ZUJvb2tpbmdTdGF0dXM6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdGYWlsZWQgdG8gdXBkYXRlIGJvb2tpbmcgc3RhdHVzJyxcclxuICAgIH07XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogUmVwb3J0IGxhdGVuZXNzIGZvciBhIGJvb2tpbmcgKHdpdGggYXV0aG9yaXphdGlvbiBjaGVjayBmb3IgYXV0aGVudGljYXRlZCBjbGVhbmVyKVxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlcG9ydExhdGVuZXNzKFxyXG4gIGJvb2tpbmdJZDogc3RyaW5nLFxyXG4gIGV4cGVjdGVkQXJyaXZhbFRpbWU6IHN0cmluZywgLy8gSVNPIHRpbWVzdGFtcFxyXG4gIHJlYXNvbjogc3RyaW5nXHJcbik6IFByb21pc2U8e1xyXG4gIHN1Y2Nlc3M6IGJvb2xlYW47XHJcbiAgYm9va2luZz86IEJvb2tpbmc7XHJcbiAgZXJyb3I/OiBzdHJpbmc7XHJcbn0+IHtcclxuICB0cnkge1xyXG4gICAgLy8gR2V0IGF1dGhlbnRpY2F0ZWQgY2xlYW5lciBmaXJzdFxyXG4gICAgY29uc3QgY2xlYW5lclJlc3VsdCA9IGF3YWl0IGdldEN1cnJlbnRDbGVhbmVyKCk7XHJcbiAgICBpZiAoIWNsZWFuZXJSZXN1bHQuc3VjY2VzcyB8fCAhY2xlYW5lclJlc3VsdC5jbGVhbmVyKSB7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ05vdCBhdXRoZW50aWNhdGVkIG9yIGNsZWFuZXIgcHJvZmlsZSBub3QgZm91bmQnIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgY2xlYW5lcklkID0gY2xlYW5lclJlc3VsdC5jbGVhbmVyLmlkO1xyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBhd2FpdCBjcmVhdGVDbGllbnQoKTtcclxuXHJcbiAgICAvLyBWZXJpZnkgYXV0aG9yaXphdGlvblxyXG4gICAgY29uc3QgeyBkYXRhOiBib29raW5nLCBlcnJvcjogZmV0Y2hFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2Jvb2tpbmdzJylcclxuICAgICAgLnNlbGVjdCgnKicpXHJcbiAgICAgIC5lcSgnaWQnLCBib29raW5nSWQpXHJcbiAgICAgIC5tYXliZVNpbmdsZSgpO1xyXG5cclxuICAgIGlmIChmZXRjaEVycm9yIHx8ICFib29raW5nKSB7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0Jvb2tpbmcgbm90IGZvdW5kJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENoZWNrIGF1dGhvcml6YXRpb246IGNsZWFuZXIgbXVzdCBiZSBhc3NpZ25lZCB0byB0aGlzIGJvb2tpbmdcclxuICAgIGNvbnN0IG5vcm1hbGl6ZVV1aWQgPSAoaWQ6IGFueSk6IHN0cmluZyA9PiB7XHJcbiAgICAgIGlmICghaWQpIHJldHVybiAnJztcclxuICAgICAgcmV0dXJuIFN0cmluZyhpZCkudG9Mb3dlckNhc2UoKS50cmltKCk7XHJcbiAgICB9O1xyXG4gICAgY29uc3Qgbm9ybWFsaXplZENsZWFuZXJJZCA9IG5vcm1hbGl6ZVV1aWQoY2xlYW5lcklkKTtcclxuXHJcbiAgICBjb25zdCBpc0Fzc2lnbmVkU2luZ2xlID0gYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZCAmJiBcclxuICAgICAgbm9ybWFsaXplVXVpZChib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkKSA9PT0gbm9ybWFsaXplZENsZWFuZXJJZDtcclxuXHJcbiAgICBsZXQgaXNBc3NpZ25lZE11bHRpcGxlID0gZmFsc2U7XHJcbiAgICBpZiAoYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMgJiYgQXJyYXkuaXNBcnJheShib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcykpIHtcclxuICAgICAgaXNBc3NpZ25lZE11bHRpcGxlID0gYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMuc29tZShcclxuICAgICAgICAoaWQ6IHN0cmluZykgPT4gbm9ybWFsaXplVXVpZChpZCkgPT09IG5vcm1hbGl6ZWRDbGVhbmVySWRcclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBpc0Fzc2lnbmVkID0gaXNBc3NpZ25lZFNpbmdsZSB8fCBpc0Fzc2lnbmVkTXVsdGlwbGU7XHJcblxyXG4gICAgaWYgKCFpc0Fzc2lnbmVkKSB7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1VuYXV0aG9yaXplZDogWW91IGFyZSBub3QgYXNzaWduZWQgdG8gdGhpcyBib29raW5nJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFVwZGF0ZSBib29raW5nIHdpdGggbGF0ZW5lc3MgaW5mb3JtYXRpb25cclxuICAgIGNvbnN0IHsgZGF0YTogdXBkYXRlZEJvb2tpbmcsIGVycm9yOiB1cGRhdGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2Jvb2tpbmdzJylcclxuICAgICAgLnVwZGF0ZSh7XHJcbiAgICAgICAgZXhwZWN0ZWRfYXJyaXZhbF90aW1lOiBleHBlY3RlZEFycml2YWxUaW1lLFxyXG4gICAgICAgIGxhdGVuZXNzX3JlYXNvbjogcmVhc29uLFxyXG4gICAgICAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgfSlcclxuICAgICAgLmVxKCdpZCcsIGJvb2tpbmdJZClcclxuICAgICAgLnNlbGVjdCgpXHJcbiAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICBpZiAodXBkYXRlRXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVwb3J0aW5nIGxhdGVuZXNzOicsIHVwZGF0ZUVycm9yKTtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiB1cGRhdGVFcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgYm9va2luZzogdXBkYXRlZEJvb2tpbmcgYXMgQm9va2luZyB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiByZXBvcnRMYXRlbmVzczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0ZhaWxlZCB0byByZXBvcnQgbGF0ZW5lc3MnLFxyXG4gICAgfTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDYWxjdWxhdGUgZWFybmluZ3MgZm9yIG11bHRpcGxlIGJvb2tpbmdzIGF0IG9uY2VcclxuICogVGhpcyBpcyBtb3JlIGVmZmljaWVudCB0aGFuIGNhbGN1bGF0aW5nIGVhcm5pbmdzIG9uZSBib29raW5nIGF0IGEgdGltZVxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNhbGN1bGF0ZUJvb2tpbmdzRWFybmluZ3MoYm9va2luZ0lkczogc3RyaW5nW10pOiBQcm9taXNlPHtcclxuICBzdWNjZXNzOiBib29sZWFuO1xyXG4gIGVhcm5pbmdzPzogUmVjb3JkPHN0cmluZywgeyBiYXNlRWFybmluZ3M6IG51bWJlcjsgdGlwQW1vdW50OiBudW1iZXI7IHRvdGFsRWFybmluZ3M6IG51bWJlciB9PjtcclxuICBlcnJvcj86IHN0cmluZztcclxufT4ge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBHZXQgYXV0aGVudGljYXRlZCBjbGVhbmVyIGZpcnN0XHJcbiAgICBjb25zdCBjbGVhbmVyUmVzdWx0ID0gYXdhaXQgZ2V0Q3VycmVudENsZWFuZXIoKTtcclxuICAgIGlmICghY2xlYW5lclJlc3VsdC5zdWNjZXNzIHx8ICFjbGVhbmVyUmVzdWx0LmNsZWFuZXIpIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnTm90IGF1dGhlbnRpY2F0ZWQgb3IgY2xlYW5lciBwcm9maWxlIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBjbGVhbmVySWQgPSBjbGVhbmVyUmVzdWx0LmNsZWFuZXIuaWQ7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xyXG5cclxuICAgIGlmIChib29raW5nSWRzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBlYXJuaW5nczoge30gfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBHZXQgY2xlYW5lciBpbmZvIGZvciB0ZW51cmUgY2FsY3VsYXRpb25cclxuICAgIGNvbnN0IHsgZGF0YTogY2xlYW5lciwgZXJyb3I6IGNsZWFuZXJFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2NsZWFuZXJzJylcclxuICAgICAgLnNlbGVjdCgnY3JlYXRlZF9hdCcpXHJcbiAgICAgIC5lcSgnaWQnLCBjbGVhbmVySWQpXHJcbiAgICAgIC5tYXliZVNpbmdsZSgpO1xyXG5cclxuICAgIGlmIChjbGVhbmVyRXJyb3IgfHwgIWNsZWFuZXIpIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnQ2xlYW5lciBub3QgZm91bmQnIH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gR2V0IGFsbCBib29raW5nc1xyXG4gICAgY29uc3QgeyBkYXRhOiBib29raW5ncywgZXJyb3I6IGJvb2tpbmdzRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdib29raW5ncycpXHJcbiAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAuaW4oJ2lkJywgYm9va2luZ0lkcyk7XHJcblxyXG4gICAgaWYgKGJvb2tpbmdzRXJyb3IgfHwgIWJvb2tpbmdzKSB7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0ZhaWxlZCB0byBmZXRjaCBib29raW5ncycgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBHZXQgYWxsIGNsZWFuZXIgYm9va2luZ3MgdG8gY2FsY3VsYXRlIGhvdXJzXHJcbiAgICBjb25zdCB7IGRhdGE6IHNpbmdsZUJvb2tpbmdzIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnYm9va2luZ3MnKVxyXG4gICAgICAuc2VsZWN0KCdzdGF0dXMsIHBheW1lbnRfc3RhdHVzLCBzZXJ2aWNlX2R1cmF0aW9uLCBwcmVmZXJyZWRfY2xlYW5lcl9pZCwgcHJlZmVycmVkX2NsZWFuZXJfaWRzJylcclxuICAgICAgLmVxKCdwcmVmZXJyZWRfY2xlYW5lcl9pZCcsIGNsZWFuZXJJZCk7XHJcblxyXG4gICAgY29uc3QgeyBkYXRhOiBhbGxNdWx0aUJvb2tpbmdzIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnYm9va2luZ3MnKVxyXG4gICAgICAuc2VsZWN0KCdzdGF0dXMsIHBheW1lbnRfc3RhdHVzLCBzZXJ2aWNlX2R1cmF0aW9uLCBwcmVmZXJyZWRfY2xlYW5lcl9pZCwgcHJlZmVycmVkX2NsZWFuZXJfaWRzJylcclxuICAgICAgLm5vdCgncHJlZmVycmVkX2NsZWFuZXJfaWRzJywgJ2lzJywgbnVsbCk7XHJcblxyXG4gICAgLy8gRmlsdGVyIGJvb2tpbmdzIGFzc2lnbmVkIHRvIHRoaXMgY2xlYW5lclxyXG4gICAgY29uc3Qgbm9ybWFsaXplVXVpZCA9IChpZDogYW55KTogc3RyaW5nID0+IHtcclxuICAgICAgaWYgKCFpZCkgcmV0dXJuICcnO1xyXG4gICAgICByZXR1cm4gU3RyaW5nKGlkKS50b0xvd2VyQ2FzZSgpLnRyaW0oKTtcclxuICAgIH07XHJcbiAgICBjb25zdCBub3JtYWxpemVkQ2xlYW5lcklkID0gbm9ybWFsaXplVXVpZChjbGVhbmVySWQpO1xyXG5cclxuICAgIGNvbnN0IGFycmF5Qm9va2luZ3MgPSAoYWxsTXVsdGlCb29raW5ncyB8fCBbXSkuZmlsdGVyKChiOiBhbnkpID0+IHtcclxuICAgICAgaWYgKCFiLnByZWZlcnJlZF9jbGVhbmVyX2lkcyB8fCAhQXJyYXkuaXNBcnJheShiLnByZWZlcnJlZF9jbGVhbmVyX2lkcykpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGIucHJlZmVycmVkX2NsZWFuZXJfaWRzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gYi5wcmVmZXJyZWRfY2xlYW5lcl9pZHMuc29tZSgoaWQ6IHN0cmluZykgPT4gbm9ybWFsaXplVXVpZChpZCkgPT09IG5vcm1hbGl6ZWRDbGVhbmVySWQpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gQ29tYmluZSBhbmQgcmVtb3ZlIGR1cGxpY2F0ZXNcclxuICAgIGNvbnN0IGFsbEJvb2tpbmdzTWFwID0gbmV3IE1hcDxzdHJpbmcsIGFueT4oKTtcclxuICAgIChzaW5nbGVCb29raW5ncyB8fCBbXSkuZm9yRWFjaCgoYjogYW55KSA9PiB7XHJcbiAgICAgIGlmIChiLmlkKSB7XHJcbiAgICAgICAgYWxsQm9va2luZ3NNYXAuc2V0KGIuaWQsIGIpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIGFycmF5Qm9va2luZ3MuZm9yRWFjaCgoYjogYW55KSA9PiB7XHJcbiAgICAgIGlmIChiLmlkICYmICFhbGxCb29raW5nc01hcC5oYXMoYi5pZCkpIHtcclxuICAgICAgICBhbGxCb29raW5nc01hcC5zZXQoYi5pZCwgYik7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGNvbnN0IGNsZWFuZXJCb29raW5ncyA9IEFycmF5LmZyb20oYWxsQm9va2luZ3NNYXAudmFsdWVzKCkpO1xyXG5cclxuICAgIC8vIENhbGN1bGF0ZSB0ZW51cmUgYW5kIGhvdXJzXHJcbiAgICBjb25zdCB0ZW51cmVNb250aHMgPSBjYWxjdWxhdGVDbGVhbmVyVGVudXJlKGNsZWFuZXIuY3JlYXRlZF9hdCk7XHJcbiAgICBjb25zdCB0b3RhbEhvdXJzID0gY2FsY3VsYXRlVG90YWxIb3VycyhjbGVhbmVyQm9va2luZ3MpO1xyXG4gICAgY29uc3QgZWFybmluZ3NQZXJjZW50YWdlID0gZ2V0RWFybmluZ3NQZXJjZW50YWdlKHRlbnVyZU1vbnRocywgdG90YWxIb3Vycyk7XHJcblxyXG4gICAgLy8gQ2FsY3VsYXRlIGVhcm5pbmdzIGZvciBlYWNoIGJvb2tpbmdcclxuICAgIGNvbnN0IGVhcm5pbmdzUmVjb3JkOiBSZWNvcmQ8c3RyaW5nLCB7IGJhc2VFYXJuaW5nczogbnVtYmVyOyB0aXBBbW91bnQ6IG51bWJlcjsgdG90YWxFYXJuaW5nczogbnVtYmVyIH0+ID0ge307XHJcblxyXG4gICAgZm9yIChjb25zdCBib29raW5nIG9mIGJvb2tpbmdzKSB7XHJcbiAgICAgIGNvbnN0IGJhc2VFYXJuaW5ncyA9IGNhbGN1bGF0ZUNsZWFuZXJFYXJuaW5ncyhcclxuICAgICAgICB7XHJcbiAgICAgICAgICBzZXJ2aWNlX3R5cGU6IGJvb2tpbmcuc2VydmljZV90eXBlIHx8ICcnLFxyXG4gICAgICAgICAgdG90YWxfYW1vdW50OiBOdW1iZXIoYm9va2luZy50b3RhbF9hbW91bnQpIHx8IDAsXHJcbiAgICAgICAgICBzZXJ2aWNlX2ZlZTogTnVtYmVyKGJvb2tpbmcuc2VydmljZV9mZWUpIHx8IDAsXHJcbiAgICAgICAgICBlcXVpcG1lbnRfc3VwcGx5X3ByaWNlOiBOdW1iZXIoYm9va2luZy5lcXVpcG1lbnRfc3VwcGx5X3ByaWNlKSB8fCAwLFxyXG4gICAgICAgICAgYWRkaXRpb25hbF9jbGVhbmVyc19wcmljZTogTnVtYmVyKGJvb2tpbmcuYWRkaXRpb25hbF9jbGVhbmVyc19wcmljZSkgfHwgMCxcclxuICAgICAgICAgIHByZWZlcnJlZF9jbGVhbmVyX2lkczogYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMsXHJcbiAgICAgICAgICBwcmVmZXJyZWRfY2xlYW5lcl9pZDogYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZCxcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNsZWFuZXJJZCxcclxuICAgICAgICBlYXJuaW5nc1BlcmNlbnRhZ2UsXHJcbiAgICAgICAgYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHNcclxuICAgICAgKTtcclxuXHJcbiAgICAgIGNvbnN0IHRpcEFtb3VudCA9IGNhbGN1bGF0ZVRpcFBlckNsZWFuZXIoXHJcbiAgICAgICAgTnVtYmVyKGJvb2tpbmcudGlwX2Ftb3VudCkgfHwgMCxcclxuICAgICAgICBib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcyxcclxuICAgICAgICBib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkXHJcbiAgICAgICk7XHJcblxyXG4gICAgICBlYXJuaW5nc1JlY29yZFtib29raW5nLmlkXSA9IHtcclxuICAgICAgICBiYXNlRWFybmluZ3MsXHJcbiAgICAgICAgdGlwQW1vdW50LFxyXG4gICAgICAgIHRvdGFsRWFybmluZ3M6IGJhc2VFYXJuaW5ncyArIHRpcEFtb3VudCxcclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBlYXJuaW5nczogZWFybmluZ3NSZWNvcmQgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY2FsY3VsYXRpbmcgYm9va2luZ3MgZWFybmluZ3M6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdGYWlsZWQgdG8gY2FsY3VsYXRlIGVhcm5pbmdzJyxcclxuICAgIH07XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogR2V0IGNsZWFuZXIgc3RhdGlzdGljcyBmb3IgdGhlIGF1dGhlbnRpY2F0ZWQgY2xlYW5lclxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENsZWFuZXJTdGF0cygpOiBQcm9taXNlPHtcclxuICBzdWNjZXNzOiBib29sZWFuO1xyXG4gIHN0YXRzPzoge1xyXG4gICAgdG90YWxCb29raW5nczogbnVtYmVyO1xyXG4gICAgY29tcGxldGVkQm9va2luZ3M6IG51bWJlcjtcclxuICAgIHVwY29taW5nQm9va2luZ3M6IG51bWJlcjtcclxuICAgIHRvZGF5Qm9va2luZ3M6IG51bWJlcjtcclxuICAgIHRvdGFsRWFybmluZ3M6IG51bWJlcjtcclxuICAgIG1vbnRobHlFYXJuaW5nczogbnVtYmVyO1xyXG4gICAgYXZlcmFnZVJhdGluZzogbnVtYmVyO1xyXG4gICAgcmVsaWFiaWxpdHlTY29yZTogbnVtYmVyO1xyXG4gICAgY29tcGxldGlvblJhdGU6IG51bWJlcjtcclxuICAgIG9uVGltZVJhdGU6IG51bWJlcjtcclxuICB9O1xyXG4gIGVycm9yPzogc3RyaW5nO1xyXG59PiB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIEdldCBhdXRoZW50aWNhdGVkIGNsZWFuZXIgZmlyc3RcclxuICAgIGNvbnN0IGNsZWFuZXJSZXN1bHQgPSBhd2FpdCBnZXRDdXJyZW50Q2xlYW5lcigpO1xyXG4gICAgaWYgKCFjbGVhbmVyUmVzdWx0LnN1Y2Nlc3MgfHwgIWNsZWFuZXJSZXN1bHQuY2xlYW5lcikge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdOb3QgYXV0aGVudGljYXRlZCBvciBjbGVhbmVyIHByb2ZpbGUgbm90IGZvdW5kJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGNsZWFuZXJJZCA9IGNsZWFuZXJSZXN1bHQuY2xlYW5lci5pZDtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQ2xpZW50KCk7XHJcblxyXG4gICAgLy8gR2V0IGNsZWFuZXIgaW5mbyBpbmNsdWRpbmcgY3JlYXRlZF9hdCBmb3IgdGVudXJlIGNhbGN1bGF0aW9uXHJcbiAgICBjb25zdCB7IGRhdGE6IGNsZWFuZXIsIGVycm9yOiBjbGVhbmVyRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdjbGVhbmVycycpXHJcbiAgICAgIC5zZWxlY3QoJ3JhdGluZywgcmVsaWFiaWxpdHlfc2NvcmUsIHRvdGFsX2Jvb2tpbmdzLCBjb21wbGV0ZWRfYm9va2luZ3MsIG9uX3RpbWVfYm9va2luZ3MsIGNyZWF0ZWRfYXQnKVxyXG4gICAgICAuZXEoJ2lkJywgY2xlYW5lcklkKVxyXG4gICAgICAubWF5YmVTaW5nbGUoKTtcclxuXHJcbiAgICBpZiAoY2xlYW5lckVycm9yIHx8ICFjbGVhbmVyKSB7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0NsZWFuZXIgbm90IGZvdW5kJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEdldCBhbGwgYm9va2luZ3MgYXNzaWduZWQgdG8gdGhpcyBjbGVhbmVyXHJcbiAgICAvLyBGZXRjaCBib29raW5ncyB3aXRoIHByZWZlcnJlZF9jbGVhbmVyX2lkIChzaW5nbGUpIC0gaW5jbHVkZSBhbGwgZmllbGRzIG5lZWRlZCBmb3IgZWFybmluZ3MgY2FsY3VsYXRpb25cclxuICAgIGNvbnN0IHsgZGF0YTogc2luZ2xlQm9va2luZ3MsIGVycm9yOiBzaW5nbGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2Jvb2tpbmdzJylcclxuICAgICAgLnNlbGVjdCgnaWQsIHN0YXR1cywgc2VydmljZV9kYXRlLCB0b3RhbF9hbW91bnQsIHBheW1lbnRfc3RhdHVzLCBzZXJ2aWNlX3R5cGUsIHNlcnZpY2VfZmVlLCBzdWJ0b3RhbCwgdGlwX2Ftb3VudCwgc2VydmljZV9kdXJhdGlvbiwgZXF1aXBtZW50X3N1cHBseV9wcmljZSwgYWRkaXRpb25hbF9jbGVhbmVyc19wcmljZSwgcHJlZmVycmVkX2NsZWFuZXJfaWQsIHByZWZlcnJlZF9jbGVhbmVyX2lkcycpXHJcbiAgICAgIC5lcSgncHJlZmVycmVkX2NsZWFuZXJfaWQnLCBjbGVhbmVySWQpO1xyXG5cclxuICAgIC8vIEZldGNoIGJvb2tpbmdzIHdpdGggcHJlZmVycmVkX2NsZWFuZXJfaWRzIChhcnJheSkgLSBmZXRjaCBhbGwgd2l0aCBhcnJheXMsIHRoZW4gZmlsdGVyIGluIEpTXHJcbiAgICBjb25zdCB7IGRhdGE6IGFsbE11bHRpQm9va2luZ3MsIGVycm9yOiBtdWx0aUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnYm9va2luZ3MnKVxyXG4gICAgICAuc2VsZWN0KCdpZCwgc3RhdHVzLCBzZXJ2aWNlX2RhdGUsIHRvdGFsX2Ftb3VudCwgcGF5bWVudF9zdGF0dXMsIHNlcnZpY2VfdHlwZSwgc2VydmljZV9mZWUsIHN1YnRvdGFsLCB0aXBfYW1vdW50LCBzZXJ2aWNlX2R1cmF0aW9uLCBlcXVpcG1lbnRfc3VwcGx5X3ByaWNlLCBhZGRpdGlvbmFsX2NsZWFuZXJzX3ByaWNlLCBwcmVmZXJyZWRfY2xlYW5lcl9pZHMsIHByZWZlcnJlZF9jbGVhbmVyX2lkJylcclxuICAgICAgLm5vdCgncHJlZmVycmVkX2NsZWFuZXJfaWRzJywgJ2lzJywgbnVsbCk7XHJcblxyXG4gICAgaWYgKHNpbmdsZUVycm9yIHx8IG11bHRpRXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgYm9va2luZ3MgZm9yIHN0YXRzOicsIHNpbmdsZUVycm9yIHx8IG11bHRpRXJyb3IpO1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IChzaW5nbGVFcnJvciB8fCBtdWx0aUVycm9yKT8ubWVzc2FnZSB8fCAnRmFpbGVkIHRvIGZldGNoIGJvb2tpbmdzJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIERlYnVnIGxvZ2dpbmdcclxuICAgIGNvbnNvbGUubG9nKCdbZ2V0Q2xlYW5lclN0YXRzXSBGZXRjaGVkIGJvb2tpbmdzOicsIHtcclxuICAgICAgY2xlYW5lcklkLFxyXG4gICAgICBzaW5nbGVCb29raW5nc0NvdW50OiBzaW5nbGVCb29raW5ncz8ubGVuZ3RoIHx8IDAsXHJcbiAgICAgIGFsbE11bHRpQm9va2luZ3NDb3VudDogYWxsTXVsdGlCb29raW5ncz8ubGVuZ3RoIHx8IDAsXHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBGaWx0ZXIgYm9va2luZ3Mgd2hlcmUgcHJlZmVycmVkX2NsZWFuZXJfaWRzIGFycmF5IGNvbnRhaW5zIHRoaXMgY2xlYW5lcklkXHJcbiAgICAvLyBOb3JtYWxpemUgVVVJRHMgZm9yIGNvbXBhcmlzb24gKGhhbmRsZSBjYXNlIGRpZmZlcmVuY2VzIGFuZCBzdHJpbmcgZm9ybWF0cylcclxuICAgIGNvbnN0IG5vcm1hbGl6ZVV1aWQgPSAoaWQ6IGFueSk6IHN0cmluZyA9PiB7XHJcbiAgICAgIGlmICghaWQpIHJldHVybiAnJztcclxuICAgICAgcmV0dXJuIFN0cmluZyhpZCkudG9Mb3dlckNhc2UoKS50cmltKCk7XHJcbiAgICB9O1xyXG4gICAgY29uc3Qgbm9ybWFsaXplZENsZWFuZXJJZCA9IG5vcm1hbGl6ZVV1aWQoY2xlYW5lcklkKTtcclxuICAgIFxyXG4gICAgY29uc3QgYXJyYXlCb29raW5ncyA9IChhbGxNdWx0aUJvb2tpbmdzIHx8IFtdKS5maWx0ZXIoKGJvb2tpbmc6IGFueSkgPT4ge1xyXG4gICAgICBpZiAoIWJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWRzIHx8ICFBcnJheS5pc0FycmF5KGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWRzKSkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgICAvLyBDaGVjayBpZiBhcnJheSBpcyBlbXB0eVxyXG4gICAgICBpZiAoYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICAgIC8vIENoZWNrIGlmIGFueSBJRCBpbiB0aGUgYXJyYXkgbWF0Y2hlcyB0aGUgY2xlYW5lcklkIChjYXNlLWluc2Vuc2l0aXZlKVxyXG4gICAgICByZXR1cm4gYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMuc29tZSgoaWQ6IHN0cmluZykgPT4gbm9ybWFsaXplVXVpZChpZCkgPT09IG5vcm1hbGl6ZWRDbGVhbmVySWQpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gQ29tYmluZSBhbmQgcmVtb3ZlIGR1cGxpY2F0ZXMgYnkgSURcclxuICAgIGNvbnN0IGFsbEJvb2tpbmdzTWFwID0gbmV3IE1hcDxzdHJpbmcsIGFueT4oKTtcclxuICAgIChzaW5nbGVCb29raW5ncyB8fCBbXSkuZm9yRWFjaCgoYm9va2luZzogYW55KSA9PiB7XHJcbiAgICAgIGlmIChib29raW5nLmlkKSB7XHJcbiAgICAgICAgYWxsQm9va2luZ3NNYXAuc2V0KGJvb2tpbmcuaWQsIGJvb2tpbmcpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIGFycmF5Qm9va2luZ3MuZm9yRWFjaCgoYm9va2luZzogYW55KSA9PiB7XHJcbiAgICAgIGlmIChib29raW5nLmlkICYmICFhbGxCb29raW5nc01hcC5oYXMoYm9va2luZy5pZCkpIHtcclxuICAgICAgICBhbGxCb29raW5nc01hcC5zZXQoYm9va2luZy5pZCwgYm9va2luZyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBjb25zdCBhbGxCb29raW5ncyA9IEFycmF5LmZyb20oYWxsQm9va2luZ3NNYXAudmFsdWVzKCkpO1xyXG5cclxuICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XHJcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xyXG4gICAgY29uc3QgZmlyc3REYXlPZk1vbnRoID0gbmV3IERhdGUobm93LmdldEZ1bGxZZWFyKCksIG5vdy5nZXRNb250aCgpLCAxKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XHJcbiAgICBjb25zdCBjb21wbGV0ZWRCb29raW5ncyA9IGFsbEJvb2tpbmdzLmZpbHRlcihiID0+IGIuc3RhdHVzID09PSAnY29tcGxldGVkJyk7XHJcbiAgICBjb25zdCB1cGNvbWluZ0Jvb2tpbmdzID0gYWxsQm9va2luZ3MuZmlsdGVyKGIgPT4gXHJcbiAgICAgIFsncGVuZGluZycsICdjb25maXJtZWQnLCAnb25fbXlfd2F5JywgJ3N0YXJ0ZWQnXS5pbmNsdWRlcyhiLnN0YXR1cykgJiZcclxuICAgICAgYi5zZXJ2aWNlX2RhdGUgPj0gdG9kYXlcclxuICAgICk7XHJcbiAgICBjb25zdCB0b2RheUJvb2tpbmdzID0gYWxsQm9va2luZ3MuZmlsdGVyKGIgPT4gYi5zZXJ2aWNlX2RhdGUgPT09IHRvZGF5KTtcclxuICAgIGNvbnN0IHBhaWRCb29raW5ncyA9IGFsbEJvb2tpbmdzLmZpbHRlcihiID0+IGIucGF5bWVudF9zdGF0dXMgPT09ICdwYWlkJyk7XHJcbiAgICBjb25zdCBtb250aGx5UGFpZEJvb2tpbmdzID0gcGFpZEJvb2tpbmdzLmZpbHRlcihiID0+IGIuc2VydmljZV9kYXRlID49IGZpcnN0RGF5T2ZNb250aCk7XHJcblxyXG4gICAgLy8gQ2FsY3VsYXRlIGNsZWFuZXIgdGVudXJlIGFuZCB0b3RhbCBob3VycyBmb3IgZWxpZ2liaWxpdHkgZGV0ZXJtaW5hdGlvblxyXG4gICAgY29uc3QgdGVudXJlTW9udGhzID0gY2FsY3VsYXRlQ2xlYW5lclRlbnVyZShjbGVhbmVyLmNyZWF0ZWRfYXQpO1xyXG4gICAgY29uc3QgdG90YWxIb3VycyA9IGNhbGN1bGF0ZVRvdGFsSG91cnMoYWxsQm9va2luZ3MpO1xyXG4gICAgY29uc3QgZWFybmluZ3NQZXJjZW50YWdlID0gZ2V0RWFybmluZ3NQZXJjZW50YWdlKHRlbnVyZU1vbnRocywgdG90YWxIb3Vycyk7XHJcblxyXG4gICAgLy8gQ2FsY3VsYXRlIGVhcm5pbmdzIHVzaW5nIHRoZSBuZXcgc3lzdGVtXHJcbiAgICAvLyBPbmx5IGNhbGN1bGF0ZSBlYXJuaW5ncyBmb3IgcGFpZCBib29raW5ncyAoZWFybmluZ3MgYXJlIG9ubHkgcGFpZCB3aGVuIGN1c3RvbWVyIGhhcyBwYWlkKVxyXG4gICAgLy8gRXF1aXBtZW50IGZlZSBhbmQgYWRkaXRpb25hbCBjbGVhbmVycyBjaGFyZ2VzIGFyZSBleGNsdWRlZCBmcm9tIGNsZWFuZXIgZWFybmluZ3NcclxuICAgIGNvbnN0IHRvdGFsRWFybmluZ3MgPSBwYWlkQm9va2luZ3MucmVkdWNlKChzdW0sIGJvb2tpbmcpID0+IHtcclxuICAgICAgY29uc3QgZWFybmluZ3MgPSBjYWxjdWxhdGVUb3RhbEVhcm5pbmdzRnJvbUJvb2tpbmcoXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgc2VydmljZV90eXBlOiBib29raW5nLnNlcnZpY2VfdHlwZSB8fCAnJyxcclxuICAgICAgICAgIHRvdGFsX2Ftb3VudDogTnVtYmVyKGJvb2tpbmcudG90YWxfYW1vdW50KSB8fCAwLFxyXG4gICAgICAgICAgc2VydmljZV9mZWU6IE51bWJlcihib29raW5nLnNlcnZpY2VfZmVlKSB8fCAwLFxyXG4gICAgICAgICAgZXF1aXBtZW50X3N1cHBseV9wcmljZTogTnVtYmVyKGJvb2tpbmcuZXF1aXBtZW50X3N1cHBseV9wcmljZSkgfHwgMCxcclxuICAgICAgICAgIGFkZGl0aW9uYWxfY2xlYW5lcnNfcHJpY2U6IE51bWJlcihib29raW5nLmFkZGl0aW9uYWxfY2xlYW5lcnNfcHJpY2UpIHx8IDAsXHJcbiAgICAgICAgICB0aXBfYW1vdW50OiBOdW1iZXIoYm9va2luZy50aXBfYW1vdW50KSB8fCAwLFxyXG4gICAgICAgICAgcHJlZmVycmVkX2NsZWFuZXJfaWRzOiBib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcyxcclxuICAgICAgICAgIHByZWZlcnJlZF9jbGVhbmVyX2lkOiBib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY2xlYW5lcklkLFxyXG4gICAgICAgIGVhcm5pbmdzUGVyY2VudGFnZVxyXG4gICAgICApO1xyXG4gICAgICByZXR1cm4gc3VtICsgZWFybmluZ3M7XHJcbiAgICB9LCAwKTtcclxuXHJcbiAgICBjb25zdCBtb250aGx5RWFybmluZ3MgPSBtb250aGx5UGFpZEJvb2tpbmdzLnJlZHVjZSgoc3VtLCBib29raW5nKSA9PiB7XHJcbiAgICAgIGNvbnN0IGVhcm5pbmdzID0gY2FsY3VsYXRlVG90YWxFYXJuaW5nc0Zyb21Cb29raW5nKFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIHNlcnZpY2VfdHlwZTogYm9va2luZy5zZXJ2aWNlX3R5cGUgfHwgJycsXHJcbiAgICAgICAgICB0b3RhbF9hbW91bnQ6IE51bWJlcihib29raW5nLnRvdGFsX2Ftb3VudCkgfHwgMCxcclxuICAgICAgICAgIHNlcnZpY2VfZmVlOiBOdW1iZXIoYm9va2luZy5zZXJ2aWNlX2ZlZSkgfHwgMCxcclxuICAgICAgICAgIGVxdWlwbWVudF9zdXBwbHlfcHJpY2U6IE51bWJlcihib29raW5nLmVxdWlwbWVudF9zdXBwbHlfcHJpY2UpIHx8IDAsXHJcbiAgICAgICAgICBhZGRpdGlvbmFsX2NsZWFuZXJzX3ByaWNlOiBOdW1iZXIoYm9va2luZy5hZGRpdGlvbmFsX2NsZWFuZXJzX3ByaWNlKSB8fCAwLFxyXG4gICAgICAgICAgdGlwX2Ftb3VudDogTnVtYmVyKGJvb2tpbmcudGlwX2Ftb3VudCkgfHwgMCxcclxuICAgICAgICAgIHByZWZlcnJlZF9jbGVhbmVyX2lkczogYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMsXHJcbiAgICAgICAgICBwcmVmZXJyZWRfY2xlYW5lcl9pZDogYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZCxcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNsZWFuZXJJZCxcclxuICAgICAgICBlYXJuaW5nc1BlcmNlbnRhZ2VcclxuICAgICAgKTtcclxuICAgICAgcmV0dXJuIHN1bSArIGVhcm5pbmdzO1xyXG4gICAgfSwgMCk7XHJcblxyXG4gICAgY29uc3QgY29tcGxldGlvblJhdGUgPSBjbGVhbmVyLnRvdGFsX2Jvb2tpbmdzIFxyXG4gICAgICA/IChjbGVhbmVyLmNvbXBsZXRlZF9ib29raW5ncyB8fCAwKSAvIGNsZWFuZXIudG90YWxfYm9va2luZ3MgKiAxMDAgXHJcbiAgICAgIDogMDtcclxuICAgIFxyXG4gICAgY29uc3Qgb25UaW1lUmF0ZSA9IGNsZWFuZXIuY29tcGxldGVkX2Jvb2tpbmdzXHJcbiAgICAgID8gKGNsZWFuZXIub25fdGltZV9ib29raW5ncyB8fCAwKSAvIGNsZWFuZXIuY29tcGxldGVkX2Jvb2tpbmdzICogMTAwXHJcbiAgICAgIDogMDtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICBzdGF0czoge1xyXG4gICAgICAgIHRvdGFsQm9va2luZ3M6IGFsbEJvb2tpbmdzLmxlbmd0aCxcclxuICAgICAgICBjb21wbGV0ZWRCb29raW5nczogY29tcGxldGVkQm9va2luZ3MubGVuZ3RoLFxyXG4gICAgICAgIHVwY29taW5nQm9va2luZ3M6IHVwY29taW5nQm9va2luZ3MubGVuZ3RoLFxyXG4gICAgICAgIHRvZGF5Qm9va2luZ3M6IHRvZGF5Qm9va2luZ3MubGVuZ3RoLFxyXG4gICAgICAgIHRvdGFsRWFybmluZ3MsXHJcbiAgICAgICAgbW9udGhseUVhcm5pbmdzLFxyXG4gICAgICAgIGF2ZXJhZ2VSYXRpbmc6IE51bWJlcihjbGVhbmVyLnJhdGluZykgfHwgMCxcclxuICAgICAgICByZWxpYWJpbGl0eVNjb3JlOiBOdW1iZXIoY2xlYW5lci5yZWxpYWJpbGl0eV9zY29yZSkgfHwgMCxcclxuICAgICAgICBjb21wbGV0aW9uUmF0ZSxcclxuICAgICAgICBvblRpbWVSYXRlLFxyXG4gICAgICB9LFxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gZ2V0Q2xlYW5lclN0YXRzOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnRmFpbGVkIHRvIGZldGNoIHN0YXRzJyxcclxuICAgIH07XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogVXBkYXRlIGNsZWFuZXIgYXZhaWxhYmlsaXR5XHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlQ2xlYW5lckF2YWlsYWJpbGl0eShcclxuICBjbGVhbmVySWQ6IHN0cmluZyxcclxuICB1cGRhdGVzOiB7XHJcbiAgICBpc0F2YWlsYWJsZT86IGJvb2xlYW47XHJcbiAgICBhdmFpbGFibGVNb25kYXk/OiBib29sZWFuO1xyXG4gICAgYXZhaWxhYmxlVHVlc2RheT86IGJvb2xlYW47XHJcbiAgICBhdmFpbGFibGVXZWRuZXNkYXk/OiBib29sZWFuO1xyXG4gICAgYXZhaWxhYmxlVGh1cnNkYXk/OiBib29sZWFuO1xyXG4gICAgYXZhaWxhYmxlRnJpZGF5PzogYm9vbGVhbjtcclxuICAgIGF2YWlsYWJsZVNhdHVyZGF5PzogYm9vbGVhbjtcclxuICAgIGF2YWlsYWJsZVN1bmRheT86IGJvb2xlYW47XHJcbiAgfVxyXG4pOiBQcm9taXNlPHtcclxuICBzdWNjZXNzOiBib29sZWFuO1xyXG4gIGNsZWFuZXI/OiBDbGVhbmVyO1xyXG4gIGVycm9yPzogc3RyaW5nO1xyXG59PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQ2xpZW50KCk7XHJcblxyXG4gICAgY29uc3QgdXBkYXRlRGF0YTogYW55ID0ge1xyXG4gICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICB9O1xyXG5cclxuICAgIGlmICh1cGRhdGVzLmlzQXZhaWxhYmxlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgdXBkYXRlRGF0YS5pc19hdmFpbGFibGUgPSB1cGRhdGVzLmlzQXZhaWxhYmxlO1xyXG4gICAgfVxyXG4gICAgaWYgKHVwZGF0ZXMuYXZhaWxhYmxlTW9uZGF5ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgdXBkYXRlRGF0YS5hdmFpbGFibGVfbW9uZGF5ID0gdXBkYXRlcy5hdmFpbGFibGVNb25kYXk7XHJcbiAgICB9XHJcbiAgICBpZiAodXBkYXRlcy5hdmFpbGFibGVUdWVzZGF5ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgdXBkYXRlRGF0YS5hdmFpbGFibGVfdHVlc2RheSA9IHVwZGF0ZXMuYXZhaWxhYmxlVHVlc2RheTtcclxuICAgIH1cclxuICAgIGlmICh1cGRhdGVzLmF2YWlsYWJsZVdlZG5lc2RheSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHVwZGF0ZURhdGEuYXZhaWxhYmxlX3dlZG5lc2RheSA9IHVwZGF0ZXMuYXZhaWxhYmxlV2VkbmVzZGF5O1xyXG4gICAgfVxyXG4gICAgaWYgKHVwZGF0ZXMuYXZhaWxhYmxlVGh1cnNkYXkgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB1cGRhdGVEYXRhLmF2YWlsYWJsZV90aHVyc2RheSA9IHVwZGF0ZXMuYXZhaWxhYmxlVGh1cnNkYXk7XHJcbiAgICB9XHJcbiAgICBpZiAodXBkYXRlcy5hdmFpbGFibGVGcmlkYXkgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB1cGRhdGVEYXRhLmF2YWlsYWJsZV9mcmlkYXkgPSB1cGRhdGVzLmF2YWlsYWJsZUZyaWRheTtcclxuICAgIH1cclxuICAgIGlmICh1cGRhdGVzLmF2YWlsYWJsZVNhdHVyZGF5ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgdXBkYXRlRGF0YS5hdmFpbGFibGVfc2F0dXJkYXkgPSB1cGRhdGVzLmF2YWlsYWJsZVNhdHVyZGF5O1xyXG4gICAgfVxyXG4gICAgaWYgKHVwZGF0ZXMuYXZhaWxhYmxlU3VuZGF5ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgdXBkYXRlRGF0YS5hdmFpbGFibGVfc3VuZGF5ID0gdXBkYXRlcy5hdmFpbGFibGVTdW5kYXk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgeyBkYXRhOiB1cGRhdGVkQ2xlYW5lciwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdjbGVhbmVycycpXHJcbiAgICAgIC51cGRhdGUodXBkYXRlRGF0YSlcclxuICAgICAgLmVxKCdpZCcsIGNsZWFuZXJJZClcclxuICAgICAgLnNlbGVjdCgpXHJcbiAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2xlYW5lciBhdmFpbGFiaWxpdHk6JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBjbGVhbmVyOiB1cGRhdGVkQ2xlYW5lciBhcyBDbGVhbmVyIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIHVwZGF0ZUNsZWFuZXJBdmFpbGFiaWxpdHk6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdGYWlsZWQgdG8gdXBkYXRlIGF2YWlsYWJpbGl0eScsXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6ImdTQTZjc0Isa01BQUEifQ==
}),
"[project]/app/cleaner/data:a563e4 [app-client] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "calculateBookingEarnings",
    ()=>$$RSC_SERVER_ACTION_4
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-client] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"404229d4a2391f70ae4e1636e65b58ce0172045828":"calculateBookingEarnings"},"app/cleaner/actions.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_4 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createServerReference"])("404229d4a2391f70ae4e1636e65b58ce0172045828", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["findSourceMapURL"], "calculateBookingEarnings");
;
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vYWN0aW9ucy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHNlcnZlcic7XHJcblxyXG5pbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAL2xpYi9zdXBhYmFzZS9zZXJ2ZXInO1xyXG5pbXBvcnQgeyBjcmVhdGVBZG1pbkNsaWVudCB9IGZyb20gJ0AvbGliL3N1cGFiYXNlL3NlcnZlci1hZG1pbic7XHJcbmltcG9ydCB7IEJvb2tpbmcgfSBmcm9tICdAL3R5cGVzL2Jvb2tpbmcnO1xyXG5pbXBvcnQgeyBDbGVhbmVyIH0gZnJvbSAnQC90eXBlcy9ib29raW5nJztcclxuaW1wb3J0IHtcclxuICBjYWxjdWxhdGVDbGVhbmVyVGVudXJlLFxyXG4gIGNhbGN1bGF0ZVRvdGFsSG91cnMsXHJcbiAgZ2V0RWFybmluZ3NQZXJjZW50YWdlLFxyXG4gIGNhbGN1bGF0ZVRvdGFsRWFybmluZ3NGcm9tQm9va2luZyxcclxuICBjYWxjdWxhdGVDbGVhbmVyRWFybmluZ3MsXHJcbiAgY2FsY3VsYXRlVGlwUGVyQ2xlYW5lcixcclxufSBmcm9tICdAL2xpYi91dGlscy9jbGVhbmVyLWVhcm5pbmdzJztcclxuXHJcbi8qKlxyXG4gKiBHZXQgY2xlYW5lciBieSBwaG9uZSBudW1iZXJcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDbGVhbmVyQnlQaG9uZShwaG9uZTogc3RyaW5nKTogUHJvbWlzZTx7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBjbGVhbmVyPzogQ2xlYW5lcjtcclxuICBlcnJvcj86IHN0cmluZztcclxufT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xyXG4gICAgXHJcbiAgICAvLyBOb3JtYWxpemUgcGhvbmUgbnVtYmVyIChyZW1vdmUgc3BhY2VzLCBkYXNoZXMsIGV0Yy4pXHJcbiAgICBjb25zdCBub3JtYWxpemVkUGhvbmUgPSBwaG9uZS5yZXBsYWNlKC9cXHMrL2csICcnKS50cmltKCk7XHJcbiAgICBcclxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdjbGVhbmVycycpXHJcbiAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAub3IoYHBob25lLmVxLiR7bm9ybWFsaXplZFBob25lfSxwaG9uZS5lcS4rJHtub3JtYWxpemVkUGhvbmV9YClcclxuICAgICAgLmVxKCdpc19hY3RpdmUnLCB0cnVlKVxyXG4gICAgICAubWF5YmVTaW5nbGUoKTtcclxuXHJcbiAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY2xlYW5lciBieSBwaG9uZTonLCBlcnJvcik7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG5cclxuICAgIGlmICghZGF0YSkge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdDbGVhbmVyIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBjbGVhbmVyOiBkYXRhIGFzIENsZWFuZXIgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gZ2V0Q2xlYW5lckJ5UGhvbmU6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdGYWlsZWQgdG8gZmV0Y2ggY2xlYW5lcicsXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEF1dGhlbnRpY2F0ZSBjbGVhbmVyIHdpdGggcGhvbmUgYW5kIHBhc3N3b3JkXHJcbiAqIFVzZXMgU3VwYWJhc2UgQXV0aCAtIGV4cGVjdHMgZW1haWwgZm9ybWF0OiB7cGhvbmV9QGNsZWFuZXJzLnNoYWxlYW4ubG9jYWxcclxuICogQWRtaW4gc2hvdWxkIGNyZWF0ZSBhdXRoIGFjY291bnRzIHdpdGggdGhpcyBlbWFpbCBmb3JtYXQgd2hlbiBjcmVhdGluZyBjbGVhbmVyIGFjY291bnRzXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXV0aGVudGljYXRlQ2xlYW5lcihcclxuICBwaG9uZTogc3RyaW5nLFxyXG4gIHBhc3N3b3JkOiBzdHJpbmdcclxuKTogUHJvbWlzZTx7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBjbGVhbmVyPzogQ2xlYW5lcjtcclxuICBlcnJvcj86IHN0cmluZztcclxufT4ge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBGaXJzdCwgZmluZCB0aGUgY2xlYW5lciBieSBwaG9uZSB0byB2ZXJpZnkgdGhleSBleGlzdFxyXG4gICAgY29uc3QgY2xlYW5lclJlc3VsdCA9IGF3YWl0IGdldENsZWFuZXJCeVBob25lKHBob25lKTtcclxuICAgIGlmICghY2xlYW5lclJlc3VsdC5zdWNjZXNzIHx8ICFjbGVhbmVyUmVzdWx0LmNsZWFuZXIpIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnSW52YWxpZCBwaG9uZSBudW1iZXIgb3IgcGFzc3dvcmQnIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgY2xlYW5lciA9IGNsZWFuZXJSZXN1bHQuY2xlYW5lcjtcclxuXHJcbiAgICAvLyBVc2UgcGhvbmUtYmFzZWQgZW1haWwgZm9ybWF0IGZvciBsb2dpblxyXG4gICAgLy8gRm9ybWF0OiB7cGhvbmV9QGNsZWFuZXJzLnNoYWxlYW4ubG9jYWxcclxuICAgIC8vIE5vcm1hbGl6ZSBwaG9uZSAocmVtb3ZlIHNwYWNlcywga2VlcCArIGlmIHByZXNlbnQpXHJcbiAgICBjb25zdCBub3JtYWxpemVkUGhvbmUgPSBwaG9uZS5yZXBsYWNlKC9cXHMrL2csICcnKS50cmltKCk7XHJcbiAgICBjb25zdCBhdXRoRW1haWwgPSBgJHtub3JtYWxpemVkUGhvbmV9QGNsZWFuZXJzLnNoYWxlYW4ubG9jYWxgO1xyXG5cclxuICAgIC8vIEF1dGhlbnRpY2F0ZSB3aXRoIFN1cGFiYXNlIEF1dGggdXNpbmcgY2xpZW50LXNpZGUgKHRoaXMgc2hvdWxkIGJlIGNhbGxlZCBmcm9tIGNsaWVudClcclxuICAgIC8vIE5vdGU6IFRoaXMgZnVuY3Rpb24gc2hvdWxkIGlkZWFsbHkgYmUgY2FsbGVkIGZyb20gYSBjbGllbnQgY29tcG9uZW50XHJcbiAgICAvLyBGb3Igc2VydmVyLXNpZGUsIHdlJ2xsIHJldHVybiB0aGUgY2xlYW5lciBpbmZvIGFuZCBsZXQgY2xpZW50IGhhbmRsZSBhdXRoXHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xyXG4gICAgXHJcbiAgICAvLyBUcnkgdG8gYXV0aGVudGljYXRlXHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLnNpZ25JbldpdGhQYXNzd29yZCh7XHJcbiAgICAgIGVtYWlsOiBhdXRoRW1haWwsXHJcbiAgICAgIHBhc3N3b3JkLFxyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0F1dGhlbnRpY2F0aW9uIGVycm9yOicsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnSW52YWxpZCBwaG9uZSBudW1iZXIgb3IgcGFzc3dvcmQnIH07XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCFkYXRhLnVzZXIpIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnQXV0aGVudGljYXRpb24gZmFpbGVkJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFVwZGF0ZSBjbGVhbmVyJ3MgYXV0aF91c2VyX2lkIGlmIG5vdCBzZXRcclxuICAgIGlmICghY2xlYW5lci5hdXRoX3VzZXJfaWQpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBhZG1pblN1cGFiYXNlID0gY3JlYXRlQWRtaW5DbGllbnQoKTtcclxuICAgICAgICBhd2FpdCBhZG1pblN1cGFiYXNlXHJcbiAgICAgICAgICAuZnJvbSgnY2xlYW5lcnMnKVxyXG4gICAgICAgICAgLnVwZGF0ZSh7IGF1dGhfdXNlcl9pZDogZGF0YS51c2VyLmlkIH0pXHJcbiAgICAgICAgICAuZXEoJ2lkJywgY2xlYW5lci5pZCk7XHJcbiAgICAgIH0gY2F0Y2ggKHVwZGF0ZUVycm9yKSB7XHJcbiAgICAgICAgLy8gTG9nIGJ1dCBkb24ndCBmYWlsIC0gYXV0aF91c2VyX2lkIHVwZGF0ZSBpcyBvcHRpb25hbFxyXG4gICAgICAgIGNvbnNvbGUud2FybignQ291bGQgbm90IHVwZGF0ZSBhdXRoX3VzZXJfaWQ6JywgdXBkYXRlRXJyb3IpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgY2xlYW5lciB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBhdXRoZW50aWNhdGVDbGVhbmVyOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnQXV0aGVudGljYXRpb24gZmFpbGVkJyxcclxuICAgIH07XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogR2V0IGN1cnJlbnQgYXV0aGVudGljYXRlZCBjbGVhbmVyXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q3VycmVudENsZWFuZXIoKTogUHJvbWlzZTx7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBjbGVhbmVyPzogQ2xlYW5lcjtcclxuICBlcnJvcj86IHN0cmluZztcclxufT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xyXG4gICAgY29uc3QgeyBkYXRhOiB7IHVzZXIgfSwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5nZXRVc2VyKCk7XHJcblxyXG4gICAgaWYgKGF1dGhFcnJvciB8fCAhdXNlcikge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdOb3QgYXV0aGVudGljYXRlZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBUcnkgdG8gZmluZCBjbGVhbmVyIGJ5IGF1dGhfdXNlcl9pZCBmaXJzdFxyXG4gICAgbGV0IGNsZWFuZXJRdWVyeSA9IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdjbGVhbmVycycpXHJcbiAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAuZXEoJ2F1dGhfdXNlcl9pZCcsIHVzZXIuaWQpXHJcbiAgICAgIC5lcSgnaXNfYWN0aXZlJywgdHJ1ZSlcclxuICAgICAgLm1heWJlU2luZ2xlKCk7XHJcblxyXG4gICAgbGV0IHsgZGF0YTogY2xlYW5lciwgZXJyb3I6IGNsZWFuZXJFcnJvciB9ID0gYXdhaXQgY2xlYW5lclF1ZXJ5O1xyXG5cclxuICAgIC8vIElmIG5vdCBmb3VuZCBieSBhdXRoX3VzZXJfaWQsIHRyeSB0byBtYXRjaCBieSBwaG9uZSBmcm9tIGVtYWlsXHJcbiAgICBpZiAoIWNsZWFuZXIgJiYgIWNsZWFuZXJFcnJvciAmJiB1c2VyLmVtYWlsKSB7XHJcbiAgICAgIC8vIEV4dHJhY3QgcGhvbmUgZnJvbSBlbWFpbCBmb3JtYXQ6IHtwaG9uZX1AY2xlYW5lcnMuc2hhbGVhbi5sb2NhbFxyXG4gICAgICBjb25zdCBwaG9uZU1hdGNoID0gdXNlci5lbWFpbC5tYXRjaCgvXiguKylAY2xlYW5lcnNcXC5zaGFsZWFuXFwubG9jYWwkLyk7XHJcbiAgICAgIGlmIChwaG9uZU1hdGNoKSB7XHJcbiAgICAgICAgY29uc3QgcGhvbmUgPSBwaG9uZU1hdGNoWzFdO1xyXG4gICAgICAgIGNvbnN0IHBob25lUmVzdWx0ID0gYXdhaXQgZ2V0Q2xlYW5lckJ5UGhvbmUocGhvbmUpO1xyXG4gICAgICAgIGlmIChwaG9uZVJlc3VsdC5zdWNjZXNzICYmIHBob25lUmVzdWx0LmNsZWFuZXIpIHtcclxuICAgICAgICAgIGNsZWFuZXIgPSBwaG9uZVJlc3VsdC5jbGVhbmVyO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChjbGVhbmVyRXJyb3IgfHwgIWNsZWFuZXIpIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnQ2xlYW5lciBwcm9maWxlIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBjbGVhbmVyOiBjbGVhbmVyIGFzIENsZWFuZXIgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gZ2V0Q3VycmVudENsZWFuZXI6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdGYWlsZWQgdG8gZ2V0IGNsZWFuZXInLFxyXG4gICAgfTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZXQgYm9va2luZ3MgYXNzaWduZWQgdG8gdGhlIGF1dGhlbnRpY2F0ZWQgY2xlYW5lclxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENsZWFuZXJCb29raW5ncyhcclxuICBmaWx0ZXI/OiAnYWxsJyB8ICd0b2RheScgfCAndXBjb21pbmcnIHwgJ3Bhc3QnIHwgJ29uX215X3dheScgfCAnc3RhcnRlZCdcclxuKTogUHJvbWlzZTx7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBib29raW5ncz86IEJvb2tpbmdbXTtcclxuICBlcnJvcj86IHN0cmluZztcclxufT4ge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBHZXQgYXV0aGVudGljYXRlZCBjbGVhbmVyIGZpcnN0XHJcbiAgICBjb25zdCBjbGVhbmVyUmVzdWx0ID0gYXdhaXQgZ2V0Q3VycmVudENsZWFuZXIoKTtcclxuICAgIGlmICghY2xlYW5lclJlc3VsdC5zdWNjZXNzIHx8ICFjbGVhbmVyUmVzdWx0LmNsZWFuZXIpIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnTm90IGF1dGhlbnRpY2F0ZWQgb3IgY2xlYW5lciBwcm9maWxlIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBjbGVhbmVySWQgPSBjbGVhbmVyUmVzdWx0LmNsZWFuZXIuaWQ7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xyXG4gICAgXHJcbiAgICAvLyBGZXRjaCBib29raW5ncyB3aGVyZSBjbGVhbmVyIGlzIGFzc2lnbmVkIHZpYSBwcmVmZXJyZWRfY2xlYW5lcl9pZCAoc2luZ2xlKVxyXG4gICAgbGV0IHNpbmdsZVF1ZXJ5ID0gc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2Jvb2tpbmdzJylcclxuICAgICAgLnNlbGVjdCgnKicpXHJcbiAgICAgIC5lcSgncHJlZmVycmVkX2NsZWFuZXJfaWQnLCBjbGVhbmVySWQpO1xyXG5cclxuICAgIC8vIEZldGNoIGJvb2tpbmdzIHdpdGggcHJlZmVycmVkX2NsZWFuZXJfaWRzIChhcnJheSkgLSBmZXRjaCBhbGwgd2l0aCBhcnJheXMsIHRoZW4gZmlsdGVyXHJcbiAgICBsZXQgYXJyYXlRdWVyeSA9IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdib29raW5ncycpXHJcbiAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAubm90KCdwcmVmZXJyZWRfY2xlYW5lcl9pZHMnLCAnaXMnLCBudWxsKTtcclxuXHJcbiAgICAvLyBBcHBseSBmaWx0ZXJzIHRvIGJvdGggcXVlcmllc1xyXG4gICAgaWYgKGZpbHRlciAmJiBmaWx0ZXIgIT09ICdhbGwnKSB7XHJcbiAgICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XHJcbiAgICAgIFxyXG4gICAgICBzd2l0Y2ggKGZpbHRlcikge1xyXG4gICAgICAgIGNhc2UgJ3RvZGF5JzpcclxuICAgICAgICAgIHNpbmdsZVF1ZXJ5ID0gc2luZ2xlUXVlcnkuZXEoJ3NlcnZpY2VfZGF0ZScsIHRvZGF5KTtcclxuICAgICAgICAgIGFycmF5UXVlcnkgPSBhcnJheVF1ZXJ5LmVxKCdzZXJ2aWNlX2RhdGUnLCB0b2RheSk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICd1cGNvbWluZyc6XHJcbiAgICAgICAgICBzaW5nbGVRdWVyeSA9IHNpbmdsZVF1ZXJ5Lmd0ZSgnc2VydmljZV9kYXRlJywgdG9kYXkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAuaW4oJ3N0YXR1cycsIFsncGVuZGluZycsICdjb25maXJtZWQnLCAnb25fbXlfd2F5JywgJ3N0YXJ0ZWQnXSk7XHJcbiAgICAgICAgICBhcnJheVF1ZXJ5ID0gYXJyYXlRdWVyeS5ndGUoJ3NlcnZpY2VfZGF0ZScsIHRvZGF5KVxyXG4gICAgICAgICAgICAgICAgICAgICAgLmluKCdzdGF0dXMnLCBbJ3BlbmRpbmcnLCAnY29uZmlybWVkJywgJ29uX215X3dheScsICdzdGFydGVkJ10pO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAncGFzdCc6XHJcbiAgICAgICAgICBzaW5nbGVRdWVyeSA9IHNpbmdsZVF1ZXJ5Lmx0KCdzZXJ2aWNlX2RhdGUnLCB0b2RheSlcclxuICAgICAgICAgICAgICAgICAgICAgIC5vcignc3RhdHVzLmVxLmNvbXBsZXRlZCxzdGF0dXMuZXEuY2FuY2VsbGVkJyk7XHJcbiAgICAgICAgICBhcnJheVF1ZXJ5ID0gYXJyYXlRdWVyeS5sdCgnc2VydmljZV9kYXRlJywgdG9kYXkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAub3IoJ3N0YXR1cy5lcS5jb21wbGV0ZWQsc3RhdHVzLmVxLmNhbmNlbGxlZCcpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnb25fbXlfd2F5JzpcclxuICAgICAgICAgIHNpbmdsZVF1ZXJ5ID0gc2luZ2xlUXVlcnkuZXEoJ3N0YXR1cycsICdvbl9teV93YXknKTtcclxuICAgICAgICAgIGFycmF5UXVlcnkgPSBhcnJheVF1ZXJ5LmVxKCdzdGF0dXMnLCAnb25fbXlfd2F5Jyk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdzdGFydGVkJzpcclxuICAgICAgICAgIHNpbmdsZVF1ZXJ5ID0gc2luZ2xlUXVlcnkuZXEoJ3N0YXR1cycsICdzdGFydGVkJyk7XHJcbiAgICAgICAgICBhcnJheVF1ZXJ5ID0gYXJyYXlRdWVyeS5lcSgnc3RhdHVzJywgJ3N0YXJ0ZWQnKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRXhlY3V0ZSBib3RoIHF1ZXJpZXNcclxuICAgIGNvbnN0IFtzaW5nbGVSZXN1bHQsIGFycmF5UmVzdWx0XSA9IGF3YWl0IFByb21pc2UuYWxsKFtcclxuICAgICAgc2luZ2xlUXVlcnkub3JkZXIoJ3NlcnZpY2VfZGF0ZScsIHsgYXNjZW5kaW5nOiB0cnVlIH0pLm9yZGVyKCdzZXJ2aWNlX3RpbWUnLCB7IGFzY2VuZGluZzogdHJ1ZSB9KSxcclxuICAgICAgYXJyYXlRdWVyeS5vcmRlcignc2VydmljZV9kYXRlJywgeyBhc2NlbmRpbmc6IHRydWUgfSkub3JkZXIoJ3NlcnZpY2VfdGltZScsIHsgYXNjZW5kaW5nOiB0cnVlIH0pXHJcbiAgICBdKTtcclxuXHJcbiAgICBpZiAoc2luZ2xlUmVzdWx0LmVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGNsZWFuZXIgYm9va2luZ3MgKHNpbmdsZSk6Jywgc2luZ2xlUmVzdWx0LmVycm9yKTtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBzaW5nbGVSZXN1bHQuZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChhcnJheVJlc3VsdC5lcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBjbGVhbmVyIGJvb2tpbmdzIChhcnJheSk6JywgYXJyYXlSZXN1bHQuZXJyb3IpO1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGFycmF5UmVzdWx0LmVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBEZWJ1ZyBsb2dnaW5nXHJcbiAgICBjb25zb2xlLmxvZygnW2dldENsZWFuZXJCb29raW5nc10gRmV0Y2hlZCBib29raW5nczonLCB7XHJcbiAgICAgIGNsZWFuZXJJZCxcclxuICAgICAgZmlsdGVyLFxyXG4gICAgICBzaW5nbGVCb29raW5nc0NvdW50OiBzaW5nbGVSZXN1bHQuZGF0YT8ubGVuZ3RoIHx8IDAsXHJcbiAgICAgIGFycmF5Qm9va2luZ3NDb3VudDogYXJyYXlSZXN1bHQuZGF0YT8ubGVuZ3RoIHx8IDAsXHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBGaWx0ZXIgYm9va2luZ3Mgd2hlcmUgcHJlZmVycmVkX2NsZWFuZXJfaWRzIGFycmF5IGNvbnRhaW5zIHRoaXMgY2xlYW5lcklkXHJcbiAgICAvLyBOb3JtYWxpemUgVVVJRHMgZm9yIGNvbXBhcmlzb24gKGhhbmRsZSBjYXNlIGRpZmZlcmVuY2VzIGFuZCBzdHJpbmcgZm9ybWF0cylcclxuICAgIGNvbnN0IG5vcm1hbGl6ZVV1aWQgPSAoaWQ6IGFueSk6IHN0cmluZyA9PiB7XHJcbiAgICAgIGlmICghaWQpIHJldHVybiAnJztcclxuICAgICAgcmV0dXJuIFN0cmluZyhpZCkudG9Mb3dlckNhc2UoKS50cmltKCk7XHJcbiAgICB9O1xyXG4gICAgY29uc3Qgbm9ybWFsaXplZENsZWFuZXJJZCA9IG5vcm1hbGl6ZVV1aWQoY2xlYW5lcklkKTtcclxuICAgIFxyXG4gICAgY29uc3QgZmlsdGVyZWRBcnJheUJvb2tpbmdzID0gKGFycmF5UmVzdWx0LmRhdGEgfHwgW10pLmZpbHRlcigoYm9va2luZzogYW55KSA9PiB7XHJcbiAgICAgIGlmICghYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMgfHwgIUFycmF5LmlzQXJyYXkoYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMpKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICAgIC8vIENoZWNrIGlmIGFycmF5IGlzIGVtcHR5XHJcbiAgICAgIGlmIChib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgLy8gQ2hlY2sgaWYgYW55IElEIGluIHRoZSBhcnJheSBtYXRjaGVzIHRoZSBjbGVhbmVySWQgKGNhc2UtaW5zZW5zaXRpdmUpXHJcbiAgICAgIHJldHVybiBib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcy5zb21lKChpZDogc3RyaW5nKSA9PiBub3JtYWxpemVVdWlkKGlkKSA9PT0gbm9ybWFsaXplZENsZWFuZXJJZCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBDb21iaW5lIHJlc3VsdHMgYW5kIHJlbW92ZSBkdXBsaWNhdGVzXHJcbiAgICBjb25zdCBhbGxCb29raW5ncyA9IFtcclxuICAgICAgLi4uKHNpbmdsZVJlc3VsdC5kYXRhIHx8IFtdKSxcclxuICAgICAgLi4uZmlsdGVyZWRBcnJheUJvb2tpbmdzXHJcbiAgICBdO1xyXG5cclxuICAgIC8vIFJlbW92ZSBkdXBsaWNhdGVzIGJ5IGJvb2tpbmcgSURcclxuICAgIGNvbnN0IHVuaXF1ZUJvb2tpbmdzTWFwID0gbmV3IE1hcDxzdHJpbmcsIEJvb2tpbmc+KCk7XHJcbiAgICBhbGxCb29raW5ncy5mb3JFYWNoKChib29raW5nOiBhbnkpID0+IHtcclxuICAgICAgaWYgKGJvb2tpbmcuaWQgJiYgIXVuaXF1ZUJvb2tpbmdzTWFwLmhhcyhib29raW5nLmlkKSkge1xyXG4gICAgICAgIHVuaXF1ZUJvb2tpbmdzTWFwLnNldChib29raW5nLmlkLCBib29raW5nIGFzIEJvb2tpbmcpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBib29raW5ncyA9IEFycmF5LmZyb20odW5pcXVlQm9va2luZ3NNYXAudmFsdWVzKCkpO1xyXG5cclxuICAgIC8vIFNvcnQgYnkgc2VydmljZV9kYXRlIGFuZCBzZXJ2aWNlX3RpbWVcclxuICAgIGJvb2tpbmdzLnNvcnQoKGEsIGIpID0+IHtcclxuICAgICAgY29uc3QgZGF0ZUNvbXBhcmUgPSBhLnNlcnZpY2VfZGF0ZS5sb2NhbGVDb21wYXJlKGIuc2VydmljZV9kYXRlKTtcclxuICAgICAgaWYgKGRhdGVDb21wYXJlICE9PSAwKSByZXR1cm4gZGF0ZUNvbXBhcmU7XHJcbiAgICAgIHJldHVybiBhLnNlcnZpY2VfdGltZS5sb2NhbGVDb21wYXJlKGIuc2VydmljZV90aW1lKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGJvb2tpbmdzIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIGdldENsZWFuZXJCb29raW5nczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0ZhaWxlZCB0byBmZXRjaCBib29raW5ncycsXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIENhbGN1bGF0ZSBjbGVhbmVyIGVhcm5pbmdzIGZvciBhIHNwZWNpZmljIGJvb2tpbmdcclxuICogVGhpcyBoZWxwZXIgZnVuY3Rpb24gaXMgdXNlZCB0byBkaXNwbGF5IGVhcm5pbmdzIG9uIGJvb2tpbmcgZGV0YWlscyBwYWdlXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2FsY3VsYXRlQm9va2luZ0Vhcm5pbmdzKGJvb2tpbmdJZDogc3RyaW5nKTogUHJvbWlzZTx7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBlYXJuaW5ncz86IHtcclxuICAgIGJhc2VFYXJuaW5nczogbnVtYmVyO1xyXG4gICAgdGlwQW1vdW50OiBudW1iZXI7XHJcbiAgICB0b3RhbEVhcm5pbmdzOiBudW1iZXI7XHJcbiAgICBlYXJuaW5nc1BlcmNlbnRhZ2U6IG51bWJlcjtcclxuICB9O1xyXG4gIGVycm9yPzogc3RyaW5nO1xyXG59PiB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIEdldCBhdXRoZW50aWNhdGVkIGNsZWFuZXIgZmlyc3RcclxuICAgIGNvbnN0IGNsZWFuZXJSZXN1bHQgPSBhd2FpdCBnZXRDdXJyZW50Q2xlYW5lcigpO1xyXG4gICAgaWYgKCFjbGVhbmVyUmVzdWx0LnN1Y2Nlc3MgfHwgIWNsZWFuZXJSZXN1bHQuY2xlYW5lcikge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdOb3QgYXV0aGVudGljYXRlZCBvciBjbGVhbmVyIHByb2ZpbGUgbm90IGZvdW5kJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGNsZWFuZXJJZCA9IGNsZWFuZXJSZXN1bHQuY2xlYW5lci5pZDtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQ2xpZW50KCk7XHJcblxyXG4gICAgLy8gR2V0IGNsZWFuZXIgaW5mbyBmb3IgdGVudXJlIGNhbGN1bGF0aW9uXHJcbiAgICBjb25zdCB7IGRhdGE6IGNsZWFuZXIsIGVycm9yOiBjbGVhbmVyRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdjbGVhbmVycycpXHJcbiAgICAgIC5zZWxlY3QoJ2NyZWF0ZWRfYXQnKVxyXG4gICAgICAuZXEoJ2lkJywgY2xlYW5lcklkKVxyXG4gICAgICAubWF5YmVTaW5nbGUoKTtcclxuXHJcbiAgICBpZiAoY2xlYW5lckVycm9yIHx8ICFjbGVhbmVyKSB7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0NsZWFuZXIgbm90IGZvdW5kJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEdldCB0aGUgYm9va2luZ1xyXG4gICAgY29uc3QgeyBkYXRhOiBib29raW5nLCBlcnJvcjogYm9va2luZ0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnYm9va2luZ3MnKVxyXG4gICAgICAuc2VsZWN0KCcqJylcclxuICAgICAgLmVxKCdpZCcsIGJvb2tpbmdJZClcclxuICAgICAgLm1heWJlU2luZ2xlKCk7XHJcblxyXG4gICAgaWYgKGJvb2tpbmdFcnJvciB8fCAhYm9va2luZykge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdCb29raW5nIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDYWxjdWxhdGUgdGVudXJlIGFuZCB0b3RhbCBob3VycyB0byBkZXRlcm1pbmUgcGVyY2VudGFnZVxyXG4gICAgLy8gRm9yIHNpbmdsZSBib29raW5nIGRpc3BsYXksIHdlIG5lZWQgYWxsIHBhaWQgY29tcGxldGVkIGJvb2tpbmdzIHRvIGNhbGN1bGF0ZSBob3Vyc1xyXG4gICAgLy8gVXNlIHRoZSBzYW1lIGFwcHJvYWNoIGFzIGdldENsZWFuZXJTdGF0c1xyXG4gICAgY29uc3QgeyBkYXRhOiBzaW5nbGVCb29raW5ncyB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2Jvb2tpbmdzJylcclxuICAgICAgLnNlbGVjdCgnc3RhdHVzLCBwYXltZW50X3N0YXR1cywgc2VydmljZV9kdXJhdGlvbiwgcHJlZmVycmVkX2NsZWFuZXJfaWQsIHByZWZlcnJlZF9jbGVhbmVyX2lkcycpXHJcbiAgICAgIC5lcSgncHJlZmVycmVkX2NsZWFuZXJfaWQnLCBjbGVhbmVySWQpO1xyXG5cclxuICAgIGNvbnN0IHsgZGF0YTogYWxsTXVsdGlCb29raW5ncyB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2Jvb2tpbmdzJylcclxuICAgICAgLnNlbGVjdCgnc3RhdHVzLCBwYXltZW50X3N0YXR1cywgc2VydmljZV9kdXJhdGlvbiwgcHJlZmVycmVkX2NsZWFuZXJfaWQsIHByZWZlcnJlZF9jbGVhbmVyX2lkcycpXHJcbiAgICAgIC5ub3QoJ3ByZWZlcnJlZF9jbGVhbmVyX2lkcycsICdpcycsIG51bGwpO1xyXG5cclxuICAgIC8vIEZpbHRlciBib29raW5ncyBhc3NpZ25lZCB0byB0aGlzIGNsZWFuZXJcclxuICAgIGNvbnN0IG5vcm1hbGl6ZVV1aWQgPSAoaWQ6IGFueSk6IHN0cmluZyA9PiB7XHJcbiAgICAgIGlmICghaWQpIHJldHVybiAnJztcclxuICAgICAgcmV0dXJuIFN0cmluZyhpZCkudG9Mb3dlckNhc2UoKS50cmltKCk7XHJcbiAgICB9O1xyXG4gICAgY29uc3Qgbm9ybWFsaXplZENsZWFuZXJJZCA9IG5vcm1hbGl6ZVV1aWQoY2xlYW5lcklkKTtcclxuXHJcbiAgICBjb25zdCBhcnJheUJvb2tpbmdzID0gKGFsbE11bHRpQm9va2luZ3MgfHwgW10pLmZpbHRlcigoYjogYW55KSA9PiB7XHJcbiAgICAgIGlmICghYi5wcmVmZXJyZWRfY2xlYW5lcl9pZHMgfHwgIUFycmF5LmlzQXJyYXkoYi5wcmVmZXJyZWRfY2xlYW5lcl9pZHMpKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChiLnByZWZlcnJlZF9jbGVhbmVyX2lkcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGIucHJlZmVycmVkX2NsZWFuZXJfaWRzLnNvbWUoKGlkOiBzdHJpbmcpID0+IG5vcm1hbGl6ZVV1aWQoaWQpID09PSBub3JtYWxpemVkQ2xlYW5lcklkKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIENvbWJpbmUgYW5kIHJlbW92ZSBkdXBsaWNhdGVzXHJcbiAgICBjb25zdCBhbGxCb29raW5nc01hcCA9IG5ldyBNYXA8c3RyaW5nLCBhbnk+KCk7XHJcbiAgICAoc2luZ2xlQm9va2luZ3MgfHwgW10pLmZvckVhY2goKGI6IGFueSkgPT4ge1xyXG4gICAgICBpZiAoYi5pZCkge1xyXG4gICAgICAgIGFsbEJvb2tpbmdzTWFwLnNldChiLmlkLCBiKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBhcnJheUJvb2tpbmdzLmZvckVhY2goKGI6IGFueSkgPT4ge1xyXG4gICAgICBpZiAoYi5pZCAmJiAhYWxsQm9va2luZ3NNYXAuaGFzKGIuaWQpKSB7XHJcbiAgICAgICAgYWxsQm9va2luZ3NNYXAuc2V0KGIuaWQsIGIpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBjbGVhbmVyQm9va2luZ3MgPSBBcnJheS5mcm9tKGFsbEJvb2tpbmdzTWFwLnZhbHVlcygpKTtcclxuXHJcbiAgICBjb25zdCB0ZW51cmVNb250aHMgPSBjYWxjdWxhdGVDbGVhbmVyVGVudXJlKGNsZWFuZXIuY3JlYXRlZF9hdCk7XHJcbiAgICBjb25zdCB0b3RhbEhvdXJzID0gY2FsY3VsYXRlVG90YWxIb3VycyhjbGVhbmVyQm9va2luZ3MpO1xyXG4gICAgY29uc3QgZWFybmluZ3NQZXJjZW50YWdlID0gZ2V0RWFybmluZ3NQZXJjZW50YWdlKHRlbnVyZU1vbnRocywgdG90YWxIb3Vycyk7XHJcblxyXG4gICAgLy8gQ2FsY3VsYXRlIGJhc2UgZWFybmluZ3NcclxuICAgIC8vIEVxdWlwbWVudCBmZWUgYW5kIGFkZGl0aW9uYWwgY2xlYW5lcnMgY2hhcmdlcyBhcmUgZXhjbHVkZWQgZnJvbSBjbGVhbmVyIGVhcm5pbmdzXHJcbiAgICBjb25zdCBiYXNlRWFybmluZ3MgPSBjYWxjdWxhdGVDbGVhbmVyRWFybmluZ3MoXHJcbiAgICAgIHtcclxuICAgICAgICBzZXJ2aWNlX3R5cGU6IGJvb2tpbmcuc2VydmljZV90eXBlIHx8ICcnLFxyXG4gICAgICAgIHRvdGFsX2Ftb3VudDogTnVtYmVyKGJvb2tpbmcudG90YWxfYW1vdW50KSB8fCAwLFxyXG4gICAgICAgIHNlcnZpY2VfZmVlOiBOdW1iZXIoYm9va2luZy5zZXJ2aWNlX2ZlZSkgfHwgMCxcclxuICAgICAgICBlcXVpcG1lbnRfc3VwcGx5X3ByaWNlOiBOdW1iZXIoYm9va2luZy5lcXVpcG1lbnRfc3VwcGx5X3ByaWNlKSB8fCAwLFxyXG4gICAgICAgIGFkZGl0aW9uYWxfY2xlYW5lcnNfcHJpY2U6IE51bWJlcihib29raW5nLmFkZGl0aW9uYWxfY2xlYW5lcnNfcHJpY2UpIHx8IDAsXHJcbiAgICAgICAgcHJlZmVycmVkX2NsZWFuZXJfaWRzOiBib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcyxcclxuICAgICAgICBwcmVmZXJyZWRfY2xlYW5lcl9pZDogYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZCxcclxuICAgICAgfSxcclxuICAgICAgY2xlYW5lcklkLFxyXG4gICAgICBlYXJuaW5nc1BlcmNlbnRhZ2UsXHJcbiAgICAgIGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWRzXHJcbiAgICApO1xyXG5cclxuICAgIC8vIENhbGN1bGF0ZSB0aXAgcGVyIGNsZWFuZXJcclxuICAgIGNvbnN0IHRpcEFtb3VudCA9IGNhbGN1bGF0ZVRpcFBlckNsZWFuZXIoXHJcbiAgICAgIE51bWJlcihib29raW5nLnRpcF9hbW91bnQpIHx8IDAsXHJcbiAgICAgIGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWRzLFxyXG4gICAgICBib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkXHJcbiAgICApO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIGVhcm5pbmdzOiB7XHJcbiAgICAgICAgYmFzZUVhcm5pbmdzLFxyXG4gICAgICAgIHRpcEFtb3VudCxcclxuICAgICAgICB0b3RhbEVhcm5pbmdzOiBiYXNlRWFybmluZ3MgKyB0aXBBbW91bnQsXHJcbiAgICAgICAgZWFybmluZ3NQZXJjZW50YWdlLFxyXG4gICAgICB9LFxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY2FsY3VsYXRpbmcgYm9va2luZyBlYXJuaW5nczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0ZhaWxlZCB0byBjYWxjdWxhdGUgZWFybmluZ3MnLFxyXG4gICAgfTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZXQgYSBzcGVjaWZpYyBib29raW5nIGJ5IElEIChvbmx5IGlmIGFzc2lnbmVkIHRvIGF1dGhlbnRpY2F0ZWQgY2xlYW5lcilcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDbGVhbmVyQm9va2luZ0J5SWQoXHJcbiAgYm9va2luZ0lkOiBzdHJpbmdcclxuKTogUHJvbWlzZTx7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBib29raW5nPzogQm9va2luZztcclxuICBlcnJvcj86IHN0cmluZztcclxufT4ge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBHZXQgYXV0aGVudGljYXRlZCBjbGVhbmVyIGZpcnN0XHJcbiAgICBjb25zdCBjbGVhbmVyUmVzdWx0ID0gYXdhaXQgZ2V0Q3VycmVudENsZWFuZXIoKTtcclxuICAgIGlmICghY2xlYW5lclJlc3VsdC5zdWNjZXNzIHx8ICFjbGVhbmVyUmVzdWx0LmNsZWFuZXIpIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnTm90IGF1dGhlbnRpY2F0ZWQgb3IgY2xlYW5lciBwcm9maWxlIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBjbGVhbmVySWQgPSBjbGVhbmVyUmVzdWx0LmNsZWFuZXIuaWQ7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xyXG5cclxuICAgIC8vIEZldGNoIHRoZSBib29raW5nXHJcbiAgICBjb25zdCB7IGRhdGE6IGJvb2tpbmcsIGVycm9yOiBmZXRjaEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnYm9va2luZ3MnKVxyXG4gICAgICAuc2VsZWN0KCcqJylcclxuICAgICAgLmVxKCdpZCcsIGJvb2tpbmdJZClcclxuICAgICAgLm1heWJlU2luZ2xlKCk7XHJcblxyXG4gICAgaWYgKGZldGNoRXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgYm9va2luZzonLCBmZXRjaEVycm9yKTtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnQm9va2luZyBub3QgZm91bmQnIH07XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCFib29raW5nKSB7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0Jvb2tpbmcgbm90IGZvdW5kJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFZlcmlmeSB0aGUgY2xlYW5lciBpcyBhc3NpZ25lZCB0byB0aGlzIGJvb2tpbmdcclxuICAgIGNvbnN0IG5vcm1hbGl6ZVV1aWQgPSAoaWQ6IGFueSk6IHN0cmluZyA9PiB7XHJcbiAgICAgIGlmICghaWQpIHJldHVybiAnJztcclxuICAgICAgcmV0dXJuIFN0cmluZyhpZCkudG9Mb3dlckNhc2UoKS50cmltKCk7XHJcbiAgICB9O1xyXG4gICAgY29uc3Qgbm9ybWFsaXplZENsZWFuZXJJZCA9IG5vcm1hbGl6ZVV1aWQoY2xlYW5lcklkKTtcclxuXHJcbiAgICAvLyBDaGVjayBzaW5nbGUgY2xlYW5lciBhc3NpZ25tZW50XHJcbiAgICBjb25zdCBpc0Fzc2lnbmVkU2luZ2xlID0gYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZCAmJiBcclxuICAgICAgbm9ybWFsaXplVXVpZChib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkKSA9PT0gbm9ybWFsaXplZENsZWFuZXJJZDtcclxuXHJcbiAgICAvLyBDaGVjayBtdWx0aXBsZSBjbGVhbmVyIGFzc2lnbm1lbnRcclxuICAgIGxldCBpc0Fzc2lnbmVkTXVsdGlwbGUgPSBmYWxzZTtcclxuICAgIGlmIChib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcyAmJiBBcnJheS5pc0FycmF5KGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWRzKSkge1xyXG4gICAgICBpc0Fzc2lnbmVkTXVsdGlwbGUgPSBib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcy5zb21lKFxyXG4gICAgICAgIChpZDogc3RyaW5nKSA9PiBub3JtYWxpemVVdWlkKGlkKSA9PT0gbm9ybWFsaXplZENsZWFuZXJJZFxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICghaXNBc3NpZ25lZFNpbmdsZSAmJiAhaXNBc3NpZ25lZE11bHRpcGxlKSB7XHJcbiAgICAgIHJldHVybiB7IFxyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcclxuICAgICAgICBlcnJvcjogJ1VuYXV0aG9yaXplZDogWW91IGFyZSBub3QgYXNzaWduZWQgdG8gdGhpcyBib29raW5nJyBcclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBib29raW5nOiBib29raW5nIGFzIEJvb2tpbmcgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gZ2V0Q2xlYW5lckJvb2tpbmdCeUlkOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnRmFpbGVkIHRvIGZldGNoIGJvb2tpbmcnLFxyXG4gICAgfTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBVcGRhdGUgYm9va2luZyBzdGF0dXMgKHdpdGggYXV0aG9yaXphdGlvbiBjaGVjayBmb3IgYXV0aGVudGljYXRlZCBjbGVhbmVyKVxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUJvb2tpbmdTdGF0dXMoXHJcbiAgYm9va2luZ0lkOiBzdHJpbmcsXHJcbiAgc3RhdHVzOiBCb29raW5nWydzdGF0dXMnXVxyXG4pOiBQcm9taXNlPHtcclxuICBzdWNjZXNzOiBib29sZWFuO1xyXG4gIGJvb2tpbmc/OiBCb29raW5nO1xyXG4gIGVycm9yPzogc3RyaW5nO1xyXG59PiB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIEdldCBhdXRoZW50aWNhdGVkIGNsZWFuZXIgZmlyc3RcclxuICAgIGNvbnN0IGNsZWFuZXJSZXN1bHQgPSBhd2FpdCBnZXRDdXJyZW50Q2xlYW5lcigpO1xyXG4gICAgaWYgKCFjbGVhbmVyUmVzdWx0LnN1Y2Nlc3MgfHwgIWNsZWFuZXJSZXN1bHQuY2xlYW5lcikge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdOb3QgYXV0aGVudGljYXRlZCBvciBjbGVhbmVyIHByb2ZpbGUgbm90IGZvdW5kJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGNsZWFuZXJJZCA9IGNsZWFuZXJSZXN1bHQuY2xlYW5lci5pZDtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQ2xpZW50KCk7XHJcblxyXG4gICAgLy8gRmlyc3QsIHZlcmlmeSB0aGUgY2xlYW5lciBpcyBhc3NpZ25lZCB0byB0aGlzIGJvb2tpbmdcclxuICAgIGNvbnN0IHsgZGF0YTogYm9va2luZywgZXJyb3I6IGZldGNoRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdib29raW5ncycpXHJcbiAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAuZXEoJ2lkJywgYm9va2luZ0lkKVxyXG4gICAgICAubWF5YmVTaW5nbGUoKTtcclxuXHJcbiAgICBpZiAoZmV0Y2hFcnJvciB8fCAhYm9va2luZykge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdCb29raW5nIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDaGVjayBhdXRob3JpemF0aW9uOiBjbGVhbmVyIG11c3QgYmUgYXNzaWduZWQgdG8gdGhpcyBib29raW5nXHJcbiAgICBjb25zdCBub3JtYWxpemVVdWlkID0gKGlkOiBhbnkpOiBzdHJpbmcgPT4ge1xyXG4gICAgICBpZiAoIWlkKSByZXR1cm4gJyc7XHJcbiAgICAgIHJldHVybiBTdHJpbmcoaWQpLnRvTG93ZXJDYXNlKCkudHJpbSgpO1xyXG4gICAgfTtcclxuICAgIGNvbnN0IG5vcm1hbGl6ZWRDbGVhbmVySWQgPSBub3JtYWxpemVVdWlkKGNsZWFuZXJJZCk7XHJcblxyXG4gICAgY29uc3QgaXNBc3NpZ25lZFNpbmdsZSA9IGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWQgJiYgXHJcbiAgICAgIG5vcm1hbGl6ZVV1aWQoYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZCkgPT09IG5vcm1hbGl6ZWRDbGVhbmVySWQ7XHJcblxyXG4gICAgbGV0IGlzQXNzaWduZWRNdWx0aXBsZSA9IGZhbHNlO1xyXG4gICAgaWYgKGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWRzICYmIEFycmF5LmlzQXJyYXkoYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMpKSB7XHJcbiAgICAgIGlzQXNzaWduZWRNdWx0aXBsZSA9IGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWRzLnNvbWUoXHJcbiAgICAgICAgKGlkOiBzdHJpbmcpID0+IG5vcm1hbGl6ZVV1aWQoaWQpID09PSBub3JtYWxpemVkQ2xlYW5lcklkXHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgaXNBc3NpZ25lZCA9IGlzQXNzaWduZWRTaW5nbGUgfHwgaXNBc3NpZ25lZE11bHRpcGxlO1xyXG5cclxuICAgIGlmICghaXNBc3NpZ25lZCkge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdVbmF1dGhvcml6ZWQ6IFlvdSBhcmUgbm90IGFzc2lnbmVkIHRvIHRoaXMgYm9va2luZycgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBWYWxpZGF0ZSBzdGF0dXMgdHJhbnNpdGlvblxyXG4gICAgY29uc3QgdmFsaWRUcmFuc2l0aW9uczogUmVjb3JkPHN0cmluZywgc3RyaW5nW10+ID0ge1xyXG4gICAgICAncGVuZGluZyc6IFsnY29uZmlybWVkJywgJ2NhbmNlbGxlZCddLFxyXG4gICAgICAnY29uZmlybWVkJzogWydvbl9teV93YXknLCAnY2FuY2VsbGVkJ10sXHJcbiAgICAgICdvbl9teV93YXknOiBbJ3N0YXJ0ZWQnLCAnY2FuY2VsbGVkJ10sXHJcbiAgICAgICdzdGFydGVkJzogWydjb21wbGV0ZWQnLCAnY2FuY2VsbGVkJ10sXHJcbiAgICAgICdjb21wbGV0ZWQnOiBbXSxcclxuICAgICAgJ2NhbmNlbGxlZCc6IFtdLFxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCBjdXJyZW50U3RhdHVzID0gYm9va2luZy5zdGF0dXM7XHJcbiAgICBjb25zdCBhbGxvd2VkU3RhdHVzZXMgPSB2YWxpZFRyYW5zaXRpb25zW2N1cnJlbnRTdGF0dXNdIHx8IFtdO1xyXG4gICAgXHJcbiAgICBpZiAoIWFsbG93ZWRTdGF0dXNlcy5pbmNsdWRlcyhzdGF0dXMpICYmIHN0YXR1cyAhPT0gY3VycmVudFN0YXR1cykge1xyXG4gICAgICByZXR1cm4geyBcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSwgXHJcbiAgICAgICAgZXJyb3I6IGBJbnZhbGlkIHN0YXR1cyB0cmFuc2l0aW9uOiBjYW5ub3QgY2hhbmdlIGZyb20gJHtjdXJyZW50U3RhdHVzfSB0byAke3N0YXR1c31gIFxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFVwZGF0ZSBib29raW5nIHN0YXR1c1xyXG4gICAgY29uc3QgeyBkYXRhOiB1cGRhdGVkQm9va2luZywgZXJyb3I6IHVwZGF0ZUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnYm9va2luZ3MnKVxyXG4gICAgICAudXBkYXRlKHsgXHJcbiAgICAgICAgc3RhdHVzLFxyXG4gICAgICAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgfSlcclxuICAgICAgLmVxKCdpZCcsIGJvb2tpbmdJZClcclxuICAgICAgLnNlbGVjdCgpXHJcbiAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICBpZiAodXBkYXRlRXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgYm9va2luZyBzdGF0dXM6JywgdXBkYXRlRXJyb3IpO1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IHVwZGF0ZUVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBib29raW5nOiB1cGRhdGVkQm9va2luZyBhcyBCb29raW5nIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIHVwZGF0ZUJvb2tpbmdTdGF0dXM6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdGYWlsZWQgdG8gdXBkYXRlIGJvb2tpbmcgc3RhdHVzJyxcclxuICAgIH07XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogUmVwb3J0IGxhdGVuZXNzIGZvciBhIGJvb2tpbmcgKHdpdGggYXV0aG9yaXphdGlvbiBjaGVjayBmb3IgYXV0aGVudGljYXRlZCBjbGVhbmVyKVxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlcG9ydExhdGVuZXNzKFxyXG4gIGJvb2tpbmdJZDogc3RyaW5nLFxyXG4gIGV4cGVjdGVkQXJyaXZhbFRpbWU6IHN0cmluZywgLy8gSVNPIHRpbWVzdGFtcFxyXG4gIHJlYXNvbjogc3RyaW5nXHJcbik6IFByb21pc2U8e1xyXG4gIHN1Y2Nlc3M6IGJvb2xlYW47XHJcbiAgYm9va2luZz86IEJvb2tpbmc7XHJcbiAgZXJyb3I/OiBzdHJpbmc7XHJcbn0+IHtcclxuICB0cnkge1xyXG4gICAgLy8gR2V0IGF1dGhlbnRpY2F0ZWQgY2xlYW5lciBmaXJzdFxyXG4gICAgY29uc3QgY2xlYW5lclJlc3VsdCA9IGF3YWl0IGdldEN1cnJlbnRDbGVhbmVyKCk7XHJcbiAgICBpZiAoIWNsZWFuZXJSZXN1bHQuc3VjY2VzcyB8fCAhY2xlYW5lclJlc3VsdC5jbGVhbmVyKSB7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ05vdCBhdXRoZW50aWNhdGVkIG9yIGNsZWFuZXIgcHJvZmlsZSBub3QgZm91bmQnIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgY2xlYW5lcklkID0gY2xlYW5lclJlc3VsdC5jbGVhbmVyLmlkO1xyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBhd2FpdCBjcmVhdGVDbGllbnQoKTtcclxuXHJcbiAgICAvLyBWZXJpZnkgYXV0aG9yaXphdGlvblxyXG4gICAgY29uc3QgeyBkYXRhOiBib29raW5nLCBlcnJvcjogZmV0Y2hFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2Jvb2tpbmdzJylcclxuICAgICAgLnNlbGVjdCgnKicpXHJcbiAgICAgIC5lcSgnaWQnLCBib29raW5nSWQpXHJcbiAgICAgIC5tYXliZVNpbmdsZSgpO1xyXG5cclxuICAgIGlmIChmZXRjaEVycm9yIHx8ICFib29raW5nKSB7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0Jvb2tpbmcgbm90IGZvdW5kJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENoZWNrIGF1dGhvcml6YXRpb246IGNsZWFuZXIgbXVzdCBiZSBhc3NpZ25lZCB0byB0aGlzIGJvb2tpbmdcclxuICAgIGNvbnN0IG5vcm1hbGl6ZVV1aWQgPSAoaWQ6IGFueSk6IHN0cmluZyA9PiB7XHJcbiAgICAgIGlmICghaWQpIHJldHVybiAnJztcclxuICAgICAgcmV0dXJuIFN0cmluZyhpZCkudG9Mb3dlckNhc2UoKS50cmltKCk7XHJcbiAgICB9O1xyXG4gICAgY29uc3Qgbm9ybWFsaXplZENsZWFuZXJJZCA9IG5vcm1hbGl6ZVV1aWQoY2xlYW5lcklkKTtcclxuXHJcbiAgICBjb25zdCBpc0Fzc2lnbmVkU2luZ2xlID0gYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZCAmJiBcclxuICAgICAgbm9ybWFsaXplVXVpZChib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkKSA9PT0gbm9ybWFsaXplZENsZWFuZXJJZDtcclxuXHJcbiAgICBsZXQgaXNBc3NpZ25lZE11bHRpcGxlID0gZmFsc2U7XHJcbiAgICBpZiAoYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMgJiYgQXJyYXkuaXNBcnJheShib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcykpIHtcclxuICAgICAgaXNBc3NpZ25lZE11bHRpcGxlID0gYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMuc29tZShcclxuICAgICAgICAoaWQ6IHN0cmluZykgPT4gbm9ybWFsaXplVXVpZChpZCkgPT09IG5vcm1hbGl6ZWRDbGVhbmVySWRcclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBpc0Fzc2lnbmVkID0gaXNBc3NpZ25lZFNpbmdsZSB8fCBpc0Fzc2lnbmVkTXVsdGlwbGU7XHJcblxyXG4gICAgaWYgKCFpc0Fzc2lnbmVkKSB7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1VuYXV0aG9yaXplZDogWW91IGFyZSBub3QgYXNzaWduZWQgdG8gdGhpcyBib29raW5nJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFVwZGF0ZSBib29raW5nIHdpdGggbGF0ZW5lc3MgaW5mb3JtYXRpb25cclxuICAgIGNvbnN0IHsgZGF0YTogdXBkYXRlZEJvb2tpbmcsIGVycm9yOiB1cGRhdGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2Jvb2tpbmdzJylcclxuICAgICAgLnVwZGF0ZSh7XHJcbiAgICAgICAgZXhwZWN0ZWRfYXJyaXZhbF90aW1lOiBleHBlY3RlZEFycml2YWxUaW1lLFxyXG4gICAgICAgIGxhdGVuZXNzX3JlYXNvbjogcmVhc29uLFxyXG4gICAgICAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgfSlcclxuICAgICAgLmVxKCdpZCcsIGJvb2tpbmdJZClcclxuICAgICAgLnNlbGVjdCgpXHJcbiAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICBpZiAodXBkYXRlRXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVwb3J0aW5nIGxhdGVuZXNzOicsIHVwZGF0ZUVycm9yKTtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiB1cGRhdGVFcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgYm9va2luZzogdXBkYXRlZEJvb2tpbmcgYXMgQm9va2luZyB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiByZXBvcnRMYXRlbmVzczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0ZhaWxlZCB0byByZXBvcnQgbGF0ZW5lc3MnLFxyXG4gICAgfTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDYWxjdWxhdGUgZWFybmluZ3MgZm9yIG11bHRpcGxlIGJvb2tpbmdzIGF0IG9uY2VcclxuICogVGhpcyBpcyBtb3JlIGVmZmljaWVudCB0aGFuIGNhbGN1bGF0aW5nIGVhcm5pbmdzIG9uZSBib29raW5nIGF0IGEgdGltZVxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNhbGN1bGF0ZUJvb2tpbmdzRWFybmluZ3MoYm9va2luZ0lkczogc3RyaW5nW10pOiBQcm9taXNlPHtcclxuICBzdWNjZXNzOiBib29sZWFuO1xyXG4gIGVhcm5pbmdzPzogUmVjb3JkPHN0cmluZywgeyBiYXNlRWFybmluZ3M6IG51bWJlcjsgdGlwQW1vdW50OiBudW1iZXI7IHRvdGFsRWFybmluZ3M6IG51bWJlciB9PjtcclxuICBlcnJvcj86IHN0cmluZztcclxufT4ge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBHZXQgYXV0aGVudGljYXRlZCBjbGVhbmVyIGZpcnN0XHJcbiAgICBjb25zdCBjbGVhbmVyUmVzdWx0ID0gYXdhaXQgZ2V0Q3VycmVudENsZWFuZXIoKTtcclxuICAgIGlmICghY2xlYW5lclJlc3VsdC5zdWNjZXNzIHx8ICFjbGVhbmVyUmVzdWx0LmNsZWFuZXIpIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnTm90IGF1dGhlbnRpY2F0ZWQgb3IgY2xlYW5lciBwcm9maWxlIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBjbGVhbmVySWQgPSBjbGVhbmVyUmVzdWx0LmNsZWFuZXIuaWQ7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xyXG5cclxuICAgIGlmIChib29raW5nSWRzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBlYXJuaW5nczoge30gfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBHZXQgY2xlYW5lciBpbmZvIGZvciB0ZW51cmUgY2FsY3VsYXRpb25cclxuICAgIGNvbnN0IHsgZGF0YTogY2xlYW5lciwgZXJyb3I6IGNsZWFuZXJFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2NsZWFuZXJzJylcclxuICAgICAgLnNlbGVjdCgnY3JlYXRlZF9hdCcpXHJcbiAgICAgIC5lcSgnaWQnLCBjbGVhbmVySWQpXHJcbiAgICAgIC5tYXliZVNpbmdsZSgpO1xyXG5cclxuICAgIGlmIChjbGVhbmVyRXJyb3IgfHwgIWNsZWFuZXIpIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnQ2xlYW5lciBub3QgZm91bmQnIH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gR2V0IGFsbCBib29raW5nc1xyXG4gICAgY29uc3QgeyBkYXRhOiBib29raW5ncywgZXJyb3I6IGJvb2tpbmdzRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdib29raW5ncycpXHJcbiAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAuaW4oJ2lkJywgYm9va2luZ0lkcyk7XHJcblxyXG4gICAgaWYgKGJvb2tpbmdzRXJyb3IgfHwgIWJvb2tpbmdzKSB7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0ZhaWxlZCB0byBmZXRjaCBib29raW5ncycgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBHZXQgYWxsIGNsZWFuZXIgYm9va2luZ3MgdG8gY2FsY3VsYXRlIGhvdXJzXHJcbiAgICBjb25zdCB7IGRhdGE6IHNpbmdsZUJvb2tpbmdzIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnYm9va2luZ3MnKVxyXG4gICAgICAuc2VsZWN0KCdzdGF0dXMsIHBheW1lbnRfc3RhdHVzLCBzZXJ2aWNlX2R1cmF0aW9uLCBwcmVmZXJyZWRfY2xlYW5lcl9pZCwgcHJlZmVycmVkX2NsZWFuZXJfaWRzJylcclxuICAgICAgLmVxKCdwcmVmZXJyZWRfY2xlYW5lcl9pZCcsIGNsZWFuZXJJZCk7XHJcblxyXG4gICAgY29uc3QgeyBkYXRhOiBhbGxNdWx0aUJvb2tpbmdzIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnYm9va2luZ3MnKVxyXG4gICAgICAuc2VsZWN0KCdzdGF0dXMsIHBheW1lbnRfc3RhdHVzLCBzZXJ2aWNlX2R1cmF0aW9uLCBwcmVmZXJyZWRfY2xlYW5lcl9pZCwgcHJlZmVycmVkX2NsZWFuZXJfaWRzJylcclxuICAgICAgLm5vdCgncHJlZmVycmVkX2NsZWFuZXJfaWRzJywgJ2lzJywgbnVsbCk7XHJcblxyXG4gICAgLy8gRmlsdGVyIGJvb2tpbmdzIGFzc2lnbmVkIHRvIHRoaXMgY2xlYW5lclxyXG4gICAgY29uc3Qgbm9ybWFsaXplVXVpZCA9IChpZDogYW55KTogc3RyaW5nID0+IHtcclxuICAgICAgaWYgKCFpZCkgcmV0dXJuICcnO1xyXG4gICAgICByZXR1cm4gU3RyaW5nKGlkKS50b0xvd2VyQ2FzZSgpLnRyaW0oKTtcclxuICAgIH07XHJcbiAgICBjb25zdCBub3JtYWxpemVkQ2xlYW5lcklkID0gbm9ybWFsaXplVXVpZChjbGVhbmVySWQpO1xyXG5cclxuICAgIGNvbnN0IGFycmF5Qm9va2luZ3MgPSAoYWxsTXVsdGlCb29raW5ncyB8fCBbXSkuZmlsdGVyKChiOiBhbnkpID0+IHtcclxuICAgICAgaWYgKCFiLnByZWZlcnJlZF9jbGVhbmVyX2lkcyB8fCAhQXJyYXkuaXNBcnJheShiLnByZWZlcnJlZF9jbGVhbmVyX2lkcykpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGIucHJlZmVycmVkX2NsZWFuZXJfaWRzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gYi5wcmVmZXJyZWRfY2xlYW5lcl9pZHMuc29tZSgoaWQ6IHN0cmluZykgPT4gbm9ybWFsaXplVXVpZChpZCkgPT09IG5vcm1hbGl6ZWRDbGVhbmVySWQpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gQ29tYmluZSBhbmQgcmVtb3ZlIGR1cGxpY2F0ZXNcclxuICAgIGNvbnN0IGFsbEJvb2tpbmdzTWFwID0gbmV3IE1hcDxzdHJpbmcsIGFueT4oKTtcclxuICAgIChzaW5nbGVCb29raW5ncyB8fCBbXSkuZm9yRWFjaCgoYjogYW55KSA9PiB7XHJcbiAgICAgIGlmIChiLmlkKSB7XHJcbiAgICAgICAgYWxsQm9va2luZ3NNYXAuc2V0KGIuaWQsIGIpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIGFycmF5Qm9va2luZ3MuZm9yRWFjaCgoYjogYW55KSA9PiB7XHJcbiAgICAgIGlmIChiLmlkICYmICFhbGxCb29raW5nc01hcC5oYXMoYi5pZCkpIHtcclxuICAgICAgICBhbGxCb29raW5nc01hcC5zZXQoYi5pZCwgYik7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGNvbnN0IGNsZWFuZXJCb29raW5ncyA9IEFycmF5LmZyb20oYWxsQm9va2luZ3NNYXAudmFsdWVzKCkpO1xyXG5cclxuICAgIC8vIENhbGN1bGF0ZSB0ZW51cmUgYW5kIGhvdXJzXHJcbiAgICBjb25zdCB0ZW51cmVNb250aHMgPSBjYWxjdWxhdGVDbGVhbmVyVGVudXJlKGNsZWFuZXIuY3JlYXRlZF9hdCk7XHJcbiAgICBjb25zdCB0b3RhbEhvdXJzID0gY2FsY3VsYXRlVG90YWxIb3VycyhjbGVhbmVyQm9va2luZ3MpO1xyXG4gICAgY29uc3QgZWFybmluZ3NQZXJjZW50YWdlID0gZ2V0RWFybmluZ3NQZXJjZW50YWdlKHRlbnVyZU1vbnRocywgdG90YWxIb3Vycyk7XHJcblxyXG4gICAgLy8gQ2FsY3VsYXRlIGVhcm5pbmdzIGZvciBlYWNoIGJvb2tpbmdcclxuICAgIGNvbnN0IGVhcm5pbmdzUmVjb3JkOiBSZWNvcmQ8c3RyaW5nLCB7IGJhc2VFYXJuaW5nczogbnVtYmVyOyB0aXBBbW91bnQ6IG51bWJlcjsgdG90YWxFYXJuaW5nczogbnVtYmVyIH0+ID0ge307XHJcblxyXG4gICAgZm9yIChjb25zdCBib29raW5nIG9mIGJvb2tpbmdzKSB7XHJcbiAgICAgIGNvbnN0IGJhc2VFYXJuaW5ncyA9IGNhbGN1bGF0ZUNsZWFuZXJFYXJuaW5ncyhcclxuICAgICAgICB7XHJcbiAgICAgICAgICBzZXJ2aWNlX3R5cGU6IGJvb2tpbmcuc2VydmljZV90eXBlIHx8ICcnLFxyXG4gICAgICAgICAgdG90YWxfYW1vdW50OiBOdW1iZXIoYm9va2luZy50b3RhbF9hbW91bnQpIHx8IDAsXHJcbiAgICAgICAgICBzZXJ2aWNlX2ZlZTogTnVtYmVyKGJvb2tpbmcuc2VydmljZV9mZWUpIHx8IDAsXHJcbiAgICAgICAgICBlcXVpcG1lbnRfc3VwcGx5X3ByaWNlOiBOdW1iZXIoYm9va2luZy5lcXVpcG1lbnRfc3VwcGx5X3ByaWNlKSB8fCAwLFxyXG4gICAgICAgICAgYWRkaXRpb25hbF9jbGVhbmVyc19wcmljZTogTnVtYmVyKGJvb2tpbmcuYWRkaXRpb25hbF9jbGVhbmVyc19wcmljZSkgfHwgMCxcclxuICAgICAgICAgIHByZWZlcnJlZF9jbGVhbmVyX2lkczogYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMsXHJcbiAgICAgICAgICBwcmVmZXJyZWRfY2xlYW5lcl9pZDogYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZCxcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNsZWFuZXJJZCxcclxuICAgICAgICBlYXJuaW5nc1BlcmNlbnRhZ2UsXHJcbiAgICAgICAgYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHNcclxuICAgICAgKTtcclxuXHJcbiAgICAgIGNvbnN0IHRpcEFtb3VudCA9IGNhbGN1bGF0ZVRpcFBlckNsZWFuZXIoXHJcbiAgICAgICAgTnVtYmVyKGJvb2tpbmcudGlwX2Ftb3VudCkgfHwgMCxcclxuICAgICAgICBib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcyxcclxuICAgICAgICBib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkXHJcbiAgICAgICk7XHJcblxyXG4gICAgICBlYXJuaW5nc1JlY29yZFtib29raW5nLmlkXSA9IHtcclxuICAgICAgICBiYXNlRWFybmluZ3MsXHJcbiAgICAgICAgdGlwQW1vdW50LFxyXG4gICAgICAgIHRvdGFsRWFybmluZ3M6IGJhc2VFYXJuaW5ncyArIHRpcEFtb3VudCxcclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBlYXJuaW5nczogZWFybmluZ3NSZWNvcmQgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY2FsY3VsYXRpbmcgYm9va2luZ3MgZWFybmluZ3M6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdGYWlsZWQgdG8gY2FsY3VsYXRlIGVhcm5pbmdzJyxcclxuICAgIH07XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogR2V0IGNsZWFuZXIgc3RhdGlzdGljcyBmb3IgdGhlIGF1dGhlbnRpY2F0ZWQgY2xlYW5lclxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENsZWFuZXJTdGF0cygpOiBQcm9taXNlPHtcclxuICBzdWNjZXNzOiBib29sZWFuO1xyXG4gIHN0YXRzPzoge1xyXG4gICAgdG90YWxCb29raW5nczogbnVtYmVyO1xyXG4gICAgY29tcGxldGVkQm9va2luZ3M6IG51bWJlcjtcclxuICAgIHVwY29taW5nQm9va2luZ3M6IG51bWJlcjtcclxuICAgIHRvZGF5Qm9va2luZ3M6IG51bWJlcjtcclxuICAgIHRvdGFsRWFybmluZ3M6IG51bWJlcjtcclxuICAgIG1vbnRobHlFYXJuaW5nczogbnVtYmVyO1xyXG4gICAgYXZlcmFnZVJhdGluZzogbnVtYmVyO1xyXG4gICAgcmVsaWFiaWxpdHlTY29yZTogbnVtYmVyO1xyXG4gICAgY29tcGxldGlvblJhdGU6IG51bWJlcjtcclxuICAgIG9uVGltZVJhdGU6IG51bWJlcjtcclxuICB9O1xyXG4gIGVycm9yPzogc3RyaW5nO1xyXG59PiB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIEdldCBhdXRoZW50aWNhdGVkIGNsZWFuZXIgZmlyc3RcclxuICAgIGNvbnN0IGNsZWFuZXJSZXN1bHQgPSBhd2FpdCBnZXRDdXJyZW50Q2xlYW5lcigpO1xyXG4gICAgaWYgKCFjbGVhbmVyUmVzdWx0LnN1Y2Nlc3MgfHwgIWNsZWFuZXJSZXN1bHQuY2xlYW5lcikge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdOb3QgYXV0aGVudGljYXRlZCBvciBjbGVhbmVyIHByb2ZpbGUgbm90IGZvdW5kJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGNsZWFuZXJJZCA9IGNsZWFuZXJSZXN1bHQuY2xlYW5lci5pZDtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQ2xpZW50KCk7XHJcblxyXG4gICAgLy8gR2V0IGNsZWFuZXIgaW5mbyBpbmNsdWRpbmcgY3JlYXRlZF9hdCBmb3IgdGVudXJlIGNhbGN1bGF0aW9uXHJcbiAgICBjb25zdCB7IGRhdGE6IGNsZWFuZXIsIGVycm9yOiBjbGVhbmVyRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdjbGVhbmVycycpXHJcbiAgICAgIC5zZWxlY3QoJ3JhdGluZywgcmVsaWFiaWxpdHlfc2NvcmUsIHRvdGFsX2Jvb2tpbmdzLCBjb21wbGV0ZWRfYm9va2luZ3MsIG9uX3RpbWVfYm9va2luZ3MsIGNyZWF0ZWRfYXQnKVxyXG4gICAgICAuZXEoJ2lkJywgY2xlYW5lcklkKVxyXG4gICAgICAubWF5YmVTaW5nbGUoKTtcclxuXHJcbiAgICBpZiAoY2xlYW5lckVycm9yIHx8ICFjbGVhbmVyKSB7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0NsZWFuZXIgbm90IGZvdW5kJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEdldCBhbGwgYm9va2luZ3MgYXNzaWduZWQgdG8gdGhpcyBjbGVhbmVyXHJcbiAgICAvLyBGZXRjaCBib29raW5ncyB3aXRoIHByZWZlcnJlZF9jbGVhbmVyX2lkIChzaW5nbGUpIC0gaW5jbHVkZSBhbGwgZmllbGRzIG5lZWRlZCBmb3IgZWFybmluZ3MgY2FsY3VsYXRpb25cclxuICAgIGNvbnN0IHsgZGF0YTogc2luZ2xlQm9va2luZ3MsIGVycm9yOiBzaW5nbGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2Jvb2tpbmdzJylcclxuICAgICAgLnNlbGVjdCgnaWQsIHN0YXR1cywgc2VydmljZV9kYXRlLCB0b3RhbF9hbW91bnQsIHBheW1lbnRfc3RhdHVzLCBzZXJ2aWNlX3R5cGUsIHNlcnZpY2VfZmVlLCBzdWJ0b3RhbCwgdGlwX2Ftb3VudCwgc2VydmljZV9kdXJhdGlvbiwgZXF1aXBtZW50X3N1cHBseV9wcmljZSwgYWRkaXRpb25hbF9jbGVhbmVyc19wcmljZSwgcHJlZmVycmVkX2NsZWFuZXJfaWQsIHByZWZlcnJlZF9jbGVhbmVyX2lkcycpXHJcbiAgICAgIC5lcSgncHJlZmVycmVkX2NsZWFuZXJfaWQnLCBjbGVhbmVySWQpO1xyXG5cclxuICAgIC8vIEZldGNoIGJvb2tpbmdzIHdpdGggcHJlZmVycmVkX2NsZWFuZXJfaWRzIChhcnJheSkgLSBmZXRjaCBhbGwgd2l0aCBhcnJheXMsIHRoZW4gZmlsdGVyIGluIEpTXHJcbiAgICBjb25zdCB7IGRhdGE6IGFsbE11bHRpQm9va2luZ3MsIGVycm9yOiBtdWx0aUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnYm9va2luZ3MnKVxyXG4gICAgICAuc2VsZWN0KCdpZCwgc3RhdHVzLCBzZXJ2aWNlX2RhdGUsIHRvdGFsX2Ftb3VudCwgcGF5bWVudF9zdGF0dXMsIHNlcnZpY2VfdHlwZSwgc2VydmljZV9mZWUsIHN1YnRvdGFsLCB0aXBfYW1vdW50LCBzZXJ2aWNlX2R1cmF0aW9uLCBlcXVpcG1lbnRfc3VwcGx5X3ByaWNlLCBhZGRpdGlvbmFsX2NsZWFuZXJzX3ByaWNlLCBwcmVmZXJyZWRfY2xlYW5lcl9pZHMsIHByZWZlcnJlZF9jbGVhbmVyX2lkJylcclxuICAgICAgLm5vdCgncHJlZmVycmVkX2NsZWFuZXJfaWRzJywgJ2lzJywgbnVsbCk7XHJcblxyXG4gICAgaWYgKHNpbmdsZUVycm9yIHx8IG11bHRpRXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgYm9va2luZ3MgZm9yIHN0YXRzOicsIHNpbmdsZUVycm9yIHx8IG11bHRpRXJyb3IpO1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IChzaW5nbGVFcnJvciB8fCBtdWx0aUVycm9yKT8ubWVzc2FnZSB8fCAnRmFpbGVkIHRvIGZldGNoIGJvb2tpbmdzJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIERlYnVnIGxvZ2dpbmdcclxuICAgIGNvbnNvbGUubG9nKCdbZ2V0Q2xlYW5lclN0YXRzXSBGZXRjaGVkIGJvb2tpbmdzOicsIHtcclxuICAgICAgY2xlYW5lcklkLFxyXG4gICAgICBzaW5nbGVCb29raW5nc0NvdW50OiBzaW5nbGVCb29raW5ncz8ubGVuZ3RoIHx8IDAsXHJcbiAgICAgIGFsbE11bHRpQm9va2luZ3NDb3VudDogYWxsTXVsdGlCb29raW5ncz8ubGVuZ3RoIHx8IDAsXHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBGaWx0ZXIgYm9va2luZ3Mgd2hlcmUgcHJlZmVycmVkX2NsZWFuZXJfaWRzIGFycmF5IGNvbnRhaW5zIHRoaXMgY2xlYW5lcklkXHJcbiAgICAvLyBOb3JtYWxpemUgVVVJRHMgZm9yIGNvbXBhcmlzb24gKGhhbmRsZSBjYXNlIGRpZmZlcmVuY2VzIGFuZCBzdHJpbmcgZm9ybWF0cylcclxuICAgIGNvbnN0IG5vcm1hbGl6ZVV1aWQgPSAoaWQ6IGFueSk6IHN0cmluZyA9PiB7XHJcbiAgICAgIGlmICghaWQpIHJldHVybiAnJztcclxuICAgICAgcmV0dXJuIFN0cmluZyhpZCkudG9Mb3dlckNhc2UoKS50cmltKCk7XHJcbiAgICB9O1xyXG4gICAgY29uc3Qgbm9ybWFsaXplZENsZWFuZXJJZCA9IG5vcm1hbGl6ZVV1aWQoY2xlYW5lcklkKTtcclxuICAgIFxyXG4gICAgY29uc3QgYXJyYXlCb29raW5ncyA9IChhbGxNdWx0aUJvb2tpbmdzIHx8IFtdKS5maWx0ZXIoKGJvb2tpbmc6IGFueSkgPT4ge1xyXG4gICAgICBpZiAoIWJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWRzIHx8ICFBcnJheS5pc0FycmF5KGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWRzKSkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgICAvLyBDaGVjayBpZiBhcnJheSBpcyBlbXB0eVxyXG4gICAgICBpZiAoYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICAgIC8vIENoZWNrIGlmIGFueSBJRCBpbiB0aGUgYXJyYXkgbWF0Y2hlcyB0aGUgY2xlYW5lcklkIChjYXNlLWluc2Vuc2l0aXZlKVxyXG4gICAgICByZXR1cm4gYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMuc29tZSgoaWQ6IHN0cmluZykgPT4gbm9ybWFsaXplVXVpZChpZCkgPT09IG5vcm1hbGl6ZWRDbGVhbmVySWQpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gQ29tYmluZSBhbmQgcmVtb3ZlIGR1cGxpY2F0ZXMgYnkgSURcclxuICAgIGNvbnN0IGFsbEJvb2tpbmdzTWFwID0gbmV3IE1hcDxzdHJpbmcsIGFueT4oKTtcclxuICAgIChzaW5nbGVCb29raW5ncyB8fCBbXSkuZm9yRWFjaCgoYm9va2luZzogYW55KSA9PiB7XHJcbiAgICAgIGlmIChib29raW5nLmlkKSB7XHJcbiAgICAgICAgYWxsQm9va2luZ3NNYXAuc2V0KGJvb2tpbmcuaWQsIGJvb2tpbmcpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIGFycmF5Qm9va2luZ3MuZm9yRWFjaCgoYm9va2luZzogYW55KSA9PiB7XHJcbiAgICAgIGlmIChib29raW5nLmlkICYmICFhbGxCb29raW5nc01hcC5oYXMoYm9va2luZy5pZCkpIHtcclxuICAgICAgICBhbGxCb29raW5nc01hcC5zZXQoYm9va2luZy5pZCwgYm9va2luZyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBjb25zdCBhbGxCb29raW5ncyA9IEFycmF5LmZyb20oYWxsQm9va2luZ3NNYXAudmFsdWVzKCkpO1xyXG5cclxuICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XHJcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xyXG4gICAgY29uc3QgZmlyc3REYXlPZk1vbnRoID0gbmV3IERhdGUobm93LmdldEZ1bGxZZWFyKCksIG5vdy5nZXRNb250aCgpLCAxKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XHJcbiAgICBjb25zdCBjb21wbGV0ZWRCb29raW5ncyA9IGFsbEJvb2tpbmdzLmZpbHRlcihiID0+IGIuc3RhdHVzID09PSAnY29tcGxldGVkJyk7XHJcbiAgICBjb25zdCB1cGNvbWluZ0Jvb2tpbmdzID0gYWxsQm9va2luZ3MuZmlsdGVyKGIgPT4gXHJcbiAgICAgIFsncGVuZGluZycsICdjb25maXJtZWQnLCAnb25fbXlfd2F5JywgJ3N0YXJ0ZWQnXS5pbmNsdWRlcyhiLnN0YXR1cykgJiZcclxuICAgICAgYi5zZXJ2aWNlX2RhdGUgPj0gdG9kYXlcclxuICAgICk7XHJcbiAgICBjb25zdCB0b2RheUJvb2tpbmdzID0gYWxsQm9va2luZ3MuZmlsdGVyKGIgPT4gYi5zZXJ2aWNlX2RhdGUgPT09IHRvZGF5KTtcclxuICAgIGNvbnN0IHBhaWRCb29raW5ncyA9IGFsbEJvb2tpbmdzLmZpbHRlcihiID0+IGIucGF5bWVudF9zdGF0dXMgPT09ICdwYWlkJyk7XHJcbiAgICBjb25zdCBtb250aGx5UGFpZEJvb2tpbmdzID0gcGFpZEJvb2tpbmdzLmZpbHRlcihiID0+IGIuc2VydmljZV9kYXRlID49IGZpcnN0RGF5T2ZNb250aCk7XHJcblxyXG4gICAgLy8gQ2FsY3VsYXRlIGNsZWFuZXIgdGVudXJlIGFuZCB0b3RhbCBob3VycyBmb3IgZWxpZ2liaWxpdHkgZGV0ZXJtaW5hdGlvblxyXG4gICAgY29uc3QgdGVudXJlTW9udGhzID0gY2FsY3VsYXRlQ2xlYW5lclRlbnVyZShjbGVhbmVyLmNyZWF0ZWRfYXQpO1xyXG4gICAgY29uc3QgdG90YWxIb3VycyA9IGNhbGN1bGF0ZVRvdGFsSG91cnMoYWxsQm9va2luZ3MpO1xyXG4gICAgY29uc3QgZWFybmluZ3NQZXJjZW50YWdlID0gZ2V0RWFybmluZ3NQZXJjZW50YWdlKHRlbnVyZU1vbnRocywgdG90YWxIb3Vycyk7XHJcblxyXG4gICAgLy8gQ2FsY3VsYXRlIGVhcm5pbmdzIHVzaW5nIHRoZSBuZXcgc3lzdGVtXHJcbiAgICAvLyBPbmx5IGNhbGN1bGF0ZSBlYXJuaW5ncyBmb3IgcGFpZCBib29raW5ncyAoZWFybmluZ3MgYXJlIG9ubHkgcGFpZCB3aGVuIGN1c3RvbWVyIGhhcyBwYWlkKVxyXG4gICAgLy8gRXF1aXBtZW50IGZlZSBhbmQgYWRkaXRpb25hbCBjbGVhbmVycyBjaGFyZ2VzIGFyZSBleGNsdWRlZCBmcm9tIGNsZWFuZXIgZWFybmluZ3NcclxuICAgIGNvbnN0IHRvdGFsRWFybmluZ3MgPSBwYWlkQm9va2luZ3MucmVkdWNlKChzdW0sIGJvb2tpbmcpID0+IHtcclxuICAgICAgY29uc3QgZWFybmluZ3MgPSBjYWxjdWxhdGVUb3RhbEVhcm5pbmdzRnJvbUJvb2tpbmcoXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgc2VydmljZV90eXBlOiBib29raW5nLnNlcnZpY2VfdHlwZSB8fCAnJyxcclxuICAgICAgICAgIHRvdGFsX2Ftb3VudDogTnVtYmVyKGJvb2tpbmcudG90YWxfYW1vdW50KSB8fCAwLFxyXG4gICAgICAgICAgc2VydmljZV9mZWU6IE51bWJlcihib29raW5nLnNlcnZpY2VfZmVlKSB8fCAwLFxyXG4gICAgICAgICAgZXF1aXBtZW50X3N1cHBseV9wcmljZTogTnVtYmVyKGJvb2tpbmcuZXF1aXBtZW50X3N1cHBseV9wcmljZSkgfHwgMCxcclxuICAgICAgICAgIGFkZGl0aW9uYWxfY2xlYW5lcnNfcHJpY2U6IE51bWJlcihib29raW5nLmFkZGl0aW9uYWxfY2xlYW5lcnNfcHJpY2UpIHx8IDAsXHJcbiAgICAgICAgICB0aXBfYW1vdW50OiBOdW1iZXIoYm9va2luZy50aXBfYW1vdW50KSB8fCAwLFxyXG4gICAgICAgICAgcHJlZmVycmVkX2NsZWFuZXJfaWRzOiBib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcyxcclxuICAgICAgICAgIHByZWZlcnJlZF9jbGVhbmVyX2lkOiBib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY2xlYW5lcklkLFxyXG4gICAgICAgIGVhcm5pbmdzUGVyY2VudGFnZVxyXG4gICAgICApO1xyXG4gICAgICByZXR1cm4gc3VtICsgZWFybmluZ3M7XHJcbiAgICB9LCAwKTtcclxuXHJcbiAgICBjb25zdCBtb250aGx5RWFybmluZ3MgPSBtb250aGx5UGFpZEJvb2tpbmdzLnJlZHVjZSgoc3VtLCBib29raW5nKSA9PiB7XHJcbiAgICAgIGNvbnN0IGVhcm5pbmdzID0gY2FsY3VsYXRlVG90YWxFYXJuaW5nc0Zyb21Cb29raW5nKFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIHNlcnZpY2VfdHlwZTogYm9va2luZy5zZXJ2aWNlX3R5cGUgfHwgJycsXHJcbiAgICAgICAgICB0b3RhbF9hbW91bnQ6IE51bWJlcihib29raW5nLnRvdGFsX2Ftb3VudCkgfHwgMCxcclxuICAgICAgICAgIHNlcnZpY2VfZmVlOiBOdW1iZXIoYm9va2luZy5zZXJ2aWNlX2ZlZSkgfHwgMCxcclxuICAgICAgICAgIGVxdWlwbWVudF9zdXBwbHlfcHJpY2U6IE51bWJlcihib29raW5nLmVxdWlwbWVudF9zdXBwbHlfcHJpY2UpIHx8IDAsXHJcbiAgICAgICAgICBhZGRpdGlvbmFsX2NsZWFuZXJzX3ByaWNlOiBOdW1iZXIoYm9va2luZy5hZGRpdGlvbmFsX2NsZWFuZXJzX3ByaWNlKSB8fCAwLFxyXG4gICAgICAgICAgdGlwX2Ftb3VudDogTnVtYmVyKGJvb2tpbmcudGlwX2Ftb3VudCkgfHwgMCxcclxuICAgICAgICAgIHByZWZlcnJlZF9jbGVhbmVyX2lkczogYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMsXHJcbiAgICAgICAgICBwcmVmZXJyZWRfY2xlYW5lcl9pZDogYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZCxcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNsZWFuZXJJZCxcclxuICAgICAgICBlYXJuaW5nc1BlcmNlbnRhZ2VcclxuICAgICAgKTtcclxuICAgICAgcmV0dXJuIHN1bSArIGVhcm5pbmdzO1xyXG4gICAgfSwgMCk7XHJcblxyXG4gICAgY29uc3QgY29tcGxldGlvblJhdGUgPSBjbGVhbmVyLnRvdGFsX2Jvb2tpbmdzIFxyXG4gICAgICA/IChjbGVhbmVyLmNvbXBsZXRlZF9ib29raW5ncyB8fCAwKSAvIGNsZWFuZXIudG90YWxfYm9va2luZ3MgKiAxMDAgXHJcbiAgICAgIDogMDtcclxuICAgIFxyXG4gICAgY29uc3Qgb25UaW1lUmF0ZSA9IGNsZWFuZXIuY29tcGxldGVkX2Jvb2tpbmdzXHJcbiAgICAgID8gKGNsZWFuZXIub25fdGltZV9ib29raW5ncyB8fCAwKSAvIGNsZWFuZXIuY29tcGxldGVkX2Jvb2tpbmdzICogMTAwXHJcbiAgICAgIDogMDtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICBzdGF0czoge1xyXG4gICAgICAgIHRvdGFsQm9va2luZ3M6IGFsbEJvb2tpbmdzLmxlbmd0aCxcclxuICAgICAgICBjb21wbGV0ZWRCb29raW5nczogY29tcGxldGVkQm9va2luZ3MubGVuZ3RoLFxyXG4gICAgICAgIHVwY29taW5nQm9va2luZ3M6IHVwY29taW5nQm9va2luZ3MubGVuZ3RoLFxyXG4gICAgICAgIHRvZGF5Qm9va2luZ3M6IHRvZGF5Qm9va2luZ3MubGVuZ3RoLFxyXG4gICAgICAgIHRvdGFsRWFybmluZ3MsXHJcbiAgICAgICAgbW9udGhseUVhcm5pbmdzLFxyXG4gICAgICAgIGF2ZXJhZ2VSYXRpbmc6IE51bWJlcihjbGVhbmVyLnJhdGluZykgfHwgMCxcclxuICAgICAgICByZWxpYWJpbGl0eVNjb3JlOiBOdW1iZXIoY2xlYW5lci5yZWxpYWJpbGl0eV9zY29yZSkgfHwgMCxcclxuICAgICAgICBjb21wbGV0aW9uUmF0ZSxcclxuICAgICAgICBvblRpbWVSYXRlLFxyXG4gICAgICB9LFxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gZ2V0Q2xlYW5lclN0YXRzOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnRmFpbGVkIHRvIGZldGNoIHN0YXRzJyxcclxuICAgIH07XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogVXBkYXRlIGNsZWFuZXIgYXZhaWxhYmlsaXR5XHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlQ2xlYW5lckF2YWlsYWJpbGl0eShcclxuICBjbGVhbmVySWQ6IHN0cmluZyxcclxuICB1cGRhdGVzOiB7XHJcbiAgICBpc0F2YWlsYWJsZT86IGJvb2xlYW47XHJcbiAgICBhdmFpbGFibGVNb25kYXk/OiBib29sZWFuO1xyXG4gICAgYXZhaWxhYmxlVHVlc2RheT86IGJvb2xlYW47XHJcbiAgICBhdmFpbGFibGVXZWRuZXNkYXk/OiBib29sZWFuO1xyXG4gICAgYXZhaWxhYmxlVGh1cnNkYXk/OiBib29sZWFuO1xyXG4gICAgYXZhaWxhYmxlRnJpZGF5PzogYm9vbGVhbjtcclxuICAgIGF2YWlsYWJsZVNhdHVyZGF5PzogYm9vbGVhbjtcclxuICAgIGF2YWlsYWJsZVN1bmRheT86IGJvb2xlYW47XHJcbiAgfVxyXG4pOiBQcm9taXNlPHtcclxuICBzdWNjZXNzOiBib29sZWFuO1xyXG4gIGNsZWFuZXI/OiBDbGVhbmVyO1xyXG4gIGVycm9yPzogc3RyaW5nO1xyXG59PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQ2xpZW50KCk7XHJcblxyXG4gICAgY29uc3QgdXBkYXRlRGF0YTogYW55ID0ge1xyXG4gICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICB9O1xyXG5cclxuICAgIGlmICh1cGRhdGVzLmlzQXZhaWxhYmxlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgdXBkYXRlRGF0YS5pc19hdmFpbGFibGUgPSB1cGRhdGVzLmlzQXZhaWxhYmxlO1xyXG4gICAgfVxyXG4gICAgaWYgKHVwZGF0ZXMuYXZhaWxhYmxlTW9uZGF5ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgdXBkYXRlRGF0YS5hdmFpbGFibGVfbW9uZGF5ID0gdXBkYXRlcy5hdmFpbGFibGVNb25kYXk7XHJcbiAgICB9XHJcbiAgICBpZiAodXBkYXRlcy5hdmFpbGFibGVUdWVzZGF5ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgdXBkYXRlRGF0YS5hdmFpbGFibGVfdHVlc2RheSA9IHVwZGF0ZXMuYXZhaWxhYmxlVHVlc2RheTtcclxuICAgIH1cclxuICAgIGlmICh1cGRhdGVzLmF2YWlsYWJsZVdlZG5lc2RheSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHVwZGF0ZURhdGEuYXZhaWxhYmxlX3dlZG5lc2RheSA9IHVwZGF0ZXMuYXZhaWxhYmxlV2VkbmVzZGF5O1xyXG4gICAgfVxyXG4gICAgaWYgKHVwZGF0ZXMuYXZhaWxhYmxlVGh1cnNkYXkgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB1cGRhdGVEYXRhLmF2YWlsYWJsZV90aHVyc2RheSA9IHVwZGF0ZXMuYXZhaWxhYmxlVGh1cnNkYXk7XHJcbiAgICB9XHJcbiAgICBpZiAodXBkYXRlcy5hdmFpbGFibGVGcmlkYXkgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB1cGRhdGVEYXRhLmF2YWlsYWJsZV9mcmlkYXkgPSB1cGRhdGVzLmF2YWlsYWJsZUZyaWRheTtcclxuICAgIH1cclxuICAgIGlmICh1cGRhdGVzLmF2YWlsYWJsZVNhdHVyZGF5ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgdXBkYXRlRGF0YS5hdmFpbGFibGVfc2F0dXJkYXkgPSB1cGRhdGVzLmF2YWlsYWJsZVNhdHVyZGF5O1xyXG4gICAgfVxyXG4gICAgaWYgKHVwZGF0ZXMuYXZhaWxhYmxlU3VuZGF5ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgdXBkYXRlRGF0YS5hdmFpbGFibGVfc3VuZGF5ID0gdXBkYXRlcy5hdmFpbGFibGVTdW5kYXk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgeyBkYXRhOiB1cGRhdGVkQ2xlYW5lciwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdjbGVhbmVycycpXHJcbiAgICAgIC51cGRhdGUodXBkYXRlRGF0YSlcclxuICAgICAgLmVxKCdpZCcsIGNsZWFuZXJJZClcclxuICAgICAgLnNlbGVjdCgpXHJcbiAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2xlYW5lciBhdmFpbGFiaWxpdHk6JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBjbGVhbmVyOiB1cGRhdGVkQ2xlYW5lciBhcyBDbGVhbmVyIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIHVwZGF0ZUNsZWFuZXJBdmFpbGFiaWxpdHk6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdGYWlsZWQgdG8gdXBkYXRlIGF2YWlsYWJpbGl0eScsXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Im1TQXFVc0IscU1BQUEifQ==
}),
"[project]/app/booking/quote/data:c40742 [app-client] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "getAdditionalServices",
    ()=>$$RSC_SERVER_ACTION_5
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-client] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"406015e2758827c594502325e52d94d06f4df9298f":"getAdditionalServices"},"app/booking/quote/actions.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_5 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createServerReference"])("406015e2758827c594502325e52d94d06f4df9298f", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["findSourceMapURL"], "getAdditionalServices");
;
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vYWN0aW9ucy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHNlcnZlcic7XHJcblxyXG5pbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAL2xpYi9zdXBhYmFzZS9zZXJ2ZXInO1xyXG5pbXBvcnQgeyBRdW90ZUZvcm1EYXRhLCBRdW90ZVN0YXR1cywgUXVvdGUsIFNlcnZpY2UsIEFkZGl0aW9uYWxTZXJ2aWNlLCBIb21lRGV0YWlsT3B0aW9uLCBDbGVhbmluZ0VxdWlwbWVudCB9IGZyb20gJ0AvdHlwZXMvcXVvdGUnO1xyXG5pbXBvcnQgeyByZXZhbGlkYXRlUGF0aCB9IGZyb20gJ25leHQvY2FjaGUnO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBTYXZlUXVvdGVSZXN1bHQge1xyXG4gIHN1Y2Nlc3M6IGJvb2xlYW47XHJcbiAgZGF0YT86IFF1b3RlO1xyXG4gIGVycm9yPzogc3RyaW5nO1xyXG59XHJcblxyXG4vKipcclxuICogU2F2ZSBvciB1cGRhdGUgYSBxdW90ZSBkcmFmdFxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNhdmVRdW90ZURyYWZ0KFxyXG4gIGVtYWlsOiBzdHJpbmcsXHJcbiAgZm9ybURhdGE6IFF1b3RlRm9ybURhdGFcclxuKTogUHJvbWlzZTxTYXZlUXVvdGVSZXN1bHQ+IHtcclxuICB0cnkge1xyXG4gICAgaWYgKCFlbWFpbCB8fCAhZW1haWwudHJpbSgpKSB7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0VtYWlsIGlzIHJlcXVpcmVkJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQ2xpZW50KCk7XHJcblxyXG4gICAgLy8gQ2hlY2sgaWYgYSBkcmFmdCBhbHJlYWR5IGV4aXN0cyBmb3IgdGhpcyBlbWFpbFxyXG4gICAgY29uc3QgeyBkYXRhOiBleGlzdGluZ0RyYWZ0IH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgncXVvdGVzJylcclxuICAgICAgLnNlbGVjdCgnaWQnKVxyXG4gICAgICAuZXEoJ2VtYWlsJywgZW1haWwudHJpbSgpLnRvTG93ZXJDYXNlKCkpXHJcbiAgICAgIC5lcSgnc3RhdHVzJywgJ2RyYWZ0JylcclxuICAgICAgLm9yZGVyKCd1cGRhdGVkX2F0JywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXHJcbiAgICAgIC5saW1pdCgxKVxyXG4gICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgaWYgKGV4aXN0aW5nRHJhZnQpIHtcclxuICAgICAgLy8gVXBkYXRlIGV4aXN0aW5nIGRyYWZ0XHJcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgICAgLmZyb20oJ3F1b3RlcycpXHJcbiAgICAgICAgLnVwZGF0ZSh7XHJcbiAgICAgICAgICBmb3JtX2RhdGE6IGZvcm1EYXRhLFxyXG4gICAgICAgICAgdXBkYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmVxKCdpZCcsIGV4aXN0aW5nRHJhZnQuaWQpXHJcbiAgICAgICAgLnNlbGVjdCgpXHJcbiAgICAgICAgLnNpbmdsZSgpO1xyXG5cclxuICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgcXVvdGUgZHJhZnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBkYXRhIGFzIFF1b3RlIH07XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBDcmVhdGUgbmV3IGRyYWZ0XHJcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgICAgLmZyb20oJ3F1b3RlcycpXHJcbiAgICAgICAgLmluc2VydCh7XHJcbiAgICAgICAgICBlbWFpbDogZW1haWwudHJpbSgpLnRvTG93ZXJDYXNlKCksXHJcbiAgICAgICAgICBzdGF0dXM6ICdkcmFmdCcsXHJcbiAgICAgICAgICBmb3JtX2RhdGE6IGZvcm1EYXRhLFxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnNlbGVjdCgpXHJcbiAgICAgICAgLnNpbmdsZSgpO1xyXG5cclxuICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgcXVvdGUgZHJhZnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBkYXRhIGFzIFF1b3RlIH07XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ1VuZXhwZWN0ZWQgZXJyb3Igc2F2aW5nIHF1b3RlIGRyYWZ0OicsIGVycm9yKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnQW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnJlZCcsXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEdldCB0aGUgbGF0ZXN0IGRyYWZ0IHF1b3RlIGZvciBhbiBlbWFpbFxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFF1b3RlRHJhZnQoZW1haWw6IHN0cmluZyk6IFByb21pc2U8UXVvdGUgfCBudWxsPiB7XHJcbiAgdHJ5IHtcclxuICAgIGlmICghZW1haWwgfHwgIWVtYWlsLnRyaW0oKSkge1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xyXG5cclxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdxdW90ZXMnKVxyXG4gICAgICAuc2VsZWN0KCcqJylcclxuICAgICAgLmVxKCdlbWFpbCcsIGVtYWlsLnRyaW0oKS50b0xvd2VyQ2FzZSgpKVxyXG4gICAgICAuZXEoJ3N0YXR1cycsICdkcmFmdCcpXHJcbiAgICAgIC5vcmRlcigndXBkYXRlZF9hdCcsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KVxyXG4gICAgICAubGltaXQoMSlcclxuICAgICAgLnNpbmdsZSgpO1xyXG5cclxuICAgIGlmIChlcnJvcikge1xyXG4gICAgICAvLyBJZiBubyBkcmFmdCBleGlzdHMsIHRoYXQncyBva2F5IC0gcmV0dXJuIG51bGxcclxuICAgICAgaWYgKGVycm9yLmNvZGUgPT09ICdQR1JTVDExNicpIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgfVxyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBxdW90ZSBkcmFmdDonLCBlcnJvcik7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBkYXRhIGFzIFF1b3RlO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdVbmV4cGVjdGVkIGVycm9yIGZldGNoaW5nIHF1b3RlIGRyYWZ0OicsIGVycm9yKTtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEdldCBhbGwgcXVvdGVzIChkcmFmdHMgYW5kIHN1Ym1pdHRlZCkgZm9yIGFuIGVtYWlsXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UXVvdGVzQnlFbWFpbChlbWFpbDogc3RyaW5nKTogUHJvbWlzZTxRdW90ZVtdPiB7XHJcbiAgdHJ5IHtcclxuICAgIGlmICghZW1haWwgfHwgIWVtYWlsLnRyaW0oKSkge1xyXG4gICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBhd2FpdCBjcmVhdGVDbGllbnQoKTtcclxuXHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgncXVvdGVzJylcclxuICAgICAgLnNlbGVjdCgnKicpXHJcbiAgICAgIC5lcSgnZW1haWwnLCBlbWFpbC50cmltKCkudG9Mb3dlckNhc2UoKSlcclxuICAgICAgLm9yZGVyKCd1cGRhdGVkX2F0JywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pO1xyXG5cclxuICAgIGlmIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBxdW90ZXM6JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIChkYXRhIHx8IFtdKSBhcyBRdW90ZVtdO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdVbmV4cGVjdGVkIGVycm9yIGZldGNoaW5nIHF1b3RlczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogU3VibWl0IGEgcXVvdGUgKGNoYW5nZSBzdGF0dXMgZnJvbSBkcmFmdCB0byBzdWJtaXR0ZWQpXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc3VibWl0UXVvdGUoXHJcbiAgZW1haWw6IHN0cmluZyxcclxuICBmb3JtRGF0YTogUXVvdGVGb3JtRGF0YVxyXG4pOiBQcm9taXNlPFNhdmVRdW90ZVJlc3VsdD4ge1xyXG4gIHRyeSB7XHJcbiAgICBpZiAoIWVtYWlsIHx8ICFlbWFpbC50cmltKCkpIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnRW1haWwgaXMgcmVxdWlyZWQnIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBhd2FpdCBjcmVhdGVDbGllbnQoKTtcclxuXHJcbiAgICAvLyBDaGVjayBpZiBhIGRyYWZ0IGV4aXN0cyBmb3IgdGhpcyBlbWFpbFxyXG4gICAgY29uc3QgeyBkYXRhOiBleGlzdGluZ0RyYWZ0IH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgncXVvdGVzJylcclxuICAgICAgLnNlbGVjdCgnaWQnKVxyXG4gICAgICAuZXEoJ2VtYWlsJywgZW1haWwudHJpbSgpLnRvTG93ZXJDYXNlKCkpXHJcbiAgICAgIC5lcSgnc3RhdHVzJywgJ2RyYWZ0JylcclxuICAgICAgLm9yZGVyKCd1cGRhdGVkX2F0JywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXHJcbiAgICAgIC5saW1pdCgxKVxyXG4gICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgaWYgKGV4aXN0aW5nRHJhZnQpIHtcclxuICAgICAgLy8gVXBkYXRlIGV4aXN0aW5nIGRyYWZ0IHRvIHN1Ym1pdHRlZFxyXG4gICAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAgIC5mcm9tKCdxdW90ZXMnKVxyXG4gICAgICAgIC51cGRhdGUoe1xyXG4gICAgICAgICAgc3RhdHVzOiAnc3VibWl0dGVkJyxcclxuICAgICAgICAgIGZvcm1fZGF0YTogZm9ybURhdGEsXHJcbiAgICAgICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgfSlcclxuICAgICAgICAuZXEoJ2lkJywgZXhpc3RpbmdEcmFmdC5pZClcclxuICAgICAgICAuc2VsZWN0KClcclxuICAgICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzdWJtaXR0aW5nIHF1b3RlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9ib29raW5nL3F1b3RlJyk7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGRhdGEgYXMgUXVvdGUgfTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIENyZWF0ZSBuZXcgc3VibWl0dGVkIHF1b3RlXHJcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgICAgLmZyb20oJ3F1b3RlcycpXHJcbiAgICAgICAgLmluc2VydCh7XHJcbiAgICAgICAgICBlbWFpbDogZW1haWwudHJpbSgpLnRvTG93ZXJDYXNlKCksXHJcbiAgICAgICAgICBzdGF0dXM6ICdzdWJtaXR0ZWQnLFxyXG4gICAgICAgICAgZm9ybV9kYXRhOiBmb3JtRGF0YSxcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5zZWxlY3QoKVxyXG4gICAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIHN1Ym1pdHRlZCBxdW90ZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldmFsaWRhdGVQYXRoKCcvYm9va2luZy9xdW90ZScpO1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBkYXRhIGFzIFF1b3RlIH07XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ1VuZXhwZWN0ZWQgZXJyb3Igc3VibWl0dGluZyBxdW90ZTonLCBlcnJvcik7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0FuIHVuZXhwZWN0ZWQgZXJyb3Igb2NjdXJyZWQnLFxyXG4gICAgfTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZXQgYWxsIGFjdGl2ZSBzZXJ2aWNlcyBvcmRlcmVkIGJ5IGRpc3BsYXlfb3JkZXJcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTZXJ2aWNlcygpOiBQcm9taXNlPFNlcnZpY2VbXT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xyXG5cclxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdzZXJ2aWNlcycpXHJcbiAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAuZXEoJ2lzX2FjdGl2ZScsIHRydWUpXHJcbiAgICAgIC5vcmRlcignZGlzcGxheV9vcmRlcicsIHsgYXNjZW5kaW5nOiB0cnVlIH0pO1xyXG5cclxuICAgIGlmIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBzZXJ2aWNlczonLCBlcnJvcik7XHJcbiAgICAgIHJldHVybiBbXTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gKGRhdGEgfHwgW10pIGFzIFNlcnZpY2VbXTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignVW5leHBlY3RlZCBlcnJvciBmZXRjaGluZyBzZXJ2aWNlczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogR2V0IGFkZGl0aW9uYWwgc2VydmljZXMsIG9wdGlvbmFsbHkgZmlsdGVyZWQgYnkgbWFpbiBzZXJ2aWNlXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWRkaXRpb25hbFNlcnZpY2VzKHNlcnZpY2VJZD86IHN0cmluZyk6IFByb21pc2U8QWRkaXRpb25hbFNlcnZpY2VbXT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xyXG5cclxuICAgIGlmIChzZXJ2aWNlSWQpIHtcclxuICAgICAgLy8gR2V0IGFkZGl0aW9uYWwgc2VydmljZXMgZmlsdGVyZWQgYnkgc2VydmljZSBydWxlc1xyXG4gICAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAgIC5mcm9tKCdzZXJ2aWNlX2FkZGl0aW9uYWxfc2VydmljZV9ydWxlcycpXHJcbiAgICAgICAgLnNlbGVjdChgXHJcbiAgICAgICAgICBhZGRpdGlvbmFsX3NlcnZpY2VfaWQsXHJcbiAgICAgICAgICBhZGRpdGlvbmFsX3NlcnZpY2VzOmFkZGl0aW9uYWxfc2VydmljZV9pZCgqKVxyXG4gICAgICAgIGApXHJcbiAgICAgICAgLmVxKCdzZXJ2aWNlX2lkJywgc2VydmljZUlkKTtcclxuXHJcbiAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGFkZGl0aW9uYWwgc2VydmljZXMgYnkgc2VydmljZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBFeHRyYWN0IGFuZCBmb3JtYXQgdGhlIGFkZGl0aW9uYWwgc2VydmljZXNcclxuICAgICAgY29uc3QgYWRkaXRpb25hbFNlcnZpY2VzID0gKGRhdGEgfHwgW10pXHJcbiAgICAgICAgLm1hcCgocnVsZTogYW55KSA9PiBydWxlLmFkZGl0aW9uYWxfc2VydmljZXMpXHJcbiAgICAgICAgLmZpbHRlcigoc2VydmljZTogQWRkaXRpb25hbFNlcnZpY2UpID0+IHNlcnZpY2UgJiYgc2VydmljZS5pc19hY3RpdmUpXHJcbiAgICAgICAgLnNvcnQoKGE6IEFkZGl0aW9uYWxTZXJ2aWNlLCBiOiBBZGRpdGlvbmFsU2VydmljZSkgPT4gYS5kaXNwbGF5X29yZGVyIC0gYi5kaXNwbGF5X29yZGVyKTtcclxuXHJcbiAgICAgIHJldHVybiBhZGRpdGlvbmFsU2VydmljZXMgYXMgQWRkaXRpb25hbFNlcnZpY2VbXTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIEdldCBhbGwgYWN0aXZlIGFkZGl0aW9uYWwgc2VydmljZXNcclxuICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAuZnJvbSgnYWRkaXRpb25hbF9zZXJ2aWNlcycpXHJcbiAgICAgICAgLnNlbGVjdCgnKicpXHJcbiAgICAgICAgLmVxKCdpc19hY3RpdmUnLCB0cnVlKVxyXG4gICAgICAgIC5vcmRlcignZGlzcGxheV9vcmRlcicsIHsgYXNjZW5kaW5nOiB0cnVlIH0pO1xyXG5cclxuICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgYWxsIGFkZGl0aW9uYWwgc2VydmljZXM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiBbXTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIChkYXRhIHx8IFtdKSBhcyBBZGRpdGlvbmFsU2VydmljZVtdO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdVbmV4cGVjdGVkIGVycm9yIGZldGNoaW5nIGFkZGl0aW9uYWwgc2VydmljZXM6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEdldCBob21lIGRldGFpbCBvcHRpb25zIGZvciBhIHNwZWNpZmljIHR5cGUgKGJlZHJvb21zLCBiYXRocm9vbXMsIGNhcnBldF90eXBlLCByb29tX3N0YXR1cylcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRIb21lRGV0YWlsT3B0aW9ucyhvcHRpb25UeXBlOiBzdHJpbmcpOiBQcm9taXNlPEhvbWVEZXRhaWxPcHRpb25bXT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xyXG5cclxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdob21lX2RldGFpbF9vcHRpb25zJylcclxuICAgICAgLnNlbGVjdCgnKicpXHJcbiAgICAgIC5lcSgnb3B0aW9uX3R5cGUnLCBvcHRpb25UeXBlKVxyXG4gICAgICAuZXEoJ2lzX2FjdGl2ZScsIHRydWUpXHJcbiAgICAgIC5vcmRlcignZGlzcGxheV9vcmRlcicsIHsgYXNjZW5kaW5nOiB0cnVlIH0pO1xyXG5cclxuICAgIGlmIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGBFcnJvciBmZXRjaGluZyBob21lIGRldGFpbCBvcHRpb25zIGZvciAke29wdGlvblR5cGV9OmAsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiAoZGF0YSB8fCBbXSkgYXMgSG9tZURldGFpbE9wdGlvbltdO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBVbmV4cGVjdGVkIGVycm9yIGZldGNoaW5nIGhvbWUgZGV0YWlsIG9wdGlvbnMgZm9yICR7b3B0aW9uVHlwZX06YCwgZXJyb3IpO1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEdldCBhbGwgYWN0aXZlIGNsZWFuaW5nIGVxdWlwbWVudCBvcmRlcmVkIGJ5IGRpc3BsYXlfb3JkZXJcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDbGVhbmluZ0VxdWlwbWVudCgpOiBQcm9taXNlPENsZWFuaW5nRXF1aXBtZW50W10+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBhd2FpdCBjcmVhdGVDbGllbnQoKTtcclxuXHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnY2xlYW5pbmdfZXF1aXBtZW50JylcclxuICAgICAgLnNlbGVjdCgnKicpXHJcbiAgICAgIC5lcSgnaXNfYWN0aXZlJywgdHJ1ZSlcclxuICAgICAgLm9yZGVyKCdkaXNwbGF5X29yZGVyJywgeyBhc2NlbmRpbmc6IHRydWUgfSk7XHJcblxyXG4gICAgaWYgKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGNsZWFuaW5nIGVxdWlwbWVudDonLCBlcnJvcik7XHJcbiAgICAgIHJldHVybiBbXTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gKGRhdGEgfHwgW10pIGFzIENsZWFuaW5nRXF1aXBtZW50W107XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ1VuZXhwZWN0ZWQgZXJyb3IgZmV0Y2hpbmcgY2xlYW5pbmcgZXF1aXBtZW50OicsIGVycm9yKTtcclxuICAgIHJldHVybiBbXTtcclxuICB9XHJcbn1cclxuXHJcbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoic1NBd1BzQixrTUFBQSJ9
}),
"[project]/src/components/ui/alert-dialog.tsx [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "AlertDialog",
    ()=>AlertDialog,
    "AlertDialogAction",
    ()=>AlertDialogAction,
    "AlertDialogCancel",
    ()=>AlertDialogCancel,
    "AlertDialogContent",
    ()=>AlertDialogContent,
    "AlertDialogDescription",
    ()=>AlertDialogDescription,
    "AlertDialogFooter",
    ()=>AlertDialogFooter,
    "AlertDialogHeader",
    ()=>AlertDialogHeader,
    "AlertDialogOverlay",
    ()=>AlertDialogOverlay,
    "AlertDialogPortal",
    ()=>AlertDialogPortal,
    "AlertDialogTitle",
    ()=>AlertDialogTitle,
    "AlertDialogTrigger",
    ()=>AlertDialogTrigger
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/jsx-dev-runtime.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/index.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$alert$2d$dialog$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@radix-ui/react-alert-dialog/dist/index.mjs [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/lib/utils.ts [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$button$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/components/ui/button.tsx [app-client] (ecmascript)");
;
;
;
;
;
const AlertDialog = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$alert$2d$dialog$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Root"];
const AlertDialogTrigger = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$alert$2d$dialog$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Trigger"];
const AlertDialogPortal = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$alert$2d$dialog$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Portal"];
const AlertDialogOverlay = /*#__PURE__*/ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["forwardRef"](({ className, ...props }, ref)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$alert$2d$dialog$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Overlay"], {
        className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["cn"])("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0", className),
        ...props,
        ref: ref
    }, void 0, false, {
        fileName: "[project]/src/components/ui/alert-dialog.tsx",
        lineNumber: 17,
        columnNumber: 3
    }, ("TURBOPACK compile-time value", void 0)));
_c = AlertDialogOverlay;
AlertDialogOverlay.displayName = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$alert$2d$dialog$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Overlay"].displayName;
const AlertDialogContent = /*#__PURE__*/ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["forwardRef"](_c1 = ({ className, ...props }, ref)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(AlertDialogPortal, {
        children: [
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(AlertDialogOverlay, {}, void 0, false, {
                fileName: "[project]/src/components/ui/alert-dialog.tsx",
                lineNumber: 33,
                columnNumber: 5
            }, ("TURBOPACK compile-time value", void 0)),
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$alert$2d$dialog$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Content"], {
                ref: ref,
                className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["cn"])("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg", className),
                ...props
            }, void 0, false, {
                fileName: "[project]/src/components/ui/alert-dialog.tsx",
                lineNumber: 34,
                columnNumber: 5
            }, ("TURBOPACK compile-time value", void 0))
        ]
    }, void 0, true, {
        fileName: "[project]/src/components/ui/alert-dialog.tsx",
        lineNumber: 32,
        columnNumber: 3
    }, ("TURBOPACK compile-time value", void 0)));
_c2 = AlertDialogContent;
AlertDialogContent.displayName = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$alert$2d$dialog$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Content"].displayName;
const AlertDialogHeader = ({ className, ...props })=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
        className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["cn"])("flex flex-col space-y-2 text-center sm:text-left", className),
        ...props
    }, void 0, false, {
        fileName: "[project]/src/components/ui/alert-dialog.tsx",
        lineNumber: 47,
        columnNumber: 3
    }, ("TURBOPACK compile-time value", void 0));
_c3 = AlertDialogHeader;
AlertDialogHeader.displayName = "AlertDialogHeader";
const AlertDialogFooter = ({ className, ...props })=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
        className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["cn"])("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2", className),
        ...props
    }, void 0, false, {
        fileName: "[project]/src/components/ui/alert-dialog.tsx",
        lineNumber: 52,
        columnNumber: 3
    }, ("TURBOPACK compile-time value", void 0));
_c4 = AlertDialogFooter;
AlertDialogFooter.displayName = "AlertDialogFooter";
const AlertDialogTitle = /*#__PURE__*/ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["forwardRef"](_c5 = ({ className, ...props }, ref)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$alert$2d$dialog$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Title"], {
        ref: ref,
        className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["cn"])("text-lg font-semibold", className),
        ...props
    }, void 0, false, {
        fileName: "[project]/src/components/ui/alert-dialog.tsx",
        lineNumber: 60,
        columnNumber: 3
    }, ("TURBOPACK compile-time value", void 0)));
_c6 = AlertDialogTitle;
AlertDialogTitle.displayName = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$alert$2d$dialog$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Title"].displayName;
const AlertDialogDescription = /*#__PURE__*/ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["forwardRef"](_c7 = ({ className, ...props }, ref)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$alert$2d$dialog$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Description"], {
        ref: ref,
        className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["cn"])("text-sm text-muted-foreground", className),
        ...props
    }, void 0, false, {
        fileName: "[project]/src/components/ui/alert-dialog.tsx",
        lineNumber: 68,
        columnNumber: 3
    }, ("TURBOPACK compile-time value", void 0)));
_c8 = AlertDialogDescription;
AlertDialogDescription.displayName = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$alert$2d$dialog$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Description"].displayName;
const AlertDialogAction = /*#__PURE__*/ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["forwardRef"](_c9 = ({ className, ...props }, ref)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$alert$2d$dialog$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Action"], {
        ref: ref,
        className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["cn"])((0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$button$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["buttonVariants"])(), className),
        ...props
    }, void 0, false, {
        fileName: "[project]/src/components/ui/alert-dialog.tsx",
        lineNumber: 76,
        columnNumber: 3
    }, ("TURBOPACK compile-time value", void 0)));
_c10 = AlertDialogAction;
AlertDialogAction.displayName = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$alert$2d$dialog$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Action"].displayName;
const AlertDialogCancel = /*#__PURE__*/ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["forwardRef"](_c11 = ({ className, ...props }, ref)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$alert$2d$dialog$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Cancel"], {
        ref: ref,
        className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["cn"])((0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$button$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["buttonVariants"])({
            variant: "outline"
        }), "mt-2 sm:mt-0", className),
        ...props
    }, void 0, false, {
        fileName: "[project]/src/components/ui/alert-dialog.tsx",
        lineNumber: 84,
        columnNumber: 3
    }, ("TURBOPACK compile-time value", void 0)));
_c12 = AlertDialogCancel;
AlertDialogCancel.displayName = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$alert$2d$dialog$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Cancel"].displayName;
;
var _c, _c1, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c10, _c11, _c12;
__turbopack_context__.k.register(_c, "AlertDialogOverlay");
__turbopack_context__.k.register(_c1, "AlertDialogContent$React.forwardRef");
__turbopack_context__.k.register(_c2, "AlertDialogContent");
__turbopack_context__.k.register(_c3, "AlertDialogHeader");
__turbopack_context__.k.register(_c4, "AlertDialogFooter");
__turbopack_context__.k.register(_c5, "AlertDialogTitle$React.forwardRef");
__turbopack_context__.k.register(_c6, "AlertDialogTitle");
__turbopack_context__.k.register(_c7, "AlertDialogDescription$React.forwardRef");
__turbopack_context__.k.register(_c8, "AlertDialogDescription");
__turbopack_context__.k.register(_c9, "AlertDialogAction$React.forwardRef");
__turbopack_context__.k.register(_c10, "AlertDialogAction");
__turbopack_context__.k.register(_c11, "AlertDialogCancel$React.forwardRef");
__turbopack_context__.k.register(_c12, "AlertDialogCancel");
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
}),
"[project]/app/cleaner/components/BookingStatusButton.tsx [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "BookingStatusButton",
    ()=>BookingStatusButton
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/jsx-dev-runtime.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/index.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$button$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/components/ui/button.tsx [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$loader$2d$circle$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__default__as__Loader2$3e$__ = __turbopack_context__.i("[project]/node_modules/lucide-react/dist/esm/icons/loader-circle.js [app-client] (ecmascript) <export default as Loader2>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$sonner$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/sonner/dist/index.mjs [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$alert$2d$dialog$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/components/ui/alert-dialog.tsx [app-client] (ecmascript)");
;
var _s = __turbopack_context__.k.signature();
'use client';
;
;
;
;
;
function BookingStatusButton({ booking, onStatusUpdate }) {
    _s();
    const [isUpdating, setIsUpdating] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])(false);
    const [confirmDialog, setConfirmDialog] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])({
        open: false,
        newStatus: null
    });
    const updateStatus = async (newStatus)=>{
        setIsUpdating(true);
        try {
            const response = await fetch('/api/cleaner/update-booking-status', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    bookingId: booking.id,
                    status: newStatus
                })
            });
            const result = await response.json();
            if (!response.ok || !result.success) {
                throw new Error(result.error || 'Failed to update booking status');
            }
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$sonner$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["toast"].success(`Booking status updated to ${newStatus.replace('_', ' ')}`);
            onStatusUpdate(result.booking);
            setConfirmDialog({
                open: false,
                newStatus: null
            });
        } catch (error) {
            console.error('Error updating booking status:', error);
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$sonner$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["toast"].error(error instanceof Error ? error.message : 'Failed to update booking status');
        } finally{
            setIsUpdating(false);
        }
    };
    const handleStatusClick = (newStatus)=>{
        // Show confirmation for critical actions
        if (newStatus === 'cancelled' || newStatus === 'completed') {
            setConfirmDialog({
                open: true,
                newStatus
            });
        } else {
            updateStatus(newStatus);
        }
    };
    const getAvailableActions = ()=>{
        const actions = [];
        switch(booking.status){
            case 'pending':
                actions.push({
                    status: 'confirmed',
                    label: 'Confirm',
                    variant: 'default'
                });
                actions.push({
                    status: 'cancelled',
                    label: 'Cancel',
                    variant: 'destructive'
                });
                break;
            case 'confirmed':
                actions.push({
                    status: 'on_my_way',
                    label: 'On My Way',
                    variant: 'default'
                });
                actions.push({
                    status: 'cancelled',
                    label: 'Cancel',
                    variant: 'destructive'
                });
                break;
            case 'on_my_way':
                actions.push({
                    status: 'started',
                    label: 'Start Work',
                    variant: 'default'
                });
                actions.push({
                    status: 'cancelled',
                    label: 'Cancel',
                    variant: 'destructive'
                });
                break;
            case 'started':
                actions.push({
                    status: 'completed',
                    label: 'Complete',
                    variant: 'default'
                });
                break;
            case 'completed':
            case 'cancelled':
                break;
        }
        return actions;
    };
    const availableActions = getAvailableActions();
    if (availableActions.length === 0) {
        return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
            className: "text-sm text-muted-foreground",
            children: [
                "Status: ",
                booking.status.replace('_', ' ').replace(/\b\w/g, (l)=>l.toUpperCase())
            ]
        }, void 0, true, {
            fileName: "[project]/app/cleaner/components/BookingStatusButton.tsx",
            lineNumber: 104,
            columnNumber: 7
        }, this);
    }
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Fragment"], {
        children: [
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                className: "flex flex-wrap gap-2",
                children: availableActions.map((action)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$button$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Button"], {
                        variant: action.variant || 'outline',
                        size: "sm",
                        onClick: ()=>handleStatusClick(action.status),
                        disabled: isUpdating,
                        children: isUpdating ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Fragment"], {
                            children: [
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$loader$2d$circle$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__default__as__Loader2$3e$__["Loader2"], {
                                    className: "mr-2 h-4 w-4 animate-spin"
                                }, void 0, false, {
                                    fileName: "[project]/app/cleaner/components/BookingStatusButton.tsx",
                                    lineNumber: 123,
                                    columnNumber: 17
                                }, this),
                                "Updating..."
                            ]
                        }, void 0, true) : action.label
                    }, action.status, false, {
                        fileName: "[project]/app/cleaner/components/BookingStatusButton.tsx",
                        lineNumber: 114,
                        columnNumber: 11
                    }, this))
            }, void 0, false, {
                fileName: "[project]/app/cleaner/components/BookingStatusButton.tsx",
                lineNumber: 112,
                columnNumber: 7
            }, this),
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$alert$2d$dialog$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["AlertDialog"], {
                open: confirmDialog.open,
                onOpenChange: (open)=>setConfirmDialog({
                        open,
                        newStatus: null
                    }),
                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$alert$2d$dialog$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["AlertDialogContent"], {
                    children: [
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$alert$2d$dialog$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["AlertDialogHeader"], {
                            children: [
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$alert$2d$dialog$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["AlertDialogTitle"], {
                                    children: "Confirm Action"
                                }, void 0, false, {
                                    fileName: "[project]/app/cleaner/components/BookingStatusButton.tsx",
                                    lineNumber: 136,
                                    columnNumber: 13
                                }, this),
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$alert$2d$dialog$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["AlertDialogDescription"], {
                                    children: confirmDialog.newStatus === 'completed' ? 'Are you sure you want to mark this booking as completed? This action cannot be undone.' : 'Are you sure you want to cancel this booking? This action should only be used in exceptional circumstances.'
                                }, void 0, false, {
                                    fileName: "[project]/app/cleaner/components/BookingStatusButton.tsx",
                                    lineNumber: 137,
                                    columnNumber: 13
                                }, this)
                            ]
                        }, void 0, true, {
                            fileName: "[project]/app/cleaner/components/BookingStatusButton.tsx",
                            lineNumber: 135,
                            columnNumber: 11
                        }, this),
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$alert$2d$dialog$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["AlertDialogFooter"], {
                            children: [
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$alert$2d$dialog$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["AlertDialogCancel"], {
                                    disabled: isUpdating,
                                    children: "Cancel"
                                }, void 0, false, {
                                    fileName: "[project]/app/cleaner/components/BookingStatusButton.tsx",
                                    lineNumber: 144,
                                    columnNumber: 13
                                }, this),
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$alert$2d$dialog$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["AlertDialogAction"], {
                                    onClick: ()=>confirmDialog.newStatus && updateStatus(confirmDialog.newStatus),
                                    disabled: isUpdating,
                                    className: confirmDialog.newStatus === 'cancelled' ? 'bg-destructive text-destructive-foreground hover:bg-destructive/90' : '',
                                    children: isUpdating ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Fragment"], {
                                        children: [
                                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$loader$2d$circle$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__default__as__Loader2$3e$__["Loader2"], {
                                                className: "mr-2 h-4 w-4 animate-spin"
                                            }, void 0, false, {
                                                fileName: "[project]/app/cleaner/components/BookingStatusButton.tsx",
                                                lineNumber: 152,
                                                columnNumber: 19
                                            }, this),
                                            "Processing..."
                                        ]
                                    }, void 0, true) : 'Confirm'
                                }, void 0, false, {
                                    fileName: "[project]/app/cleaner/components/BookingStatusButton.tsx",
                                    lineNumber: 145,
                                    columnNumber: 13
                                }, this)
                            ]
                        }, void 0, true, {
                            fileName: "[project]/app/cleaner/components/BookingStatusButton.tsx",
                            lineNumber: 143,
                            columnNumber: 11
                        }, this)
                    ]
                }, void 0, true, {
                    fileName: "[project]/app/cleaner/components/BookingStatusButton.tsx",
                    lineNumber: 134,
                    columnNumber: 9
                }, this)
            }, void 0, false, {
                fileName: "[project]/app/cleaner/components/BookingStatusButton.tsx",
                lineNumber: 133,
                columnNumber: 7
            }, this)
        ]
    }, void 0, true);
}
_s(BookingStatusButton, "HfFp7i32HrXg2v5PO2LBXhZoqkA=");
_c = BookingStatusButton;
var _c;
__turbopack_context__.k.register(_c, "BookingStatusButton");
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
}),
"[project]/src/components/ui/dialog.tsx [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Dialog",
    ()=>Dialog,
    "DialogClose",
    ()=>DialogClose,
    "DialogContent",
    ()=>DialogContent,
    "DialogDescription",
    ()=>DialogDescription,
    "DialogFooter",
    ()=>DialogFooter,
    "DialogHeader",
    ()=>DialogHeader,
    "DialogOverlay",
    ()=>DialogOverlay,
    "DialogPortal",
    ()=>DialogPortal,
    "DialogTitle",
    ()=>DialogTitle,
    "DialogTrigger",
    ()=>DialogTrigger
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/jsx-dev-runtime.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/index.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$dialog$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@radix-ui/react-dialog/dist/index.mjs [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$x$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__default__as__X$3e$__ = __turbopack_context__.i("[project]/node_modules/lucide-react/dist/esm/icons/x.js [app-client] (ecmascript) <export default as X>");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/lib/utils.ts [app-client] (ecmascript)");
;
;
;
;
;
const Dialog = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$dialog$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Root"];
const DialogTrigger = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$dialog$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Trigger"];
const DialogPortal = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$dialog$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Portal"];
const DialogClose = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$dialog$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Close"];
const DialogOverlay = /*#__PURE__*/ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["forwardRef"](({ className, ...props }, ref)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$dialog$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Overlay"], {
        ref: ref,
        className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["cn"])("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0", className),
        ...props
    }, void 0, false, {
        fileName: "[project]/src/components/ui/dialog.tsx",
        lineNumber: 19,
        columnNumber: 3
    }, ("TURBOPACK compile-time value", void 0)));
_c = DialogOverlay;
DialogOverlay.displayName = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$dialog$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Overlay"].displayName;
const DialogContent = /*#__PURE__*/ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["forwardRef"](_c1 = ({ className, children, ...props }, ref)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(DialogPortal, {
        children: [
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(DialogOverlay, {}, void 0, false, {
                fileName: "[project]/src/components/ui/dialog.tsx",
                lineNumber: 35,
                columnNumber: 5
            }, ("TURBOPACK compile-time value", void 0)),
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$dialog$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Content"], {
                ref: ref,
                className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["cn"])("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg", className),
                ...props,
                children: [
                    children,
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$dialog$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Close"], {
                        className: "absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",
                        children: [
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$x$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__default__as__X$3e$__["X"], {
                                className: "h-4 w-4"
                            }, void 0, false, {
                                fileName: "[project]/src/components/ui/dialog.tsx",
                                lineNumber: 46,
                                columnNumber: 9
                            }, ("TURBOPACK compile-time value", void 0)),
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                                className: "sr-only",
                                children: "Close"
                            }, void 0, false, {
                                fileName: "[project]/src/components/ui/dialog.tsx",
                                lineNumber: 47,
                                columnNumber: 9
                            }, ("TURBOPACK compile-time value", void 0))
                        ]
                    }, void 0, true, {
                        fileName: "[project]/src/components/ui/dialog.tsx",
                        lineNumber: 45,
                        columnNumber: 7
                    }, ("TURBOPACK compile-time value", void 0))
                ]
            }, void 0, true, {
                fileName: "[project]/src/components/ui/dialog.tsx",
                lineNumber: 36,
                columnNumber: 5
            }, ("TURBOPACK compile-time value", void 0))
        ]
    }, void 0, true, {
        fileName: "[project]/src/components/ui/dialog.tsx",
        lineNumber: 34,
        columnNumber: 3
    }, ("TURBOPACK compile-time value", void 0)));
_c2 = DialogContent;
DialogContent.displayName = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$dialog$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Content"].displayName;
const DialogHeader = ({ className, ...props })=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
        className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["cn"])("flex flex-col space-y-1.5 text-center sm:text-left", className),
        ...props
    }, void 0, false, {
        fileName: "[project]/src/components/ui/dialog.tsx",
        lineNumber: 55,
        columnNumber: 3
    }, ("TURBOPACK compile-time value", void 0));
_c3 = DialogHeader;
DialogHeader.displayName = "DialogHeader";
const DialogFooter = ({ className, ...props })=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
        className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["cn"])("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2", className),
        ...props
    }, void 0, false, {
        fileName: "[project]/src/components/ui/dialog.tsx",
        lineNumber: 60,
        columnNumber: 3
    }, ("TURBOPACK compile-time value", void 0));
_c4 = DialogFooter;
DialogFooter.displayName = "DialogFooter";
const DialogTitle = /*#__PURE__*/ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["forwardRef"](_c5 = ({ className, ...props }, ref)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$dialog$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Title"], {
        ref: ref,
        className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["cn"])("text-lg font-semibold leading-none tracking-tight", className),
        ...props
    }, void 0, false, {
        fileName: "[project]/src/components/ui/dialog.tsx",
        lineNumber: 68,
        columnNumber: 3
    }, ("TURBOPACK compile-time value", void 0)));
_c6 = DialogTitle;
DialogTitle.displayName = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$dialog$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Title"].displayName;
const DialogDescription = /*#__PURE__*/ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["forwardRef"](_c7 = ({ className, ...props }, ref)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$dialog$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Description"], {
        ref: ref,
        className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["cn"])("text-sm text-muted-foreground", className),
        ...props
    }, void 0, false, {
        fileName: "[project]/src/components/ui/dialog.tsx",
        lineNumber: 80,
        columnNumber: 3
    }, ("TURBOPACK compile-time value", void 0)));
_c8 = DialogDescription;
DialogDescription.displayName = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$dialog$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Description"].displayName;
;
var _c, _c1, _c2, _c3, _c4, _c5, _c6, _c7, _c8;
__turbopack_context__.k.register(_c, "DialogOverlay");
__turbopack_context__.k.register(_c1, "DialogContent$React.forwardRef");
__turbopack_context__.k.register(_c2, "DialogContent");
__turbopack_context__.k.register(_c3, "DialogHeader");
__turbopack_context__.k.register(_c4, "DialogFooter");
__turbopack_context__.k.register(_c5, "DialogTitle$React.forwardRef");
__turbopack_context__.k.register(_c6, "DialogTitle");
__turbopack_context__.k.register(_c7, "DialogDescription$React.forwardRef");
__turbopack_context__.k.register(_c8, "DialogDescription");
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
}),
"[project]/src/components/ui/label.tsx [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Label",
    ()=>Label
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/jsx-dev-runtime.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/index.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$label$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@radix-ui/react-label/dist/index.mjs [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$class$2d$variance$2d$authority$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/class-variance-authority/dist/index.mjs [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/lib/utils.ts [app-client] (ecmascript)");
;
;
;
;
;
const labelVariants = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$class$2d$variance$2d$authority$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["cva"])("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70");
const Label = /*#__PURE__*/ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["forwardRef"](_c = ({ className, ...props }, ref)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$label$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Root"], {
        ref: ref,
        className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["cn"])(labelVariants(), className),
        ...props
    }, void 0, false, {
        fileName: "[project]/src/components/ui/label.tsx",
        lineNumber: 13,
        columnNumber: 3
    }, ("TURBOPACK compile-time value", void 0)));
_c1 = Label;
Label.displayName = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$label$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Root"].displayName;
;
var _c, _c1;
__turbopack_context__.k.register(_c, "Label$React.forwardRef");
__turbopack_context__.k.register(_c1, "Label");
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
}),
"[project]/src/components/ui/textarea.tsx [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Textarea",
    ()=>Textarea
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/jsx-dev-runtime.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/index.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/lib/utils.ts [app-client] (ecmascript)");
;
;
;
const Textarea = /*#__PURE__*/ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["forwardRef"](_c = ({ className, ...props }, ref)=>{
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("textarea", {
        className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["cn"])("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50", className),
        ref: ref,
        ...props
    }, void 0, false, {
        fileName: "[project]/src/components/ui/textarea.tsx",
        lineNumber: 9,
        columnNumber: 5
    }, ("TURBOPACK compile-time value", void 0));
});
_c1 = Textarea;
Textarea.displayName = "Textarea";
;
var _c, _c1;
__turbopack_context__.k.register(_c, "Textarea$React.forwardRef");
__turbopack_context__.k.register(_c1, "Textarea");
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
}),
"[project]/app/cleaner/components/LatenessReportModal.tsx [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "LatenessReportModal",
    ()=>LatenessReportModal
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/jsx-dev-runtime.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/index.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$dialog$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/components/ui/dialog.tsx [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$button$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/components/ui/button.tsx [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$label$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/components/ui/label.tsx [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$input$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/components/ui/input.tsx [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$textarea$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/components/ui/textarea.tsx [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$loader$2d$circle$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__default__as__Loader2$3e$__ = __turbopack_context__.i("[project]/node_modules/lucide-react/dist/esm/icons/loader-circle.js [app-client] (ecmascript) <export default as Loader2>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$sonner$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/sonner/dist/index.mjs [app-client] (ecmascript)");
;
var _s = __turbopack_context__.k.signature();
'use client';
;
;
;
;
;
;
;
;
function LatenessReportModal({ open, onOpenChange, bookingId, onSuccess }) {
    _s();
    const [expectedArrivalTime, setExpectedArrivalTime] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])('');
    const [expectedArrivalDate, setExpectedArrivalDate] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])('');
    const [reason, setReason] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])('');
    const [isSubmitting, setIsSubmitting] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])(false);
    const handleSubmit = async (e)=>{
        e.preventDefault();
        if (!expectedArrivalDate || !expectedArrivalTime) {
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$sonner$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["toast"].error('Please provide both date and time');
            return;
        }
        if (!reason.trim()) {
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$sonner$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["toast"].error('Please provide a reason for the delay');
            return;
        }
        setIsSubmitting(true);
        try {
            // Combine date and time into ISO timestamp
            const expectedArrival = new Date(`${expectedArrivalDate}T${expectedArrivalTime}`).toISOString();
            const response = await fetch('/api/cleaner/report-lateness', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    bookingId,
                    expectedArrivalTime: expectedArrival,
                    reason: reason.trim()
                })
            });
            const result = await response.json();
            if (!response.ok || !result.success) {
                throw new Error(result.error || 'Failed to report lateness');
            }
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$sonner$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["toast"].success('Lateness reported successfully');
            onSuccess();
            onOpenChange(false);
            // Reset form
            setExpectedArrivalDate('');
            setExpectedArrivalTime('');
            setReason('');
        } catch (error) {
            console.error('Error reporting lateness:', error);
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$sonner$2f$dist$2f$index$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__["toast"].error(error instanceof Error ? error.message : 'Failed to report lateness');
        } finally{
            setIsSubmitting(false);
        }
    };
    // Set default date to today
    const today = new Date().toISOString().split('T')[0];
    if (!expectedArrivalDate) {
        setExpectedArrivalDate(today);
    }
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$dialog$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Dialog"], {
        open: open,
        onOpenChange: onOpenChange,
        children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$dialog$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DialogContent"], {
            children: [
                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$dialog$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DialogHeader"], {
                    children: [
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$dialog$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DialogTitle"], {
                            children: "Report Lateness"
                        }, void 0, false, {
                            fileName: "[project]/app/cleaner/components/LatenessReportModal.tsx",
                            lineNumber: 99,
                            columnNumber: 11
                        }, this),
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$dialog$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DialogDescription"], {
                            children: "Inform the customer about your expected arrival time and reason for delay."
                        }, void 0, false, {
                            fileName: "[project]/app/cleaner/components/LatenessReportModal.tsx",
                            lineNumber: 100,
                            columnNumber: 11
                        }, this)
                    ]
                }, void 0, true, {
                    fileName: "[project]/app/cleaner/components/LatenessReportModal.tsx",
                    lineNumber: 98,
                    columnNumber: 9
                }, this),
                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("form", {
                    onSubmit: handleSubmit,
                    className: "space-y-4",
                    children: [
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                            className: "grid grid-cols-2 gap-4",
                            children: [
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                    className: "space-y-2",
                                    children: [
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$label$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Label"], {
                                            htmlFor: "arrival-date",
                                            children: "Expected Arrival Date"
                                        }, void 0, false, {
                                            fileName: "[project]/app/cleaner/components/LatenessReportModal.tsx",
                                            lineNumber: 107,
                                            columnNumber: 15
                                        }, this),
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$input$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Input"], {
                                            id: "arrival-date",
                                            type: "date",
                                            value: expectedArrivalDate,
                                            onChange: (e)=>setExpectedArrivalDate(e.target.value),
                                            min: today,
                                            required: true,
                                            disabled: isSubmitting
                                        }, void 0, false, {
                                            fileName: "[project]/app/cleaner/components/LatenessReportModal.tsx",
                                            lineNumber: 108,
                                            columnNumber: 15
                                        }, this)
                                    ]
                                }, void 0, true, {
                                    fileName: "[project]/app/cleaner/components/LatenessReportModal.tsx",
                                    lineNumber: 106,
                                    columnNumber: 13
                                }, this),
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                    className: "space-y-2",
                                    children: [
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$label$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Label"], {
                                            htmlFor: "arrival-time",
                                            children: "Expected Arrival Time"
                                        }, void 0, false, {
                                            fileName: "[project]/app/cleaner/components/LatenessReportModal.tsx",
                                            lineNumber: 119,
                                            columnNumber: 15
                                        }, this),
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$input$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Input"], {
                                            id: "arrival-time",
                                            type: "time",
                                            value: expectedArrivalTime,
                                            onChange: (e)=>setExpectedArrivalTime(e.target.value),
                                            required: true,
                                            disabled: isSubmitting
                                        }, void 0, false, {
                                            fileName: "[project]/app/cleaner/components/LatenessReportModal.tsx",
                                            lineNumber: 120,
                                            columnNumber: 15
                                        }, this)
                                    ]
                                }, void 0, true, {
                                    fileName: "[project]/app/cleaner/components/LatenessReportModal.tsx",
                                    lineNumber: 118,
                                    columnNumber: 13
                                }, this)
                            ]
                        }, void 0, true, {
                            fileName: "[project]/app/cleaner/components/LatenessReportModal.tsx",
                            lineNumber: 105,
                            columnNumber: 11
                        }, this),
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                            className: "space-y-2",
                            children: [
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$label$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Label"], {
                                    htmlFor: "reason",
                                    children: "Reason for Delay"
                                }, void 0, false, {
                                    fileName: "[project]/app/cleaner/components/LatenessReportModal.tsx",
                                    lineNumber: 131,
                                    columnNumber: 13
                                }, this),
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$textarea$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Textarea"], {
                                    id: "reason",
                                    placeholder: "Explain why you will be late (e.g., traffic, previous booking ran over, etc.)",
                                    value: reason,
                                    onChange: (e)=>setReason(e.target.value),
                                    rows: 4,
                                    required: true,
                                    disabled: isSubmitting
                                }, void 0, false, {
                                    fileName: "[project]/app/cleaner/components/LatenessReportModal.tsx",
                                    lineNumber: 132,
                                    columnNumber: 13
                                }, this)
                            ]
                        }, void 0, true, {
                            fileName: "[project]/app/cleaner/components/LatenessReportModal.tsx",
                            lineNumber: 130,
                            columnNumber: 11
                        }, this),
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$dialog$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["DialogFooter"], {
                            children: [
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$button$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Button"], {
                                    type: "button",
                                    variant: "outline",
                                    onClick: ()=>onOpenChange(false),
                                    disabled: isSubmitting,
                                    children: "Cancel"
                                }, void 0, false, {
                                    fileName: "[project]/app/cleaner/components/LatenessReportModal.tsx",
                                    lineNumber: 143,
                                    columnNumber: 13
                                }, this),
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$button$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Button"], {
                                    type: "submit",
                                    disabled: isSubmitting,
                                    children: isSubmitting ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Fragment"], {
                                        children: [
                                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$loader$2d$circle$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__default__as__Loader2$3e$__["Loader2"], {
                                                className: "mr-2 h-4 w-4 animate-spin"
                                            }, void 0, false, {
                                                fileName: "[project]/app/cleaner/components/LatenessReportModal.tsx",
                                                lineNumber: 154,
                                                columnNumber: 19
                                            }, this),
                                            "Submitting..."
                                        ]
                                    }, void 0, true) : 'Report Lateness'
                                }, void 0, false, {
                                    fileName: "[project]/app/cleaner/components/LatenessReportModal.tsx",
                                    lineNumber: 151,
                                    columnNumber: 13
                                }, this)
                            ]
                        }, void 0, true, {
                            fileName: "[project]/app/cleaner/components/LatenessReportModal.tsx",
                            lineNumber: 142,
                            columnNumber: 11
                        }, this)
                    ]
                }, void 0, true, {
                    fileName: "[project]/app/cleaner/components/LatenessReportModal.tsx",
                    lineNumber: 104,
                    columnNumber: 9
                }, this)
            ]
        }, void 0, true, {
            fileName: "[project]/app/cleaner/components/LatenessReportModal.tsx",
            lineNumber: 97,
            columnNumber: 7
        }, this)
    }, void 0, false, {
        fileName: "[project]/app/cleaner/components/LatenessReportModal.tsx",
        lineNumber: 96,
        columnNumber: 5
    }, this);
}
_s(LatenessReportModal, "yxJ1DkD5kQ0WdinHggy0NNBlsqo=");
_c = LatenessReportModal;
var _c;
__turbopack_context__.k.register(_c, "LatenessReportModal");
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
}),
"[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "default",
    ()=>CleanerBookingDetailsPage
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/jsx-dev-runtime.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/index.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$navigation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/navigation.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$tanstack$2f$react$2d$query$2f$build$2f$modern$2f$useQuery$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@tanstack/react-query/build/modern/useQuery.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$loader$2d$circle$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__default__as__Loader2$3e$__ = __turbopack_context__.i("[project]/node_modules/lucide-react/dist/esm/icons/loader-circle.js [app-client] (ecmascript) <export default as Loader2>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$calendar$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__default__as__Calendar$3e$__ = __turbopack_context__.i("[project]/node_modules/lucide-react/dist/esm/icons/calendar.js [app-client] (ecmascript) <export default as Calendar>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$map$2d$pin$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__default__as__MapPin$3e$__ = __turbopack_context__.i("[project]/node_modules/lucide-react/dist/esm/icons/map-pin.js [app-client] (ecmascript) <export default as MapPin>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$phone$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__default__as__Phone$3e$__ = __turbopack_context__.i("[project]/node_modules/lucide-react/dist/esm/icons/phone.js [app-client] (ecmascript) <export default as Phone>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$user$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__default__as__User$3e$__ = __turbopack_context__.i("[project]/node_modules/lucide-react/dist/esm/icons/user.js [app-client] (ecmascript) <export default as User>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$arrow$2d$left$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__default__as__ArrowLeft$3e$__ = __turbopack_context__.i("[project]/node_modules/lucide-react/dist/esm/icons/arrow-left.js [app-client] (ecmascript) <export default as ArrowLeft>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$circle$2d$alert$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__default__as__AlertCircle$3e$__ = __turbopack_context__.i("[project]/node_modules/lucide-react/dist/esm/icons/circle-alert.js [app-client] (ecmascript) <export default as AlertCircle>");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$button$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/components/ui/button.tsx [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$badge$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/components/ui/badge.tsx [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$card$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/components/ui/card.tsx [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$cleaner$2f$data$3a$d80850__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$text$2f$javascript$3e$__ = __turbopack_context__.i("[project]/app/cleaner/data:d80850 [app-client] (ecmascript) <text/javascript>");
var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$cleaner$2f$data$3a$126878__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$text$2f$javascript$3e$__ = __turbopack_context__.i("[project]/app/cleaner/data:126878 [app-client] (ecmascript) <text/javascript>");
var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$cleaner$2f$data$3a$a563e4__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$text$2f$javascript$3e$__ = __turbopack_context__.i("[project]/app/cleaner/data:a563e4 [app-client] (ecmascript) <text/javascript>");
var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$booking$2f$quote$2f$data$3a$c40742__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$text$2f$javascript$3e$__ = __turbopack_context__.i("[project]/app/booking/quote/data:c40742 [app-client] (ecmascript) <text/javascript>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$date$2d$fns$2f$format$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/date-fns/format.mjs [app-client] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$cleaner$2f$components$2f$BookingStatusButton$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/app/cleaner/components/BookingStatusButton.tsx [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$cleaner$2f$components$2f$LatenessReportModal$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/app/cleaner/components/LatenessReportModal.tsx [app-client] (ecmascript)");
;
var _s = __turbopack_context__.k.signature();
'use client';
;
;
;
;
;
;
;
;
;
;
;
;
function CleanerBookingDetailsPage() {
    _s();
    const params = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$navigation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useParams"])();
    const router = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$navigation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useRouter"])();
    const bookingId = params.id;
    const [booking, setBooking] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])(null);
    const [cleaner, setCleaner] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])(null);
    const [loading, setLoading] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])(true);
    const [error, setError] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])(null);
    const [latenessModalOpen, setLatenessModalOpen] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])(false);
    const [earnings, setEarnings] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])(null);
    // Get current cleaner
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$tanstack$2f$react$2d$query$2f$build$2f$modern$2f$useQuery$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useQuery"])({
        queryKey: [
            'current-cleaner'
        ],
        queryFn: {
            "CleanerBookingDetailsPage.useQuery": async ()=>{
                const result = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$cleaner$2f$data$3a$d80850__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$text$2f$javascript$3e$__["getCurrentCleaner"])();
                if (result.success && result.cleaner) {
                    setCleaner(result.cleaner);
                    return result.cleaner;
                }
                return null;
            }
        }["CleanerBookingDetailsPage.useQuery"],
        staleTime: 5 * 60 * 1000
    });
    // Fetch all additional services to map IDs to names
    const { data: additionalServices = [] } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$tanstack$2f$react$2d$query$2f$build$2f$modern$2f$useQuery$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useQuery"])({
        queryKey: [
            'additional-services'
        ],
        queryFn: {
            "CleanerBookingDetailsPage.useQuery": ()=>(0, __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$booking$2f$quote$2f$data$3a$c40742__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$text$2f$javascript$3e$__["getAdditionalServices"])()
        }["CleanerBookingDetailsPage.useQuery"],
        staleTime: 5 * 60 * 1000
    });
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useEffect"])({
        "CleanerBookingDetailsPage.useEffect": ()=>{
            if (bookingId) {
                Promise.all([
                    (0, __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$cleaner$2f$data$3a$126878__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$text$2f$javascript$3e$__["getCleanerBookingById"])(bookingId),
                    (0, __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$cleaner$2f$data$3a$a563e4__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$text$2f$javascript$3e$__["calculateBookingEarnings"])(bookingId)
                ]).then({
                    "CleanerBookingDetailsPage.useEffect": ([bookingResult, earningsResult])=>{
                        if (bookingResult.success && bookingResult.booking) {
                            setBooking(bookingResult.booking);
                            setError(null);
                        } else {
                            setError(bookingResult.error || 'Booking not found or unauthorized');
                        }
                        if (earningsResult.success && earningsResult.earnings) {
                            setEarnings(earningsResult.earnings);
                        }
                        setLoading(false);
                    }
                }["CleanerBookingDetailsPage.useEffect"]);
            }
        }
    }["CleanerBookingDetailsPage.useEffect"], [
        bookingId
    ]);
    const handleStatusUpdate = (updatedBooking)=>{
        setBooking(updatedBooking);
    };
    if (loading) {
        return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
            className: "flex items-center justify-center py-8 sm:py-12",
            children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$loader$2d$circle$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__default__as__Loader2$3e$__["Loader2"], {
                className: "w-6 h-6 sm:w-8 sm:h-8 animate-spin text-primary"
            }, void 0, false, {
                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                lineNumber: 86,
                columnNumber: 9
            }, this)
        }, void 0, false, {
            fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
            lineNumber: 85,
            columnNumber: 7
        }, this);
    }
    if (error || !booking) {
        const isUnauthorized = error?.toLowerCase().includes('unauthorized');
        return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
            className: "flex items-center justify-center py-8 sm:py-12 px-4",
            children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                className: "text-center max-w-md",
                children: [
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("h1", {
                        className: "text-xl sm:text-2xl font-bold mb-3 sm:mb-4",
                        children: isUnauthorized ? 'Access Denied' : 'Booking Not Found'
                    }, void 0, false, {
                        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                        lineNumber: 96,
                        columnNumber: 11
                    }, this),
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                        className: "text-sm sm:text-base text-muted-foreground mb-4",
                        children: error || 'The booking you are looking for does not exist or you are not authorized to view it.'
                    }, void 0, false, {
                        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                        lineNumber: 99,
                        columnNumber: 11
                    }, this),
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$button$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Button"], {
                        onClick: ()=>router.push('/cleaner/bookings'),
                        className: "w-full sm:w-auto text-xs sm:text-sm h-9 sm:h-10",
                        children: [
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$arrow$2d$left$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__default__as__ArrowLeft$3e$__["ArrowLeft"], {
                                className: "w-3.5 h-3.5 sm:w-4 sm:h-4 mr-1.5 sm:mr-2"
                            }, void 0, false, {
                                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                lineNumber: 103,
                                columnNumber: 13
                            }, this),
                            "Back to Bookings"
                        ]
                    }, void 0, true, {
                        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                        lineNumber: 102,
                        columnNumber: 11
                    }, this)
                ]
            }, void 0, true, {
                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                lineNumber: 95,
                columnNumber: 9
            }, this)
        }, void 0, false, {
            fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
            lineNumber: 94,
            columnNumber: 7
        }, this);
    }
    const statusColors = {
        pending: 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400',
        confirmed: 'bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400',
        on_my_way: 'bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-400',
        started: 'bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-400',
        completed: 'bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400',
        cancelled: 'bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400'
    };
    const paymentColors = {
        pending: 'bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400',
        paid: 'bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400',
        failed: 'bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400',
        refunded: 'bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-400'
    };
    const statusLabel = booking.status.replace('_', ' ').replace(/\b\w/g, (l)=>l.toUpperCase());
    const canReportLateness = [
        'confirmed',
        'on_my_way'
    ].includes(booking.status);
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
        className: "space-y-4 sm:space-y-6 w-full max-w-full overflow-x-hidden",
        children: [
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                className: "flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3 sm:gap-4",
                children: [
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                        className: "flex-1 min-w-0",
                        children: [
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$button$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Button"], {
                                variant: "ghost",
                                onClick: ()=>router.push('/cleaner/bookings'),
                                className: "mb-2 sm:mb-4 h-8 sm:h-10 text-xs sm:text-sm px-2 sm:px-4",
                                children: [
                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$arrow$2d$left$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__default__as__ArrowLeft$3e$__["ArrowLeft"], {
                                        className: "w-3.5 h-3.5 sm:w-4 sm:h-4 mr-1.5 sm:mr-2"
                                    }, void 0, false, {
                                        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                        lineNumber: 140,
                                        columnNumber: 13
                                    }, this),
                                    "Back to Bookings"
                                ]
                            }, void 0, true, {
                                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                lineNumber: 135,
                                columnNumber: 11
                            }, this),
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("h1", {
                                className: "text-2xl sm:text-3xl md:text-4xl font-bold",
                                children: "Booking Details"
                            }, void 0, false, {
                                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                lineNumber: 143,
                                columnNumber: 11
                            }, this),
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                className: "text-sm sm:text-base text-muted-foreground mt-1",
                                children: [
                                    "#",
                                    booking.booking_number
                                ]
                            }, void 0, true, {
                                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                lineNumber: 144,
                                columnNumber: 11
                            }, this)
                        ]
                    }, void 0, true, {
                        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                        lineNumber: 134,
                        columnNumber: 9
                    }, this),
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                        className: "flex flex-wrap gap-1.5 sm:gap-2",
                        children: [
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$badge$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Badge"], {
                                className: `${statusColors[booking.status] || statusColors.pending} text-sm sm:text-base px-2 sm:px-3 py-0.5`,
                                children: statusLabel
                            }, void 0, false, {
                                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                lineNumber: 147,
                                columnNumber: 11
                            }, this),
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$badge$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Badge"], {
                                variant: "outline",
                                className: `${paymentColors[booking.payment_status] || paymentColors.pending} text-sm sm:text-base px-2 sm:px-3 py-0.5`,
                                children: booking.payment_status
                            }, void 0, false, {
                                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                lineNumber: 150,
                                columnNumber: 11
                            }, this)
                        ]
                    }, void 0, true, {
                        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                        lineNumber: 146,
                        columnNumber: 9
                    }, this)
                ]
            }, void 0, true, {
                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                lineNumber: 133,
                columnNumber: 7
            }, this),
            booking.expected_arrival_time && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$card$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Card"], {
                className: "border-orange-200 bg-orange-50 dark:bg-orange-900/20",
                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$card$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["CardContent"], {
                    className: "flex items-start gap-3 pt-6",
                    children: [
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$circle$2d$alert$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__default__as__AlertCircle$3e$__["AlertCircle"], {
                            className: "h-5 w-5 text-orange-600 dark:text-orange-400 flex-shrink-0 mt-0.5"
                        }, void 0, false, {
                            fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                            lineNumber: 160,
                            columnNumber: 13
                        }, this),
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                            className: "flex-1",
                            children: [
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("h3", {
                                    className: "font-semibold text-orange-800 dark:text-orange-300 mb-1",
                                    children: "Lateness Reported"
                                }, void 0, false, {
                                    fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                    lineNumber: 162,
                                    columnNumber: 15
                                }, this),
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                    className: "text-sm text-orange-700 dark:text-orange-400",
                                    children: [
                                        "Expected arrival: ",
                                        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$date$2d$fns$2f$format$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["format"])(new Date(booking.expected_arrival_time), 'MMM d, yyyy h:mm a')
                                    ]
                                }, void 0, true, {
                                    fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                    lineNumber: 163,
                                    columnNumber: 15
                                }, this),
                                booking.lateness_reason && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                    className: "text-sm text-orange-600 dark:text-orange-400 mt-1",
                                    children: booking.lateness_reason
                                }, void 0, false, {
                                    fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                    lineNumber: 167,
                                    columnNumber: 17
                                }, this)
                            ]
                        }, void 0, true, {
                            fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                            lineNumber: 161,
                            columnNumber: 13
                        }, this)
                    ]
                }, void 0, true, {
                    fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                    lineNumber: 159,
                    columnNumber: 11
                }, this)
            }, void 0, false, {
                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                lineNumber: 158,
                columnNumber: 9
            }, this),
            cleaner && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$card$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Card"], {
                children: [
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$card$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["CardHeader"], {
                        children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$card$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["CardTitle"], {
                            children: "Booking Actions"
                        }, void 0, false, {
                            fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                            lineNumber: 178,
                            columnNumber: 13
                        }, this)
                    }, void 0, false, {
                        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                        lineNumber: 177,
                        columnNumber: 11
                    }, this),
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$card$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["CardContent"], {
                        className: "space-y-4",
                        children: [
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$app$2f$cleaner$2f$components$2f$BookingStatusButton$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["BookingStatusButton"], {
                                booking: booking,
                                onStatusUpdate: handleStatusUpdate
                            }, void 0, false, {
                                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                lineNumber: 181,
                                columnNumber: 13
                            }, this),
                            canReportLateness && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$button$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Button"], {
                                variant: "outline",
                                onClick: ()=>setLatenessModalOpen(true),
                                className: "w-full sm:w-auto",
                                children: "Report Lateness"
                            }, void 0, false, {
                                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                lineNumber: 186,
                                columnNumber: 15
                            }, this)
                        ]
                    }, void 0, true, {
                        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                        lineNumber: 180,
                        columnNumber: 11
                    }, this)
                ]
            }, void 0, true, {
                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                lineNumber: 176,
                columnNumber: 9
            }, this),
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                className: "grid gap-4 sm:gap-6 md:grid-cols-2 w-full max-w-full",
                children: [
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$card$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Card"], {
                        className: "w-full max-w-full overflow-hidden",
                        children: [
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$card$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["CardHeader"], {
                                className: "px-4 py-3 sm:px-6 sm:py-4",
                                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$card$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["CardTitle"], {
                                    className: "text-lg sm:text-xl",
                                    children: "Service Information"
                                }, void 0, false, {
                                    fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                    lineNumber: 203,
                                    columnNumber: 13
                                }, this)
                            }, void 0, false, {
                                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                lineNumber: 202,
                                columnNumber: 11
                            }, this),
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$card$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["CardContent"], {
                                className: "space-y-3 sm:space-y-4 px-4 pb-4 sm:px-6 sm:pb-6 pt-0",
                                children: [
                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                        children: [
                                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("h3", {
                                                className: "font-semibold text-base sm:text-lg mb-1.5 sm:mb-2",
                                                children: "Service Type"
                                            }, void 0, false, {
                                                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                lineNumber: 207,
                                                columnNumber: 15
                                            }, this),
                                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                                className: "text-sm sm:text-base text-muted-foreground",
                                                children: booking.service_type
                                            }, void 0, false, {
                                                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                lineNumber: 208,
                                                columnNumber: 15
                                            }, this)
                                        ]
                                    }, void 0, true, {
                                        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                        lineNumber: 206,
                                        columnNumber: 13
                                    }, this),
                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                        children: [
                                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("h3", {
                                                className: "font-semibold text-base sm:text-lg mb-1.5 sm:mb-2",
                                                children: "Property Details"
                                            }, void 0, false, {
                                                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                lineNumber: 211,
                                                columnNumber: 15
                                            }, this),
                                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                                className: "text-sm sm:text-base text-muted-foreground",
                                                children: [
                                                    booking.bedrooms,
                                                    " Bedrooms, ",
                                                    booking.bathrooms,
                                                    " Bathrooms"
                                                ]
                                            }, void 0, true, {
                                                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                lineNumber: 212,
                                                columnNumber: 15
                                            }, this)
                                        ]
                                    }, void 0, true, {
                                        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                        lineNumber: 210,
                                        columnNumber: 13
                                    }, this),
                                    booking.additional_services && booking.additional_services.length > 0 && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                        children: [
                                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("h3", {
                                                className: "font-semibold text-base sm:text-lg mb-1.5 sm:mb-2",
                                                children: "Additional Services"
                                            }, void 0, false, {
                                                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                lineNumber: 218,
                                                columnNumber: 17
                                            }, this),
                                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("ul", {
                                                className: "list-disc list-inside text-sm sm:text-base text-muted-foreground space-y-1",
                                                children: booking.additional_services.map((serviceId, index)=>{
                                                    const service = additionalServices.find((s)=>s.id === serviceId);
                                                    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("li", {
                                                        children: service?.name || serviceId
                                                    }, index, false, {
                                                        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                        lineNumber: 223,
                                                        columnNumber: 23
                                                    }, this);
                                                })
                                            }, void 0, false, {
                                                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                lineNumber: 219,
                                                columnNumber: 17
                                            }, this)
                                        ]
                                    }, void 0, true, {
                                        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                        lineNumber: 217,
                                        columnNumber: 15
                                    }, this),
                                    booking.special_instructions && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                        children: [
                                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("h3", {
                                                className: "font-semibold text-base sm:text-lg mb-1.5 sm:mb-2",
                                                children: "Special Instructions"
                                            }, void 0, false, {
                                                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                lineNumber: 231,
                                                columnNumber: 17
                                            }, this),
                                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                                className: "text-sm sm:text-base text-muted-foreground leading-relaxed whitespace-pre-wrap",
                                                children: booking.special_instructions
                                            }, void 0, false, {
                                                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                lineNumber: 232,
                                                columnNumber: 17
                                            }, this)
                                        ]
                                    }, void 0, true, {
                                        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                        lineNumber: 230,
                                        columnNumber: 15
                                    }, this)
                                ]
                            }, void 0, true, {
                                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                lineNumber: 205,
                                columnNumber: 11
                            }, this)
                        ]
                    }, void 0, true, {
                        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                        lineNumber: 201,
                        columnNumber: 9
                    }, this),
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$card$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Card"], {
                        className: "w-full max-w-full overflow-hidden",
                        children: [
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$card$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["CardHeader"], {
                                className: "px-4 py-3 sm:px-6 sm:py-4",
                                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$card$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["CardTitle"], {
                                    className: "text-lg sm:text-xl",
                                    children: "Schedule & Customer"
                                }, void 0, false, {
                                    fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                    lineNumber: 241,
                                    columnNumber: 13
                                }, this)
                            }, void 0, false, {
                                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                lineNumber: 240,
                                columnNumber: 11
                            }, this),
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$card$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["CardContent"], {
                                className: "space-y-3 sm:space-y-4 px-4 pb-4 sm:px-6 sm:pb-6 pt-0",
                                children: [
                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                        className: "flex items-start gap-2",
                                        children: [
                                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$calendar$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__default__as__Calendar$3e$__["Calendar"], {
                                                className: "h-5 w-5 text-muted-foreground mt-0.5 flex-shrink-0"
                                            }, void 0, false, {
                                                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                lineNumber: 245,
                                                columnNumber: 15
                                            }, this),
                                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                children: [
                                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("h3", {
                                                        className: "font-semibold text-base sm:text-lg mb-1",
                                                        children: "Date & Time"
                                                    }, void 0, false, {
                                                        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                        lineNumber: 247,
                                                        columnNumber: 17
                                                    }, this),
                                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                                        className: "text-sm sm:text-base text-muted-foreground",
                                                        children: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$date$2d$fns$2f$format$2e$mjs__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["format"])(new Date(booking.service_date), 'EEEE, MMMM d, yyyy')
                                                    }, void 0, false, {
                                                        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                        lineNumber: 248,
                                                        columnNumber: 17
                                                    }, this),
                                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                                        className: "text-sm sm:text-base text-muted-foreground",
                                                        children: [
                                                            booking.service_time,
                                                            " (",
                                                            booking.service_duration,
                                                            " hours)"
                                                        ]
                                                    }, void 0, true, {
                                                        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                        lineNumber: 251,
                                                        columnNumber: 17
                                                    }, this)
                                                ]
                                            }, void 0, true, {
                                                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                lineNumber: 246,
                                                columnNumber: 15
                                            }, this)
                                        ]
                                    }, void 0, true, {
                                        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                        lineNumber: 244,
                                        columnNumber: 13
                                    }, this),
                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                        className: "flex items-start gap-2",
                                        children: [
                                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$map$2d$pin$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__default__as__MapPin$3e$__["MapPin"], {
                                                className: "h-5 w-5 text-muted-foreground mt-0.5 flex-shrink-0"
                                            }, void 0, false, {
                                                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                lineNumber: 258,
                                                columnNumber: 15
                                            }, this),
                                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                children: [
                                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("h3", {
                                                        className: "font-semibold text-base sm:text-lg mb-1",
                                                        children: "Location"
                                                    }, void 0, false, {
                                                        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                        lineNumber: 260,
                                                        columnNumber: 17
                                                    }, this),
                                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                                        className: "text-sm sm:text-base text-muted-foreground",
                                                        children: [
                                                            booking.service_address,
                                                            booking.service_apt_unit && `, ${booking.service_apt_unit}`
                                                        ]
                                                    }, void 0, true, {
                                                        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                        lineNumber: 261,
                                                        columnNumber: 17
                                                    }, this),
                                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                                        className: "text-sm sm:text-base text-muted-foreground",
                                                        children: [
                                                            booking.service_suburb,
                                                            ", ",
                                                            booking.service_city
                                                        ]
                                                    }, void 0, true, {
                                                        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                        lineNumber: 265,
                                                        columnNumber: 17
                                                    }, this)
                                                ]
                                            }, void 0, true, {
                                                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                lineNumber: 259,
                                                columnNumber: 15
                                            }, this)
                                        ]
                                    }, void 0, true, {
                                        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                        lineNumber: 257,
                                        columnNumber: 13
                                    }, this),
                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                        className: "flex items-start gap-2",
                                        children: [
                                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$user$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__default__as__User$3e$__["User"], {
                                                className: "h-5 w-5 text-muted-foreground mt-0.5 flex-shrink-0"
                                            }, void 0, false, {
                                                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                lineNumber: 272,
                                                columnNumber: 15
                                            }, this),
                                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                children: [
                                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("h3", {
                                                        className: "font-semibold text-base sm:text-lg mb-1",
                                                        children: "Customer"
                                                    }, void 0, false, {
                                                        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                        lineNumber: 274,
                                                        columnNumber: 17
                                                    }, this),
                                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                                        className: "text-sm sm:text-base text-muted-foreground",
                                                        children: [
                                                            booking.customer_first_name,
                                                            " ",
                                                            booking.customer_last_name
                                                        ]
                                                    }, void 0, true, {
                                                        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                        lineNumber: 275,
                                                        columnNumber: 17
                                                    }, this)
                                                ]
                                            }, void 0, true, {
                                                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                lineNumber: 273,
                                                columnNumber: 15
                                            }, this)
                                        ]
                                    }, void 0, true, {
                                        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                        lineNumber: 271,
                                        columnNumber: 13
                                    }, this),
                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                        className: "flex items-start gap-2",
                                        children: [
                                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$phone$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$export__default__as__Phone$3e$__["Phone"], {
                                                className: "h-5 w-5 text-muted-foreground mt-0.5 flex-shrink-0"
                                            }, void 0, false, {
                                                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                lineNumber: 282,
                                                columnNumber: 15
                                            }, this),
                                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                children: [
                                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("h3", {
                                                        className: "font-semibold text-base sm:text-lg mb-1",
                                                        children: "Contact"
                                                    }, void 0, false, {
                                                        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                        lineNumber: 284,
                                                        columnNumber: 17
                                                    }, this),
                                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("a", {
                                                        href: `tel:${booking.customer_phone}`,
                                                        className: "text-sm sm:text-base text-primary hover:underline block",
                                                        children: booking.customer_phone
                                                    }, void 0, false, {
                                                        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                        lineNumber: 285,
                                                        columnNumber: 17
                                                    }, this),
                                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("a", {
                                                        href: `mailto:${booking.customer_email}`,
                                                        className: "text-sm sm:text-base text-primary hover:underline block",
                                                        children: booking.customer_email
                                                    }, void 0, false, {
                                                        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                        lineNumber: 288,
                                                        columnNumber: 17
                                                    }, this)
                                                ]
                                            }, void 0, true, {
                                                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                lineNumber: 283,
                                                columnNumber: 15
                                            }, this)
                                        ]
                                    }, void 0, true, {
                                        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                        lineNumber: 281,
                                        columnNumber: 13
                                    }, this)
                                ]
                            }, void 0, true, {
                                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                lineNumber: 243,
                                columnNumber: 11
                            }, this)
                        ]
                    }, void 0, true, {
                        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                        lineNumber: 239,
                        columnNumber: 9
                    }, this),
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$card$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Card"], {
                        className: "w-full max-w-full overflow-hidden md:col-span-2",
                        children: [
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$card$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["CardHeader"], {
                                className: "px-4 py-3 sm:px-6 sm:py-4",
                                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$card$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["CardTitle"], {
                                    className: "text-lg sm:text-xl",
                                    children: "Your Earnings"
                                }, void 0, false, {
                                    fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                    lineNumber: 299,
                                    columnNumber: 13
                                }, this)
                            }, void 0, false, {
                                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                lineNumber: 298,
                                columnNumber: 11
                            }, this),
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$card$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["CardContent"], {
                                className: "px-4 pb-4 sm:px-6 sm:pb-6 pt-0",
                                children: earnings ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                    className: "space-y-2 text-sm sm:text-base",
                                    children: [
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                            className: "flex justify-between",
                                            children: [
                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                                                    className: "text-muted-foreground",
                                                    children: "Base Earnings"
                                                }, void 0, false, {
                                                    fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                    lineNumber: 305,
                                                    columnNumber: 19
                                                }, this),
                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                                                    children: [
                                                        "R",
                                                        earnings.baseEarnings.toFixed(2)
                                                    ]
                                                }, void 0, true, {
                                                    fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                    lineNumber: 306,
                                                    columnNumber: 19
                                                }, this)
                                            ]
                                        }, void 0, true, {
                                            fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                            lineNumber: 304,
                                            columnNumber: 17
                                        }, this),
                                        earnings.tipAmount > 0 && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                            className: "flex justify-between text-primary",
                                            children: [
                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                                                    children: "Tip"
                                                }, void 0, false, {
                                                    fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                    lineNumber: 310,
                                                    columnNumber: 21
                                                }, this),
                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                                                    children: [
                                                        "R",
                                                        earnings.tipAmount.toFixed(2)
                                                    ]
                                                }, void 0, true, {
                                                    fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                    lineNumber: 311,
                                                    columnNumber: 21
                                                }, this)
                                            ]
                                        }, void 0, true, {
                                            fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                            lineNumber: 309,
                                            columnNumber: 19
                                        }, this),
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                            className: "flex justify-between border-t pt-2 mt-2 font-semibold text-base sm:text-lg",
                                            children: [
                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                                                    children: "Total Earnings"
                                                }, void 0, false, {
                                                    fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                    lineNumber: 315,
                                                    columnNumber: 19
                                                }, this),
                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                                                    children: [
                                                        "R",
                                                        earnings.totalEarnings.toFixed(2)
                                                    ]
                                                }, void 0, true, {
                                                    fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                                    lineNumber: 316,
                                                    columnNumber: 19
                                                }, this)
                                            ]
                                        }, void 0, true, {
                                            fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                            lineNumber: 314,
                                            columnNumber: 17
                                        }, this),
                                        booking.payment_status === 'paid' ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                            className: "text-xs text-green-600 dark:text-green-400 mt-2",
                                            children: "Payment confirmed - Earnings available"
                                        }, void 0, false, {
                                            fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                            lineNumber: 319,
                                            columnNumber: 19
                                        }, this) : /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                            className: "text-xs text-yellow-600 dark:text-yellow-400 mt-2",
                                            children: "Projected earnings - Payment pending"
                                        }, void 0, false, {
                                            fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                            lineNumber: 323,
                                            columnNumber: 19
                                        }, this)
                                    ]
                                }, void 0, true, {
                                    fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                    lineNumber: 303,
                                    columnNumber: 15
                                }, this) : /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                    className: "text-sm text-muted-foreground",
                                    children: "Calculating earnings..."
                                }, void 0, false, {
                                    fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                    lineNumber: 329,
                                    columnNumber: 15
                                }, this)
                            }, void 0, false, {
                                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                                lineNumber: 301,
                                columnNumber: 11
                            }, this)
                        ]
                    }, void 0, true, {
                        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                        lineNumber: 297,
                        columnNumber: 9
                    }, this)
                ]
            }, void 0, true, {
                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                lineNumber: 199,
                columnNumber: 7
            }, this),
            cleaner && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$app$2f$cleaner$2f$components$2f$LatenessReportModal$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["LatenessReportModal"], {
                open: latenessModalOpen,
                onOpenChange: setLatenessModalOpen,
                bookingId: booking.id,
                onSuccess: ()=>{
                    // Refresh booking data and earnings
                    Promise.all([
                        (0, __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$cleaner$2f$data$3a$126878__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$text$2f$javascript$3e$__["getCleanerBookingById"])(bookingId),
                        (0, __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$cleaner$2f$data$3a$a563e4__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$text$2f$javascript$3e$__["calculateBookingEarnings"])(bookingId)
                    ]).then(([bookingResult, earningsResult])=>{
                        if (bookingResult.success && bookingResult.booking) {
                            setBooking(bookingResult.booking);
                        } else {
                            setError(bookingResult.error || 'Failed to refresh booking');
                        }
                        if (earningsResult.success && earningsResult.earnings) {
                            setEarnings(earningsResult.earnings);
                        }
                    });
                }
            }, void 0, false, {
                fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
                lineNumber: 339,
                columnNumber: 9
            }, this)
        ]
    }, void 0, true, {
        fileName: "[project]/app/cleaner/(dashboard)/bookings/[id]/page.tsx",
        lineNumber: 131,
        columnNumber: 5
    }, this);
}
_s(CleanerBookingDetailsPage, "23BqdTcDCJgEwc3bn/rRGBS46aM=", false, function() {
    return [
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$navigation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useParams"],
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$navigation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useRouter"],
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$tanstack$2f$react$2d$query$2f$build$2f$modern$2f$useQuery$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useQuery"],
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$tanstack$2f$react$2d$query$2f$build$2f$modern$2f$useQuery$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useQuery"]
    ];
});
_c = CleanerBookingDetailsPage;
var _c;
__turbopack_context__.k.register(_c, "CleanerBookingDetailsPage");
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
}),
]);

//# sourceMappingURL=_0ca7b6c7._.js.map