{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/27825/shalean-v2/shalean-reimagined/src/lib/supabase/server.ts"],"sourcesContent":["import { createServerClient } from '@supabase/ssr'\r\nimport { cookies } from 'next/headers'\r\n\r\nexport async function createClient() {\r\n  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL\r\n  const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY\r\n\r\n  if (!supabaseUrl || !supabaseAnonKey) {\r\n    console.error('Missing Supabase environment variables: NEXT_PUBLIC_SUPABASE_URL or NEXT_PUBLIC_SUPABASE_ANON_KEY')\r\n    throw new Error('Supabase configuration is missing. Please check your environment variables.')\r\n  }\r\n\r\n  try {\r\n    const cookieStore = await cookies()\r\n\r\n    return createServerClient(\r\n      supabaseUrl,\r\n      supabaseAnonKey,\r\n      {\r\n        cookies: {\r\n          getAll() {\r\n            return cookieStore.getAll()\r\n          },\r\n          setAll(cookiesToSet) {\r\n            try {\r\n              cookiesToSet.forEach(({ name, value, options }) =>\r\n                cookieStore.set(name, value, options)\r\n              )\r\n            } catch {\r\n              // The `setAll` method was called from a Server Component.\r\n              // This can be ignored if you have middleware refreshing\r\n              // user sessions.\r\n            }\r\n          },\r\n        },\r\n      }\r\n    )\r\n  } catch (error) {\r\n    console.error('Error creating Supabase client:', error)\r\n    throw error\r\n  }\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;;;AAEO,eAAe;IACpB,MAAM;IACN,MAAM;IAEN;;IAKA,IAAI;QACF,MAAM,cAAc,MAAM,IAAA,4IAAO;QAEjC,OAAO,IAAA,iMAAkB,EACvB,aACA,iBACA;YACE,SAAS;gBACP;oBACE,OAAO,YAAY,MAAM;gBAC3B;gBACA,QAAO,YAAY;oBACjB,IAAI;wBACF,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAC5C,YAAY,GAAG,CAAC,MAAM,OAAO;oBAEjC,EAAE,OAAM;oBACN,0DAA0D;oBAC1D,wDAAwD;oBACxD,iBAAiB;oBACnB;gBACF;YACF;QACF;IAEJ,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,mCAAmC;QACjD,MAAM;IACR;AACF"}},
    {"offset": {"line": 87, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/27825/shalean-v2/shalean-reimagined/app/api/bookings/use-credits/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport { createClient } from '@/lib/supabase/server';\r\n\r\n/**\r\n * POST /api/bookings/use-credits\r\n * Deduct ShaleanCred from user's balance for booking(s)\r\n * Creates credit transaction record and updates profile balance\r\n */\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const supabase = await createClient();\r\n    \r\n    // Get authenticated user\r\n    const { data: { user }, error: authError } = await supabase.auth.getUser();\r\n    \r\n    if (authError || !user) {\r\n      return NextResponse.json(\r\n        { error: 'Unauthorized' },\r\n        { status: 401 }\r\n      );\r\n    }\r\n\r\n    const email = user.email;\r\n    if (!email) {\r\n      return NextResponse.json(\r\n        { error: 'User email not found' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    const body = await request.json();\r\n    const { bookingIds, creditsAmount } = body;\r\n\r\n    if (!bookingIds || !Array.isArray(bookingIds) || bookingIds.length === 0) {\r\n      return NextResponse.json(\r\n        { error: 'Booking IDs are required' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    if (!creditsAmount || creditsAmount <= 0) {\r\n      return NextResponse.json(\r\n        { error: 'Credit amount must be greater than 0' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // Get user's profile and current balance\r\n    const { data: profile, error: profileError } = await supabase\r\n      .from('profiles')\r\n      .select('id, credit_balance')\r\n      .eq('email', email)\r\n      .maybeSingle();\r\n\r\n    if (profileError) {\r\n      console.error('Error fetching profile:', profileError);\r\n      return NextResponse.json(\r\n        { error: 'Failed to fetch profile' },\r\n        { status: 500 }\r\n      );\r\n    }\r\n\r\n    if (!profile) {\r\n      return NextResponse.json(\r\n        { error: 'Profile not found' },\r\n        { status: 404 }\r\n      );\r\n    }\r\n\r\n    const balanceBefore = profile.credit_balance || 0;\r\n\r\n    // Validate sufficient balance\r\n    if (balanceBefore < creditsAmount) {\r\n      return NextResponse.json(\r\n        { \r\n          error: 'Insufficient ShaleanCred balance',\r\n          currentBalance: balanceBefore,\r\n          requestedAmount: creditsAmount\r\n        },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // Get booking totals to validate credits amount doesn't exceed total\r\n    const { data: bookings, error: bookingsError } = await supabase\r\n      .from('bookings')\r\n      .select('id, total_amount, tip_amount, credits_used, subtotal, service_fee')\r\n      .in('id', bookingIds);\r\n\r\n    if (bookingsError || !bookings || bookings.length === 0) {\r\n      return NextResponse.json(\r\n        { error: 'Bookings not found' },\r\n        { status: 404 }\r\n      );\r\n    }\r\n\r\n    // Calculate total amount for all bookings (including tip)\r\n    const totalAmount = bookings.reduce((sum, booking) => {\r\n      const bookingTotal = Number(booking.total_amount) || 0;\r\n      const tipAmount = Number(booking.tip_amount) || 0;\r\n      const baseTotal = Number(booking.subtotal || 0) + Number(booking.service_fee || 0);\r\n      \r\n      // Check if tip is already included in total_amount\r\n      if (tipAmount > 0 && Math.abs(bookingTotal - baseTotal) < 0.01) {\r\n        return sum + bookingTotal + tipAmount;\r\n      }\r\n      return sum + bookingTotal;\r\n    }, 0);\r\n\r\n    // Round to 2 decimal places for comparison to avoid floating point precision issues\r\n    const roundedCreditsAmount = Math.round(creditsAmount * 100) / 100;\r\n    const roundedTotalAmount = Math.round(totalAmount * 100) / 100;\r\n    \r\n    // Cap credits amount to the total (allow up to exact total with small tolerance for rounding)\r\n    const creditsToUse = Math.min(roundedCreditsAmount, roundedTotalAmount);\r\n    \r\n    // Validate credits amount doesn't significantly exceed total booking amount\r\n    // Use 0.01 tolerance to allow for floating point precision issues\r\n    if (roundedCreditsAmount > roundedTotalAmount + 0.01) {\r\n      return NextResponse.json(\r\n        { \r\n          error: 'Credit amount exceeds booking total',\r\n          bookingTotal: roundedTotalAmount,\r\n          requestedAmount: roundedCreditsAmount,\r\n          message: `You can use up to R${roundedTotalAmount.toFixed(2)} in credits for this booking.`\r\n        },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // Check if credits already used for these bookings\r\n    const alreadyUsedCredits = bookings.reduce((sum, booking) => {\r\n      return sum + (Number(booking.credits_used) || 0);\r\n    }, 0);\r\n\r\n    if (alreadyUsedCredits > 0) {\r\n      return NextResponse.json(\r\n        { \r\n          error: 'Credits have already been used for these bookings',\r\n          alreadyUsed: alreadyUsedCredits\r\n        },\r\n        { status: 400 }\r\n      );\r\n    }\r\n    \r\n    // Calculate new balance\r\n    const balanceAfter = balanceBefore - creditsToUse;\r\n\r\n    // Update profile balance\r\n    const { error: balanceUpdateError } = await supabase\r\n      .from('profiles')\r\n      .update({\r\n        credit_balance: balanceAfter,\r\n        updated_at: new Date().toISOString(),\r\n      })\r\n      .eq('id', profile.id);\r\n\r\n    if (balanceUpdateError) {\r\n      console.error('Error updating credit balance:', balanceUpdateError);\r\n      return NextResponse.json(\r\n        { error: 'Failed to update credit balance', details: balanceUpdateError.message },\r\n        { status: 500 }\r\n      );\r\n    }\r\n\r\n    // Distribute credits across bookings proportionally\r\n    // For simplicity, apply credits to first booking(s) until amount is used\r\n    // Use the final capped credits amount\r\n    let remainingCredits = Math.round(creditsToUse * 100) / 100;\r\n    const bookingUpdates = [];\r\n\r\n    for (const booking of bookings) {\r\n      if (remainingCredits <= 0.01) break; // Use small epsilon for comparison\r\n\r\n      const bookingTotal = Number(booking.total_amount) || 0;\r\n      const tipAmount = Number(booking.tip_amount) || 0;\r\n      const baseTotal = Number(booking.subtotal || 0) + Number(booking.service_fee || 0);\r\n      \r\n      // Calculate booking total (including tip if not already included)\r\n      const bookingTotalWithTip = (tipAmount > 0 && Math.abs(bookingTotal - baseTotal) < 0.01) \r\n        ? bookingTotal + tipAmount \r\n        : bookingTotal;\r\n\r\n      // Round booking total and apply credits up to the booking total\r\n      const roundedBookingTotal = Math.round(bookingTotalWithTip * 100) / 100;\r\n      const creditsToApply = Math.min(remainingCredits, roundedBookingTotal);\r\n      // Round credits to apply to 2 decimal places\r\n      const roundedCreditsToApply = Math.round(creditsToApply * 100) / 100;\r\n      \r\n      bookingUpdates.push({\r\n        id: booking.id,\r\n        credits_used: roundedCreditsToApply,\r\n      });\r\n\r\n      remainingCredits = Math.round((remainingCredits - roundedCreditsToApply) * 100) / 100;\r\n    }\r\n\r\n    // Update bookings with credits_used\r\n    for (const update of bookingUpdates) {\r\n      const { error: bookingUpdateError } = await supabase\r\n        .from('bookings')\r\n        .update({\r\n          credits_used: update.credits_used,\r\n          amount_paid: update.credits_used, // Initial payment from credits\r\n          updated_at: new Date().toISOString(),\r\n        })\r\n        .eq('id', update.id);\r\n\r\n      if (bookingUpdateError) {\r\n        console.error(`Error updating booking ${update.id}:`, bookingUpdateError);\r\n        // Rollback profile balance update if booking update fails\r\n        await supabase\r\n          .from('profiles')\r\n          .update({\r\n            credit_balance: balanceBefore,\r\n            updated_at: new Date().toISOString(),\r\n          })\r\n          .eq('id', profile.id);\r\n        \r\n        return NextResponse.json(\r\n          { error: 'Failed to update booking with credits', details: bookingUpdateError.message },\r\n          { status: 500 }\r\n        );\r\n      }\r\n    }\r\n\r\n    // Create credit transaction record for each booking (or one combined)\r\n    // Using first booking ID as primary reference, but store all in metadata\r\n    const { data: transaction, error: transactionError } = await supabase\r\n      .from('credit_transactions')\r\n      .insert({\r\n        profile_id: profile.id,\r\n        email,\r\n        transaction_type: 'usage',\r\n        amount: -creditsToUse, // Negative for debit\r\n        balance_before: balanceBefore,\r\n        balance_after: balanceAfter,\r\n        payment_status: 'completed',\r\n        booking_id: bookings[0].id, // Primary booking reference\r\n        description: `Used R${creditsToUse.toFixed(2)} ShaleanCred for booking(s)`,\r\n        metadata: {\r\n          booking_ids: bookingIds,\r\n          credits_distribution: bookingUpdates.map(u => ({ booking_id: u.id, credits: u.credits_used })),\r\n        },\r\n      })\r\n      .select('id')\r\n      .single();\r\n\r\n    if (transactionError) {\r\n      console.error('Error creating credit transaction:', transactionError);\r\n      // Rollback profile balance and booking updates\r\n      await supabase\r\n        .from('profiles')\r\n        .update({\r\n          credit_balance: balanceBefore,\r\n          updated_at: new Date().toISOString(),\r\n        })\r\n        .eq('id', profile.id);\r\n      \r\n      for (const update of bookingUpdates) {\r\n        await supabase\r\n          .from('bookings')\r\n          .update({\r\n            credits_used: 0,\r\n            amount_paid: 0,\r\n            updated_at: new Date().toISOString(),\r\n          })\r\n          .eq('id', update.id);\r\n      }\r\n\r\n      return NextResponse.json(\r\n        { error: 'Failed to create credit transaction', details: transactionError.message },\r\n        { status: 500 }\r\n      );\r\n    }\r\n\r\n    return NextResponse.json({\r\n      success: true,\r\n      creditsUsed: creditsToUse,\r\n      balanceBefore,\r\n      balanceAfter,\r\n      transactionId: transaction.id,\r\n      bookingUpdates: bookingUpdates.map(u => ({ bookingId: u.id, creditsUsed: u.credits_used })),\r\n    });\r\n  } catch (error) {\r\n    console.error('Error in use-credits API:', error);\r\n    return NextResponse.json(\r\n      {\r\n        error: 'Failed to use credits',\r\n        message: error instanceof Error ? error.message : 'Unknown error',\r\n      },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}}]
}