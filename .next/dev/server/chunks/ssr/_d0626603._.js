module.exports = [
"[project]/src/components/ui/card.tsx [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Card",
    ()=>Card,
    "CardContent",
    ()=>CardContent,
    "CardDescription",
    ()=>CardDescription,
    "CardFooter",
    ()=>CardFooter,
    "CardHeader",
    ()=>CardHeader,
    "CardTitle",
    ()=>CardTitle
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/lib/utils.ts [app-ssr] (ecmascript)");
;
;
;
const Card = /*#__PURE__*/ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["forwardRef"](({ className, ...props }, ref)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
        ref: ref,
        className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["cn"])("rounded-lg border bg-card text-card-foreground shadow-sm", className),
        ...props
    }, void 0, false, {
        fileName: "[project]/src/components/ui/card.tsx",
        lineNumber: 6,
        columnNumber: 3
    }, ("TURBOPACK compile-time value", void 0)));
Card.displayName = "Card";
const CardHeader = /*#__PURE__*/ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["forwardRef"](({ className, ...props }, ref)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
        ref: ref,
        className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["cn"])("flex flex-col space-y-1.5 p-6", className),
        ...props
    }, void 0, false, {
        fileName: "[project]/src/components/ui/card.tsx",
        lineNumber: 12,
        columnNumber: 5
    }, ("TURBOPACK compile-time value", void 0)));
CardHeader.displayName = "CardHeader";
const CardTitle = /*#__PURE__*/ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["forwardRef"](({ className, ...props }, ref)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("h3", {
        ref: ref,
        className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["cn"])("text-2xl font-semibold leading-none tracking-tight", className),
        ...props
    }, void 0, false, {
        fileName: "[project]/src/components/ui/card.tsx",
        lineNumber: 19,
        columnNumber: 5
    }, ("TURBOPACK compile-time value", void 0)));
CardTitle.displayName = "CardTitle";
const CardDescription = /*#__PURE__*/ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["forwardRef"](({ className, ...props }, ref)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
        ref: ref,
        className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["cn"])("text-sm text-muted-foreground", className),
        ...props
    }, void 0, false, {
        fileName: "[project]/src/components/ui/card.tsx",
        lineNumber: 26,
        columnNumber: 5
    }, ("TURBOPACK compile-time value", void 0)));
CardDescription.displayName = "CardDescription";
const CardContent = /*#__PURE__*/ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["forwardRef"](({ className, ...props }, ref)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
        ref: ref,
        className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["cn"])("p-6 pt-0", className),
        ...props
    }, void 0, false, {
        fileName: "[project]/src/components/ui/card.tsx",
        lineNumber: 32,
        columnNumber: 37
    }, ("TURBOPACK compile-time value", void 0)));
CardContent.displayName = "CardContent";
const CardFooter = /*#__PURE__*/ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["forwardRef"](({ className, ...props }, ref)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
        ref: ref,
        className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["cn"])("flex items-center p-6 pt-0", className),
        ...props
    }, void 0, false, {
        fileName: "[project]/src/components/ui/card.tsx",
        lineNumber: 38,
        columnNumber: 5
    }, ("TURBOPACK compile-time value", void 0)));
CardFooter.displayName = "CardFooter";
;
}),
"[project]/src/components/ui/badge.tsx [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Badge",
    ()=>Badge,
    "badgeVariants",
    ()=>badgeVariants
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$class$2d$variance$2d$authority$2f$dist$2f$index$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/class-variance-authority/dist/index.mjs [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/lib/utils.ts [app-ssr] (ecmascript)");
;
;
;
const badgeVariants = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$class$2d$variance$2d$authority$2f$dist$2f$index$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["cva"])("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2", {
    variants: {
        variant: {
            default: "border-transparent bg-primary text-primary-foreground hover:bg-primary/80",
            secondary: "border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",
            destructive: "border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",
            outline: "text-foreground"
        }
    },
    defaultVariants: {
        variant: "default"
    }
});
function Badge({ className, variant, ...props }) {
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
        className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["cn"])(badgeVariants({
            variant
        }), className),
        ...props
    }, void 0, false, {
        fileName: "[project]/src/components/ui/badge.tsx",
        lineNumber: 26,
        columnNumber: 10
    }, this);
}
;
}),
"[project]/app/cleaner/components/CleanerBookingCard.tsx [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "CleanerBookingCard",
    ()=>CleanerBookingCard
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$card$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/components/ui/card.tsx [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$badge$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/components/ui/badge.tsx [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$button$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/components/ui/button.tsx [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$calendar$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__Calendar$3e$__ = __turbopack_context__.i("[project]/node_modules/lucide-react/dist/esm/icons/calendar.js [app-ssr] (ecmascript) <export default as Calendar>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$clock$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__Clock$3e$__ = __turbopack_context__.i("[project]/node_modules/lucide-react/dist/esm/icons/clock.js [app-ssr] (ecmascript) <export default as Clock>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$map$2d$pin$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__MapPin$3e$__ = __turbopack_context__.i("[project]/node_modules/lucide-react/dist/esm/icons/map-pin.js [app-ssr] (ecmascript) <export default as MapPin>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$arrow$2d$right$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__ArrowRight$3e$__ = __turbopack_context__.i("[project]/node_modules/lucide-react/dist/esm/icons/arrow-right.js [app-ssr] (ecmascript) <export default as ArrowRight>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$user$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__User$3e$__ = __turbopack_context__.i("[project]/node_modules/lucide-react/dist/esm/icons/user.js [app-ssr] (ecmascript) <export default as User>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$date$2d$fns$2f$format$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/date-fns/format.mjs [app-ssr] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$client$2f$app$2d$dir$2f$link$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/client/app-dir/link.js [app-ssr] (ecmascript)");
'use client';
;
;
;
;
;
;
;
function CleanerBookingCard({ booking, earnings }) {
    const statusColors = {
        pending: 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400',
        confirmed: 'bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400',
        on_my_way: 'bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-400',
        started: 'bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-400',
        completed: 'bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400',
        cancelled: 'bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400'
    };
    const paymentColors = {
        pending: 'bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400',
        paid: 'bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400',
        failed: 'bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400',
        refunded: 'bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-400'
    };
    const statusLabel = booking.status.replace('_', ' ').replace(/\b\w/g, (l)=>l.toUpperCase());
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$card$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["Card"], {
        className: "hover:shadow-md transition-shadow border-border w-full max-w-full overflow-hidden",
        children: [
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$card$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["CardHeader"], {
                className: "pb-2 px-3 py-3 sm:px-4 sm:py-4 md:px-6 md:py-6",
                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                    className: "flex flex-col gap-2",
                    children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                        className: "flex items-start justify-between gap-2",
                        children: [
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                className: "flex-1 min-w-0",
                                children: [
                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("h3", {
                                        className: "font-semibold text-base sm:text-lg md:text-xl truncate",
                                        children: booking.service_type
                                    }, void 0, false, {
                                        fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                                        lineNumber: 41,
                                        columnNumber: 15
                                    }, this),
                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                        className: "text-sm text-muted-foreground mt-0.5",
                                        children: [
                                            "#",
                                            booking.booking_number
                                        ]
                                    }, void 0, true, {
                                        fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                                        lineNumber: 42,
                                        columnNumber: 15
                                    }, this)
                                ]
                            }, void 0, true, {
                                fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                                lineNumber: 40,
                                columnNumber: 13
                            }, this),
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                className: "flex flex-wrap gap-1.5 sm:gap-2 flex-shrink-0",
                                children: [
                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$badge$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["Badge"], {
                                        className: `${statusColors[booking.status] || statusColors.pending} text-xs sm:text-sm px-2 sm:px-3 py-0.5`,
                                        children: statusLabel
                                    }, void 0, false, {
                                        fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                                        lineNumber: 45,
                                        columnNumber: 15
                                    }, this),
                                    booking.payment_status !== booking.status && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$badge$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["Badge"], {
                                        variant: "outline",
                                        className: `${paymentColors[booking.payment_status] || paymentColors.pending} text-xs sm:text-sm px-2 sm:px-3 py-0.5`,
                                        children: booking.payment_status
                                    }, void 0, false, {
                                        fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                                        lineNumber: 49,
                                        columnNumber: 17
                                    }, this)
                                ]
                            }, void 0, true, {
                                fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                                lineNumber: 44,
                                columnNumber: 13
                            }, this)
                        ]
                    }, void 0, true, {
                        fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                        lineNumber: 39,
                        columnNumber: 11
                    }, this)
                }, void 0, false, {
                    fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                    lineNumber: 38,
                    columnNumber: 9
                }, this)
            }, void 0, false, {
                fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                lineNumber: 37,
                columnNumber: 7
            }, this),
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$card$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["CardContent"], {
                className: "px-3 pb-3 sm:px-4 sm:pb-4 md:px-6 md:pb-6 pt-0",
                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                    className: "space-y-2.5 sm:space-y-3",
                    children: [
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                            className: "flex items-center gap-1.5 sm:gap-2 text-sm sm:text-base",
                            children: [
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$user$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__User$3e$__["User"], {
                                    className: "w-4 h-4 sm:w-5 sm:h-5 text-muted-foreground flex-shrink-0"
                                }, void 0, false, {
                                    fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                                    lineNumber: 61,
                                    columnNumber: 13
                                }, this),
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                                    className: "font-medium",
                                    children: [
                                        booking.customer_first_name,
                                        " ",
                                        booking.customer_last_name
                                    ]
                                }, void 0, true, {
                                    fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                                    lineNumber: 62,
                                    columnNumber: 13
                                }, this)
                            ]
                        }, void 0, true, {
                            fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                            lineNumber: 60,
                            columnNumber: 11
                        }, this),
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                            className: "flex flex-col gap-1.5 sm:flex-row sm:items-center sm:gap-3 text-sm sm:text-base",
                            children: [
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                    className: "flex items-center gap-1.5 sm:gap-2",
                                    children: [
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$calendar$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__Calendar$3e$__["Calendar"], {
                                            className: "w-4 h-4 sm:w-5 sm:h-5 text-muted-foreground flex-shrink-0"
                                        }, void 0, false, {
                                            fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                                            lineNumber: 70,
                                            columnNumber: 15
                                        }, this),
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                                            className: "whitespace-nowrap",
                                            children: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$date$2d$fns$2f$format$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__["format"])(new Date(booking.service_date), 'MMM d, yyyy')
                                        }, void 0, false, {
                                            fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                                            lineNumber: 71,
                                            columnNumber: 15
                                        }, this)
                                    ]
                                }, void 0, true, {
                                    fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                                    lineNumber: 69,
                                    columnNumber: 13
                                }, this),
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                    className: "flex items-center gap-1.5 sm:gap-2",
                                    children: [
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$clock$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__Clock$3e$__["Clock"], {
                                            className: "w-4 h-4 sm:w-5 sm:h-5 text-muted-foreground flex-shrink-0"
                                        }, void 0, false, {
                                            fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                                            lineNumber: 74,
                                            columnNumber: 15
                                        }, this),
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                                            className: "whitespace-nowrap",
                                            children: [
                                                booking.service_time,
                                                " (",
                                                booking.service_duration,
                                                "h)"
                                            ]
                                        }, void 0, true, {
                                            fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                                            lineNumber: 75,
                                            columnNumber: 15
                                        }, this)
                                    ]
                                }, void 0, true, {
                                    fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                                    lineNumber: 73,
                                    columnNumber: 13
                                }, this)
                            ]
                        }, void 0, true, {
                            fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                            lineNumber: 68,
                            columnNumber: 11
                        }, this),
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                            className: "flex items-start gap-1.5 sm:gap-2 text-sm sm:text-base",
                            children: [
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$map$2d$pin$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__MapPin$3e$__["MapPin"], {
                                    className: "w-4 h-4 sm:w-5 sm:h-5 text-muted-foreground mt-0.5 flex-shrink-0"
                                }, void 0, false, {
                                    fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                                    lineNumber: 81,
                                    columnNumber: 13
                                }, this),
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                                    className: "text-muted-foreground break-words leading-relaxed",
                                    children: [
                                        booking.service_address,
                                        booking.service_apt_unit && `, ${booking.service_apt_unit}`,
                                        ", ",
                                        booking.service_suburb
                                    ]
                                }, void 0, true, {
                                    fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                                    lineNumber: 82,
                                    columnNumber: 13
                                }, this)
                            ]
                        }, void 0, true, {
                            fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                            lineNumber: 80,
                            columnNumber: 11
                        }, this),
                        booking.expected_arrival_time && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                            className: "flex items-center gap-2 p-2 bg-orange-50 dark:bg-orange-900/20 rounded-md text-sm",
                            children: [
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$clock$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__Clock$3e$__["Clock"], {
                                    className: "w-4 h-4 text-orange-600 dark:text-orange-400 flex-shrink-0"
                                }, void 0, false, {
                                    fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                                    lineNumber: 92,
                                    columnNumber: 15
                                }, this),
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                    children: [
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                            className: "font-medium text-orange-800 dark:text-orange-300",
                                            children: [
                                                "Expected arrival: ",
                                                (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$date$2d$fns$2f$format$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$locals$3e$__["format"])(new Date(booking.expected_arrival_time), 'h:mm a')
                                            ]
                                        }, void 0, true, {
                                            fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                                            lineNumber: 94,
                                            columnNumber: 17
                                        }, this),
                                        booking.lateness_reason && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                            className: "text-orange-700 dark:text-orange-400 text-xs mt-1",
                                            children: booking.lateness_reason
                                        }, void 0, false, {
                                            fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                                            lineNumber: 98,
                                            columnNumber: 19
                                        }, this)
                                    ]
                                }, void 0, true, {
                                    fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                                    lineNumber: 93,
                                    columnNumber: 15
                                }, this)
                            ]
                        }, void 0, true, {
                            fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                            lineNumber: 91,
                            columnNumber: 13
                        }, this),
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                            className: "flex flex-col gap-2.5 sm:flex-row sm:items-center sm:justify-between pt-2 border-t border-border",
                            children: [
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                    className: "min-w-0 flex-1",
                                    children: [
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                            className: "text-xs sm:text-sm text-muted-foreground",
                                            children: "Your Earnings"
                                        }, void 0, false, {
                                            fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                                            lineNumber: 109,
                                            columnNumber: 15
                                        }, this),
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                            className: "text-base sm:text-lg md:text-xl font-semibold mt-0.5 break-words",
                                            children: [
                                                "R",
                                                earnings !== undefined ? earnings.toFixed(2) : '0.00'
                                            ]
                                        }, void 0, true, {
                                            fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                                            lineNumber: 110,
                                            columnNumber: 15
                                        }, this)
                                    ]
                                }, void 0, true, {
                                    fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                                    lineNumber: 108,
                                    columnNumber: 13
                                }, this),
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$button$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["Button"], {
                                    asChild: true,
                                    variant: "outline",
                                    size: "sm",
                                    className: "w-full sm:w-auto text-sm sm:text-base h-9 sm:h-10 flex-shrink-0 sm:ml-2",
                                    children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$client$2f$app$2d$dir$2f$link$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["default"], {
                                        href: `/cleaner/bookings/${booking.id}`,
                                        className: "flex items-center justify-center",
                                        children: [
                                            "View Details",
                                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$arrow$2d$right$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__ArrowRight$3e$__["ArrowRight"], {
                                                className: "w-3 h-3 sm:w-4 sm:h-4 ml-1.5 sm:ml-2"
                                            }, void 0, false, {
                                                fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                                                lineNumber: 117,
                                                columnNumber: 17
                                            }, this)
                                        ]
                                    }, void 0, true, {
                                        fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                                        lineNumber: 115,
                                        columnNumber: 15
                                    }, this)
                                }, void 0, false, {
                                    fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                                    lineNumber: 114,
                                    columnNumber: 13
                                }, this)
                            ]
                        }, void 0, true, {
                            fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                            lineNumber: 107,
                            columnNumber: 11
                        }, this)
                    ]
                }, void 0, true, {
                    fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                    lineNumber: 58,
                    columnNumber: 9
                }, this)
            }, void 0, false, {
                fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
                lineNumber: 57,
                columnNumber: 7
            }, this)
        ]
    }, void 0, true, {
        fileName: "[project]/app/cleaner/components/CleanerBookingCard.tsx",
        lineNumber: 36,
        columnNumber: 5
    }, this);
}
}),
"[project]/app/cleaner/data:9a70e2 [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "getCleanerBookings",
    ()=>$$RSC_SERVER_ACTION_3
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"40a21f4363e61128aa708111c03e4b8f9a91215864":"getCleanerBookings"},"app/cleaner/actions.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_3 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("40a21f4363e61128aa708111c03e4b8f9a91215864", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "getCleanerBookings");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vYWN0aW9ucy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHNlcnZlcic7XHJcblxyXG5pbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAL2xpYi9zdXBhYmFzZS9zZXJ2ZXInO1xyXG5pbXBvcnQgeyBjcmVhdGVBZG1pbkNsaWVudCB9IGZyb20gJ0AvbGliL3N1cGFiYXNlL3NlcnZlci1hZG1pbic7XHJcbmltcG9ydCB7IEJvb2tpbmcgfSBmcm9tICdAL3R5cGVzL2Jvb2tpbmcnO1xyXG5pbXBvcnQgeyBDbGVhbmVyIH0gZnJvbSAnQC90eXBlcy9ib29raW5nJztcclxuaW1wb3J0IHtcclxuICBjYWxjdWxhdGVDbGVhbmVyVGVudXJlLFxyXG4gIGNhbGN1bGF0ZVRvdGFsSG91cnMsXHJcbiAgZ2V0RWFybmluZ3NQZXJjZW50YWdlLFxyXG4gIGNhbGN1bGF0ZVRvdGFsRWFybmluZ3NGcm9tQm9va2luZyxcclxuICBjYWxjdWxhdGVDbGVhbmVyRWFybmluZ3MsXHJcbiAgY2FsY3VsYXRlVGlwUGVyQ2xlYW5lcixcclxufSBmcm9tICdAL2xpYi91dGlscy9jbGVhbmVyLWVhcm5pbmdzJztcclxuXHJcbi8qKlxyXG4gKiBHZXQgY2xlYW5lciBieSBwaG9uZSBudW1iZXJcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDbGVhbmVyQnlQaG9uZShwaG9uZTogc3RyaW5nKTogUHJvbWlzZTx7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBjbGVhbmVyPzogQ2xlYW5lcjtcclxuICBlcnJvcj86IHN0cmluZztcclxufT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xyXG4gICAgXHJcbiAgICAvLyBOb3JtYWxpemUgcGhvbmUgbnVtYmVyIChyZW1vdmUgc3BhY2VzLCBkYXNoZXMsIGV0Yy4pXHJcbiAgICBjb25zdCBub3JtYWxpemVkUGhvbmUgPSBwaG9uZS5yZXBsYWNlKC9cXHMrL2csICcnKS50cmltKCk7XHJcbiAgICBcclxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdjbGVhbmVycycpXHJcbiAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAub3IoYHBob25lLmVxLiR7bm9ybWFsaXplZFBob25lfSxwaG9uZS5lcS4rJHtub3JtYWxpemVkUGhvbmV9YClcclxuICAgICAgLmVxKCdpc19hY3RpdmUnLCB0cnVlKVxyXG4gICAgICAubWF5YmVTaW5nbGUoKTtcclxuXHJcbiAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY2xlYW5lciBieSBwaG9uZTonLCBlcnJvcik7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG5cclxuICAgIGlmICghZGF0YSkge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdDbGVhbmVyIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBjbGVhbmVyOiBkYXRhIGFzIENsZWFuZXIgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gZ2V0Q2xlYW5lckJ5UGhvbmU6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdGYWlsZWQgdG8gZmV0Y2ggY2xlYW5lcicsXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEF1dGhlbnRpY2F0ZSBjbGVhbmVyIHdpdGggcGhvbmUgYW5kIHBhc3N3b3JkXHJcbiAqIFVzZXMgU3VwYWJhc2UgQXV0aCAtIGV4cGVjdHMgZW1haWwgZm9ybWF0OiB7cGhvbmV9QGNsZWFuZXJzLnNoYWxlYW4ubG9jYWxcclxuICogQWRtaW4gc2hvdWxkIGNyZWF0ZSBhdXRoIGFjY291bnRzIHdpdGggdGhpcyBlbWFpbCBmb3JtYXQgd2hlbiBjcmVhdGluZyBjbGVhbmVyIGFjY291bnRzXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXV0aGVudGljYXRlQ2xlYW5lcihcclxuICBwaG9uZTogc3RyaW5nLFxyXG4gIHBhc3N3b3JkOiBzdHJpbmdcclxuKTogUHJvbWlzZTx7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBjbGVhbmVyPzogQ2xlYW5lcjtcclxuICBlcnJvcj86IHN0cmluZztcclxufT4ge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBGaXJzdCwgZmluZCB0aGUgY2xlYW5lciBieSBwaG9uZSB0byB2ZXJpZnkgdGhleSBleGlzdFxyXG4gICAgY29uc3QgY2xlYW5lclJlc3VsdCA9IGF3YWl0IGdldENsZWFuZXJCeVBob25lKHBob25lKTtcclxuICAgIGlmICghY2xlYW5lclJlc3VsdC5zdWNjZXNzIHx8ICFjbGVhbmVyUmVzdWx0LmNsZWFuZXIpIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnSW52YWxpZCBwaG9uZSBudW1iZXIgb3IgcGFzc3dvcmQnIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgY2xlYW5lciA9IGNsZWFuZXJSZXN1bHQuY2xlYW5lcjtcclxuXHJcbiAgICAvLyBVc2UgcGhvbmUtYmFzZWQgZW1haWwgZm9ybWF0IGZvciBsb2dpblxyXG4gICAgLy8gRm9ybWF0OiB7cGhvbmV9QGNsZWFuZXJzLnNoYWxlYW4ubG9jYWxcclxuICAgIC8vIE5vcm1hbGl6ZSBwaG9uZSAocmVtb3ZlIHNwYWNlcywga2VlcCArIGlmIHByZXNlbnQpXHJcbiAgICBjb25zdCBub3JtYWxpemVkUGhvbmUgPSBwaG9uZS5yZXBsYWNlKC9cXHMrL2csICcnKS50cmltKCk7XHJcbiAgICBjb25zdCBhdXRoRW1haWwgPSBgJHtub3JtYWxpemVkUGhvbmV9QGNsZWFuZXJzLnNoYWxlYW4ubG9jYWxgO1xyXG5cclxuICAgIC8vIEF1dGhlbnRpY2F0ZSB3aXRoIFN1cGFiYXNlIEF1dGggdXNpbmcgY2xpZW50LXNpZGUgKHRoaXMgc2hvdWxkIGJlIGNhbGxlZCBmcm9tIGNsaWVudClcclxuICAgIC8vIE5vdGU6IFRoaXMgZnVuY3Rpb24gc2hvdWxkIGlkZWFsbHkgYmUgY2FsbGVkIGZyb20gYSBjbGllbnQgY29tcG9uZW50XHJcbiAgICAvLyBGb3Igc2VydmVyLXNpZGUsIHdlJ2xsIHJldHVybiB0aGUgY2xlYW5lciBpbmZvIGFuZCBsZXQgY2xpZW50IGhhbmRsZSBhdXRoXHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xyXG4gICAgXHJcbiAgICAvLyBUcnkgdG8gYXV0aGVudGljYXRlXHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLnNpZ25JbldpdGhQYXNzd29yZCh7XHJcbiAgICAgIGVtYWlsOiBhdXRoRW1haWwsXHJcbiAgICAgIHBhc3N3b3JkLFxyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0F1dGhlbnRpY2F0aW9uIGVycm9yOicsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnSW52YWxpZCBwaG9uZSBudW1iZXIgb3IgcGFzc3dvcmQnIH07XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCFkYXRhLnVzZXIpIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnQXV0aGVudGljYXRpb24gZmFpbGVkJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFVwZGF0ZSBjbGVhbmVyJ3MgYXV0aF91c2VyX2lkIGlmIG5vdCBzZXRcclxuICAgIGlmICghY2xlYW5lci5hdXRoX3VzZXJfaWQpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBhZG1pblN1cGFiYXNlID0gY3JlYXRlQWRtaW5DbGllbnQoKTtcclxuICAgICAgICBhd2FpdCBhZG1pblN1cGFiYXNlXHJcbiAgICAgICAgICAuZnJvbSgnY2xlYW5lcnMnKVxyXG4gICAgICAgICAgLnVwZGF0ZSh7IGF1dGhfdXNlcl9pZDogZGF0YS51c2VyLmlkIH0pXHJcbiAgICAgICAgICAuZXEoJ2lkJywgY2xlYW5lci5pZCk7XHJcbiAgICAgIH0gY2F0Y2ggKHVwZGF0ZUVycm9yKSB7XHJcbiAgICAgICAgLy8gTG9nIGJ1dCBkb24ndCBmYWlsIC0gYXV0aF91c2VyX2lkIHVwZGF0ZSBpcyBvcHRpb25hbFxyXG4gICAgICAgIGNvbnNvbGUud2FybignQ291bGQgbm90IHVwZGF0ZSBhdXRoX3VzZXJfaWQ6JywgdXBkYXRlRXJyb3IpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgY2xlYW5lciB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBhdXRoZW50aWNhdGVDbGVhbmVyOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnQXV0aGVudGljYXRpb24gZmFpbGVkJyxcclxuICAgIH07XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogR2V0IGN1cnJlbnQgYXV0aGVudGljYXRlZCBjbGVhbmVyXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q3VycmVudENsZWFuZXIoKTogUHJvbWlzZTx7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBjbGVhbmVyPzogQ2xlYW5lcjtcclxuICBlcnJvcj86IHN0cmluZztcclxufT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xyXG4gICAgY29uc3QgeyBkYXRhOiB7IHVzZXIgfSwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5nZXRVc2VyKCk7XHJcblxyXG4gICAgaWYgKGF1dGhFcnJvciB8fCAhdXNlcikge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdOb3QgYXV0aGVudGljYXRlZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBUcnkgdG8gZmluZCBjbGVhbmVyIGJ5IGF1dGhfdXNlcl9pZCBmaXJzdFxyXG4gICAgbGV0IGNsZWFuZXJRdWVyeSA9IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdjbGVhbmVycycpXHJcbiAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAuZXEoJ2F1dGhfdXNlcl9pZCcsIHVzZXIuaWQpXHJcbiAgICAgIC5lcSgnaXNfYWN0aXZlJywgdHJ1ZSlcclxuICAgICAgLm1heWJlU2luZ2xlKCk7XHJcblxyXG4gICAgbGV0IHsgZGF0YTogY2xlYW5lciwgZXJyb3I6IGNsZWFuZXJFcnJvciB9ID0gYXdhaXQgY2xlYW5lclF1ZXJ5O1xyXG5cclxuICAgIC8vIElmIG5vdCBmb3VuZCBieSBhdXRoX3VzZXJfaWQsIHRyeSB0byBtYXRjaCBieSBwaG9uZSBmcm9tIGVtYWlsXHJcbiAgICBpZiAoIWNsZWFuZXIgJiYgIWNsZWFuZXJFcnJvciAmJiB1c2VyLmVtYWlsKSB7XHJcbiAgICAgIC8vIEV4dHJhY3QgcGhvbmUgZnJvbSBlbWFpbCBmb3JtYXQ6IHtwaG9uZX1AY2xlYW5lcnMuc2hhbGVhbi5sb2NhbFxyXG4gICAgICBjb25zdCBwaG9uZU1hdGNoID0gdXNlci5lbWFpbC5tYXRjaCgvXiguKylAY2xlYW5lcnNcXC5zaGFsZWFuXFwubG9jYWwkLyk7XHJcbiAgICAgIGlmIChwaG9uZU1hdGNoKSB7XHJcbiAgICAgICAgY29uc3QgcGhvbmUgPSBwaG9uZU1hdGNoWzFdO1xyXG4gICAgICAgIGNvbnN0IHBob25lUmVzdWx0ID0gYXdhaXQgZ2V0Q2xlYW5lckJ5UGhvbmUocGhvbmUpO1xyXG4gICAgICAgIGlmIChwaG9uZVJlc3VsdC5zdWNjZXNzICYmIHBob25lUmVzdWx0LmNsZWFuZXIpIHtcclxuICAgICAgICAgIGNsZWFuZXIgPSBwaG9uZVJlc3VsdC5jbGVhbmVyO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChjbGVhbmVyRXJyb3IgfHwgIWNsZWFuZXIpIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnQ2xlYW5lciBwcm9maWxlIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBjbGVhbmVyOiBjbGVhbmVyIGFzIENsZWFuZXIgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gZ2V0Q3VycmVudENsZWFuZXI6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdGYWlsZWQgdG8gZ2V0IGNsZWFuZXInLFxyXG4gICAgfTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZXQgYm9va2luZ3MgYXNzaWduZWQgdG8gdGhlIGF1dGhlbnRpY2F0ZWQgY2xlYW5lclxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENsZWFuZXJCb29raW5ncyhcclxuICBmaWx0ZXI/OiAnYWxsJyB8ICd0b2RheScgfCAndXBjb21pbmcnIHwgJ3Bhc3QnIHwgJ29uX215X3dheScgfCAnc3RhcnRlZCdcclxuKTogUHJvbWlzZTx7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBib29raW5ncz86IEJvb2tpbmdbXTtcclxuICBlcnJvcj86IHN0cmluZztcclxufT4ge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBHZXQgYXV0aGVudGljYXRlZCBjbGVhbmVyIGZpcnN0XHJcbiAgICBjb25zdCBjbGVhbmVyUmVzdWx0ID0gYXdhaXQgZ2V0Q3VycmVudENsZWFuZXIoKTtcclxuICAgIGlmICghY2xlYW5lclJlc3VsdC5zdWNjZXNzIHx8ICFjbGVhbmVyUmVzdWx0LmNsZWFuZXIpIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnTm90IGF1dGhlbnRpY2F0ZWQgb3IgY2xlYW5lciBwcm9maWxlIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBjbGVhbmVySWQgPSBjbGVhbmVyUmVzdWx0LmNsZWFuZXIuaWQ7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xyXG4gICAgXHJcbiAgICAvLyBGZXRjaCBib29raW5ncyB3aGVyZSBjbGVhbmVyIGlzIGFzc2lnbmVkIHZpYSBwcmVmZXJyZWRfY2xlYW5lcl9pZCAoc2luZ2xlKVxyXG4gICAgbGV0IHNpbmdsZVF1ZXJ5ID0gc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2Jvb2tpbmdzJylcclxuICAgICAgLnNlbGVjdCgnKicpXHJcbiAgICAgIC5lcSgncHJlZmVycmVkX2NsZWFuZXJfaWQnLCBjbGVhbmVySWQpO1xyXG5cclxuICAgIC8vIEZldGNoIGJvb2tpbmdzIHdpdGggcHJlZmVycmVkX2NsZWFuZXJfaWRzIChhcnJheSkgLSBmZXRjaCBhbGwgd2l0aCBhcnJheXMsIHRoZW4gZmlsdGVyXHJcbiAgICBsZXQgYXJyYXlRdWVyeSA9IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdib29raW5ncycpXHJcbiAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAubm90KCdwcmVmZXJyZWRfY2xlYW5lcl9pZHMnLCAnaXMnLCBudWxsKTtcclxuXHJcbiAgICAvLyBBcHBseSBmaWx0ZXJzIHRvIGJvdGggcXVlcmllc1xyXG4gICAgaWYgKGZpbHRlciAmJiBmaWx0ZXIgIT09ICdhbGwnKSB7XHJcbiAgICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XHJcbiAgICAgIFxyXG4gICAgICBzd2l0Y2ggKGZpbHRlcikge1xyXG4gICAgICAgIGNhc2UgJ3RvZGF5JzpcclxuICAgICAgICAgIHNpbmdsZVF1ZXJ5ID0gc2luZ2xlUXVlcnkuZXEoJ3NlcnZpY2VfZGF0ZScsIHRvZGF5KTtcclxuICAgICAgICAgIGFycmF5UXVlcnkgPSBhcnJheVF1ZXJ5LmVxKCdzZXJ2aWNlX2RhdGUnLCB0b2RheSk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICd1cGNvbWluZyc6XHJcbiAgICAgICAgICBzaW5nbGVRdWVyeSA9IHNpbmdsZVF1ZXJ5Lmd0ZSgnc2VydmljZV9kYXRlJywgdG9kYXkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAuaW4oJ3N0YXR1cycsIFsncGVuZGluZycsICdjb25maXJtZWQnLCAnb25fbXlfd2F5JywgJ3N0YXJ0ZWQnXSk7XHJcbiAgICAgICAgICBhcnJheVF1ZXJ5ID0gYXJyYXlRdWVyeS5ndGUoJ3NlcnZpY2VfZGF0ZScsIHRvZGF5KVxyXG4gICAgICAgICAgICAgICAgICAgICAgLmluKCdzdGF0dXMnLCBbJ3BlbmRpbmcnLCAnY29uZmlybWVkJywgJ29uX215X3dheScsICdzdGFydGVkJ10pO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAncGFzdCc6XHJcbiAgICAgICAgICBzaW5nbGVRdWVyeSA9IHNpbmdsZVF1ZXJ5Lmx0KCdzZXJ2aWNlX2RhdGUnLCB0b2RheSlcclxuICAgICAgICAgICAgICAgICAgICAgIC5vcignc3RhdHVzLmVxLmNvbXBsZXRlZCxzdGF0dXMuZXEuY2FuY2VsbGVkJyk7XHJcbiAgICAgICAgICBhcnJheVF1ZXJ5ID0gYXJyYXlRdWVyeS5sdCgnc2VydmljZV9kYXRlJywgdG9kYXkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAub3IoJ3N0YXR1cy5lcS5jb21wbGV0ZWQsc3RhdHVzLmVxLmNhbmNlbGxlZCcpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnb25fbXlfd2F5JzpcclxuICAgICAgICAgIHNpbmdsZVF1ZXJ5ID0gc2luZ2xlUXVlcnkuZXEoJ3N0YXR1cycsICdvbl9teV93YXknKTtcclxuICAgICAgICAgIGFycmF5UXVlcnkgPSBhcnJheVF1ZXJ5LmVxKCdzdGF0dXMnLCAnb25fbXlfd2F5Jyk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdzdGFydGVkJzpcclxuICAgICAgICAgIHNpbmdsZVF1ZXJ5ID0gc2luZ2xlUXVlcnkuZXEoJ3N0YXR1cycsICdzdGFydGVkJyk7XHJcbiAgICAgICAgICBhcnJheVF1ZXJ5ID0gYXJyYXlRdWVyeS5lcSgnc3RhdHVzJywgJ3N0YXJ0ZWQnKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRXhlY3V0ZSBib3RoIHF1ZXJpZXNcclxuICAgIGNvbnN0IFtzaW5nbGVSZXN1bHQsIGFycmF5UmVzdWx0XSA9IGF3YWl0IFByb21pc2UuYWxsKFtcclxuICAgICAgc2luZ2xlUXVlcnkub3JkZXIoJ3NlcnZpY2VfZGF0ZScsIHsgYXNjZW5kaW5nOiB0cnVlIH0pLm9yZGVyKCdzZXJ2aWNlX3RpbWUnLCB7IGFzY2VuZGluZzogdHJ1ZSB9KSxcclxuICAgICAgYXJyYXlRdWVyeS5vcmRlcignc2VydmljZV9kYXRlJywgeyBhc2NlbmRpbmc6IHRydWUgfSkub3JkZXIoJ3NlcnZpY2VfdGltZScsIHsgYXNjZW5kaW5nOiB0cnVlIH0pXHJcbiAgICBdKTtcclxuXHJcbiAgICBpZiAoc2luZ2xlUmVzdWx0LmVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGNsZWFuZXIgYm9va2luZ3MgKHNpbmdsZSk6Jywgc2luZ2xlUmVzdWx0LmVycm9yKTtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBzaW5nbGVSZXN1bHQuZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChhcnJheVJlc3VsdC5lcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBjbGVhbmVyIGJvb2tpbmdzIChhcnJheSk6JywgYXJyYXlSZXN1bHQuZXJyb3IpO1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGFycmF5UmVzdWx0LmVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBEZWJ1ZyBsb2dnaW5nXHJcbiAgICBjb25zb2xlLmxvZygnW2dldENsZWFuZXJCb29raW5nc10gRmV0Y2hlZCBib29raW5nczonLCB7XHJcbiAgICAgIGNsZWFuZXJJZCxcclxuICAgICAgZmlsdGVyLFxyXG4gICAgICBzaW5nbGVCb29raW5nc0NvdW50OiBzaW5nbGVSZXN1bHQuZGF0YT8ubGVuZ3RoIHx8IDAsXHJcbiAgICAgIGFycmF5Qm9va2luZ3NDb3VudDogYXJyYXlSZXN1bHQuZGF0YT8ubGVuZ3RoIHx8IDAsXHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBGaWx0ZXIgYm9va2luZ3Mgd2hlcmUgcHJlZmVycmVkX2NsZWFuZXJfaWRzIGFycmF5IGNvbnRhaW5zIHRoaXMgY2xlYW5lcklkXHJcbiAgICAvLyBOb3JtYWxpemUgVVVJRHMgZm9yIGNvbXBhcmlzb24gKGhhbmRsZSBjYXNlIGRpZmZlcmVuY2VzIGFuZCBzdHJpbmcgZm9ybWF0cylcclxuICAgIGNvbnN0IG5vcm1hbGl6ZVV1aWQgPSAoaWQ6IGFueSk6IHN0cmluZyA9PiB7XHJcbiAgICAgIGlmICghaWQpIHJldHVybiAnJztcclxuICAgICAgcmV0dXJuIFN0cmluZyhpZCkudG9Mb3dlckNhc2UoKS50cmltKCk7XHJcbiAgICB9O1xyXG4gICAgY29uc3Qgbm9ybWFsaXplZENsZWFuZXJJZCA9IG5vcm1hbGl6ZVV1aWQoY2xlYW5lcklkKTtcclxuICAgIFxyXG4gICAgY29uc3QgZmlsdGVyZWRBcnJheUJvb2tpbmdzID0gKGFycmF5UmVzdWx0LmRhdGEgfHwgW10pLmZpbHRlcigoYm9va2luZzogYW55KSA9PiB7XHJcbiAgICAgIGlmICghYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMgfHwgIUFycmF5LmlzQXJyYXkoYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMpKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICAgIC8vIENoZWNrIGlmIGFycmF5IGlzIGVtcHR5XHJcbiAgICAgIGlmIChib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgLy8gQ2hlY2sgaWYgYW55IElEIGluIHRoZSBhcnJheSBtYXRjaGVzIHRoZSBjbGVhbmVySWQgKGNhc2UtaW5zZW5zaXRpdmUpXHJcbiAgICAgIHJldHVybiBib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcy5zb21lKChpZDogc3RyaW5nKSA9PiBub3JtYWxpemVVdWlkKGlkKSA9PT0gbm9ybWFsaXplZENsZWFuZXJJZCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBDb21iaW5lIHJlc3VsdHMgYW5kIHJlbW92ZSBkdXBsaWNhdGVzXHJcbiAgICBjb25zdCBhbGxCb29raW5ncyA9IFtcclxuICAgICAgLi4uKHNpbmdsZVJlc3VsdC5kYXRhIHx8IFtdKSxcclxuICAgICAgLi4uZmlsdGVyZWRBcnJheUJvb2tpbmdzXHJcbiAgICBdO1xyXG5cclxuICAgIC8vIFJlbW92ZSBkdXBsaWNhdGVzIGJ5IGJvb2tpbmcgSURcclxuICAgIGNvbnN0IHVuaXF1ZUJvb2tpbmdzTWFwID0gbmV3IE1hcDxzdHJpbmcsIEJvb2tpbmc+KCk7XHJcbiAgICBhbGxCb29raW5ncy5mb3JFYWNoKChib29raW5nOiBhbnkpID0+IHtcclxuICAgICAgaWYgKGJvb2tpbmcuaWQgJiYgIXVuaXF1ZUJvb2tpbmdzTWFwLmhhcyhib29raW5nLmlkKSkge1xyXG4gICAgICAgIHVuaXF1ZUJvb2tpbmdzTWFwLnNldChib29raW5nLmlkLCBib29raW5nIGFzIEJvb2tpbmcpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBib29raW5ncyA9IEFycmF5LmZyb20odW5pcXVlQm9va2luZ3NNYXAudmFsdWVzKCkpO1xyXG5cclxuICAgIC8vIFNvcnQgYnkgc2VydmljZV9kYXRlIGFuZCBzZXJ2aWNlX3RpbWVcclxuICAgIGJvb2tpbmdzLnNvcnQoKGEsIGIpID0+IHtcclxuICAgICAgY29uc3QgZGF0ZUNvbXBhcmUgPSBhLnNlcnZpY2VfZGF0ZS5sb2NhbGVDb21wYXJlKGIuc2VydmljZV9kYXRlKTtcclxuICAgICAgaWYgKGRhdGVDb21wYXJlICE9PSAwKSByZXR1cm4gZGF0ZUNvbXBhcmU7XHJcbiAgICAgIHJldHVybiBhLnNlcnZpY2VfdGltZS5sb2NhbGVDb21wYXJlKGIuc2VydmljZV90aW1lKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGJvb2tpbmdzIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIGdldENsZWFuZXJCb29raW5nczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0ZhaWxlZCB0byBmZXRjaCBib29raW5ncycsXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIENhbGN1bGF0ZSBjbGVhbmVyIGVhcm5pbmdzIGZvciBhIHNwZWNpZmljIGJvb2tpbmdcclxuICogVGhpcyBoZWxwZXIgZnVuY3Rpb24gaXMgdXNlZCB0byBkaXNwbGF5IGVhcm5pbmdzIG9uIGJvb2tpbmcgZGV0YWlscyBwYWdlXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2FsY3VsYXRlQm9va2luZ0Vhcm5pbmdzKGJvb2tpbmdJZDogc3RyaW5nKTogUHJvbWlzZTx7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBlYXJuaW5ncz86IHtcclxuICAgIGJhc2VFYXJuaW5nczogbnVtYmVyO1xyXG4gICAgdGlwQW1vdW50OiBudW1iZXI7XHJcbiAgICB0b3RhbEVhcm5pbmdzOiBudW1iZXI7XHJcbiAgICBlYXJuaW5nc1BlcmNlbnRhZ2U6IG51bWJlcjtcclxuICB9O1xyXG4gIGVycm9yPzogc3RyaW5nO1xyXG59PiB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIEdldCBhdXRoZW50aWNhdGVkIGNsZWFuZXIgZmlyc3RcclxuICAgIGNvbnN0IGNsZWFuZXJSZXN1bHQgPSBhd2FpdCBnZXRDdXJyZW50Q2xlYW5lcigpO1xyXG4gICAgaWYgKCFjbGVhbmVyUmVzdWx0LnN1Y2Nlc3MgfHwgIWNsZWFuZXJSZXN1bHQuY2xlYW5lcikge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdOb3QgYXV0aGVudGljYXRlZCBvciBjbGVhbmVyIHByb2ZpbGUgbm90IGZvdW5kJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGNsZWFuZXJJZCA9IGNsZWFuZXJSZXN1bHQuY2xlYW5lci5pZDtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQ2xpZW50KCk7XHJcblxyXG4gICAgLy8gR2V0IGNsZWFuZXIgaW5mbyBmb3IgdGVudXJlIGNhbGN1bGF0aW9uXHJcbiAgICBjb25zdCB7IGRhdGE6IGNsZWFuZXIsIGVycm9yOiBjbGVhbmVyRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdjbGVhbmVycycpXHJcbiAgICAgIC5zZWxlY3QoJ2NyZWF0ZWRfYXQnKVxyXG4gICAgICAuZXEoJ2lkJywgY2xlYW5lcklkKVxyXG4gICAgICAubWF5YmVTaW5nbGUoKTtcclxuXHJcbiAgICBpZiAoY2xlYW5lckVycm9yIHx8ICFjbGVhbmVyKSB7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0NsZWFuZXIgbm90IGZvdW5kJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEdldCB0aGUgYm9va2luZ1xyXG4gICAgY29uc3QgeyBkYXRhOiBib29raW5nLCBlcnJvcjogYm9va2luZ0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnYm9va2luZ3MnKVxyXG4gICAgICAuc2VsZWN0KCcqJylcclxuICAgICAgLmVxKCdpZCcsIGJvb2tpbmdJZClcclxuICAgICAgLm1heWJlU2luZ2xlKCk7XHJcblxyXG4gICAgaWYgKGJvb2tpbmdFcnJvciB8fCAhYm9va2luZykge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdCb29raW5nIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDYWxjdWxhdGUgdGVudXJlIGFuZCB0b3RhbCBob3VycyB0byBkZXRlcm1pbmUgcGVyY2VudGFnZVxyXG4gICAgLy8gRm9yIHNpbmdsZSBib29raW5nIGRpc3BsYXksIHdlIG5lZWQgYWxsIHBhaWQgY29tcGxldGVkIGJvb2tpbmdzIHRvIGNhbGN1bGF0ZSBob3Vyc1xyXG4gICAgLy8gVXNlIHRoZSBzYW1lIGFwcHJvYWNoIGFzIGdldENsZWFuZXJTdGF0c1xyXG4gICAgY29uc3QgeyBkYXRhOiBzaW5nbGVCb29raW5ncyB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2Jvb2tpbmdzJylcclxuICAgICAgLnNlbGVjdCgnc3RhdHVzLCBwYXltZW50X3N0YXR1cywgc2VydmljZV9kdXJhdGlvbiwgcHJlZmVycmVkX2NsZWFuZXJfaWQsIHByZWZlcnJlZF9jbGVhbmVyX2lkcycpXHJcbiAgICAgIC5lcSgncHJlZmVycmVkX2NsZWFuZXJfaWQnLCBjbGVhbmVySWQpO1xyXG5cclxuICAgIGNvbnN0IHsgZGF0YTogYWxsTXVsdGlCb29raW5ncyB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2Jvb2tpbmdzJylcclxuICAgICAgLnNlbGVjdCgnc3RhdHVzLCBwYXltZW50X3N0YXR1cywgc2VydmljZV9kdXJhdGlvbiwgcHJlZmVycmVkX2NsZWFuZXJfaWQsIHByZWZlcnJlZF9jbGVhbmVyX2lkcycpXHJcbiAgICAgIC5ub3QoJ3ByZWZlcnJlZF9jbGVhbmVyX2lkcycsICdpcycsIG51bGwpO1xyXG5cclxuICAgIC8vIEZpbHRlciBib29raW5ncyBhc3NpZ25lZCB0byB0aGlzIGNsZWFuZXJcclxuICAgIGNvbnN0IG5vcm1hbGl6ZVV1aWQgPSAoaWQ6IGFueSk6IHN0cmluZyA9PiB7XHJcbiAgICAgIGlmICghaWQpIHJldHVybiAnJztcclxuICAgICAgcmV0dXJuIFN0cmluZyhpZCkudG9Mb3dlckNhc2UoKS50cmltKCk7XHJcbiAgICB9O1xyXG4gICAgY29uc3Qgbm9ybWFsaXplZENsZWFuZXJJZCA9IG5vcm1hbGl6ZVV1aWQoY2xlYW5lcklkKTtcclxuXHJcbiAgICBjb25zdCBhcnJheUJvb2tpbmdzID0gKGFsbE11bHRpQm9va2luZ3MgfHwgW10pLmZpbHRlcigoYjogYW55KSA9PiB7XHJcbiAgICAgIGlmICghYi5wcmVmZXJyZWRfY2xlYW5lcl9pZHMgfHwgIUFycmF5LmlzQXJyYXkoYi5wcmVmZXJyZWRfY2xlYW5lcl9pZHMpKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChiLnByZWZlcnJlZF9jbGVhbmVyX2lkcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGIucHJlZmVycmVkX2NsZWFuZXJfaWRzLnNvbWUoKGlkOiBzdHJpbmcpID0+IG5vcm1hbGl6ZVV1aWQoaWQpID09PSBub3JtYWxpemVkQ2xlYW5lcklkKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIENvbWJpbmUgYW5kIHJlbW92ZSBkdXBsaWNhdGVzXHJcbiAgICBjb25zdCBhbGxCb29raW5nc01hcCA9IG5ldyBNYXA8c3RyaW5nLCBhbnk+KCk7XHJcbiAgICAoc2luZ2xlQm9va2luZ3MgfHwgW10pLmZvckVhY2goKGI6IGFueSkgPT4ge1xyXG4gICAgICBpZiAoYi5pZCkge1xyXG4gICAgICAgIGFsbEJvb2tpbmdzTWFwLnNldChiLmlkLCBiKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBhcnJheUJvb2tpbmdzLmZvckVhY2goKGI6IGFueSkgPT4ge1xyXG4gICAgICBpZiAoYi5pZCAmJiAhYWxsQm9va2luZ3NNYXAuaGFzKGIuaWQpKSB7XHJcbiAgICAgICAgYWxsQm9va2luZ3NNYXAuc2V0KGIuaWQsIGIpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBjbGVhbmVyQm9va2luZ3MgPSBBcnJheS5mcm9tKGFsbEJvb2tpbmdzTWFwLnZhbHVlcygpKTtcclxuXHJcbiAgICBjb25zdCB0ZW51cmVNb250aHMgPSBjYWxjdWxhdGVDbGVhbmVyVGVudXJlKGNsZWFuZXIuY3JlYXRlZF9hdCk7XHJcbiAgICBjb25zdCB0b3RhbEhvdXJzID0gY2FsY3VsYXRlVG90YWxIb3VycyhjbGVhbmVyQm9va2luZ3MpO1xyXG4gICAgY29uc3QgZWFybmluZ3NQZXJjZW50YWdlID0gZ2V0RWFybmluZ3NQZXJjZW50YWdlKHRlbnVyZU1vbnRocywgdG90YWxIb3Vycyk7XHJcblxyXG4gICAgLy8gQ2FsY3VsYXRlIGJhc2UgZWFybmluZ3NcclxuICAgIGNvbnN0IGJhc2VFYXJuaW5ncyA9IGNhbGN1bGF0ZUNsZWFuZXJFYXJuaW5ncyhcclxuICAgICAge1xyXG4gICAgICAgIHNlcnZpY2VfdHlwZTogYm9va2luZy5zZXJ2aWNlX3R5cGUgfHwgJycsXHJcbiAgICAgICAgdG90YWxfYW1vdW50OiBOdW1iZXIoYm9va2luZy50b3RhbF9hbW91bnQpIHx8IDAsXHJcbiAgICAgICAgc2VydmljZV9mZWU6IE51bWJlcihib29raW5nLnNlcnZpY2VfZmVlKSB8fCAwLFxyXG4gICAgICAgIHByZWZlcnJlZF9jbGVhbmVyX2lkczogYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMsXHJcbiAgICAgICAgcHJlZmVycmVkX2NsZWFuZXJfaWQ6IGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWQsXHJcbiAgICAgIH0sXHJcbiAgICAgIGNsZWFuZXJJZCxcclxuICAgICAgZWFybmluZ3NQZXJjZW50YWdlLFxyXG4gICAgICBib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkc1xyXG4gICAgKTtcclxuXHJcbiAgICAvLyBDYWxjdWxhdGUgdGlwIHBlciBjbGVhbmVyXHJcbiAgICBjb25zdCB0aXBBbW91bnQgPSBjYWxjdWxhdGVUaXBQZXJDbGVhbmVyKFxyXG4gICAgICBOdW1iZXIoYm9va2luZy50aXBfYW1vdW50KSB8fCAwLFxyXG4gICAgICBib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcyxcclxuICAgICAgYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZFxyXG4gICAgKTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICBlYXJuaW5nczoge1xyXG4gICAgICAgIGJhc2VFYXJuaW5ncyxcclxuICAgICAgICB0aXBBbW91bnQsXHJcbiAgICAgICAgdG90YWxFYXJuaW5nczogYmFzZUVhcm5pbmdzICsgdGlwQW1vdW50LFxyXG4gICAgICAgIGVhcm5pbmdzUGVyY2VudGFnZSxcclxuICAgICAgfSxcclxuICAgIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNhbGN1bGF0aW5nIGJvb2tpbmcgZWFybmluZ3M6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdGYWlsZWQgdG8gY2FsY3VsYXRlIGVhcm5pbmdzJyxcclxuICAgIH07XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogR2V0IGEgc3BlY2lmaWMgYm9va2luZyBieSBJRCAob25seSBpZiBhc3NpZ25lZCB0byBhdXRoZW50aWNhdGVkIGNsZWFuZXIpXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q2xlYW5lckJvb2tpbmdCeUlkKFxyXG4gIGJvb2tpbmdJZDogc3RyaW5nXHJcbik6IFByb21pc2U8e1xyXG4gIHN1Y2Nlc3M6IGJvb2xlYW47XHJcbiAgYm9va2luZz86IEJvb2tpbmc7XHJcbiAgZXJyb3I/OiBzdHJpbmc7XHJcbn0+IHtcclxuICB0cnkge1xyXG4gICAgLy8gR2V0IGF1dGhlbnRpY2F0ZWQgY2xlYW5lciBmaXJzdFxyXG4gICAgY29uc3QgY2xlYW5lclJlc3VsdCA9IGF3YWl0IGdldEN1cnJlbnRDbGVhbmVyKCk7XHJcbiAgICBpZiAoIWNsZWFuZXJSZXN1bHQuc3VjY2VzcyB8fCAhY2xlYW5lclJlc3VsdC5jbGVhbmVyKSB7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ05vdCBhdXRoZW50aWNhdGVkIG9yIGNsZWFuZXIgcHJvZmlsZSBub3QgZm91bmQnIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgY2xlYW5lcklkID0gY2xlYW5lclJlc3VsdC5jbGVhbmVyLmlkO1xyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBhd2FpdCBjcmVhdGVDbGllbnQoKTtcclxuXHJcbiAgICAvLyBGZXRjaCB0aGUgYm9va2luZ1xyXG4gICAgY29uc3QgeyBkYXRhOiBib29raW5nLCBlcnJvcjogZmV0Y2hFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2Jvb2tpbmdzJylcclxuICAgICAgLnNlbGVjdCgnKicpXHJcbiAgICAgIC5lcSgnaWQnLCBib29raW5nSWQpXHJcbiAgICAgIC5tYXliZVNpbmdsZSgpO1xyXG5cclxuICAgIGlmIChmZXRjaEVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGJvb2tpbmc6JywgZmV0Y2hFcnJvcik7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0Jvb2tpbmcgbm90IGZvdW5kJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIGlmICghYm9va2luZykge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdCb29raW5nIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBWZXJpZnkgdGhlIGNsZWFuZXIgaXMgYXNzaWduZWQgdG8gdGhpcyBib29raW5nXHJcbiAgICBjb25zdCBub3JtYWxpemVVdWlkID0gKGlkOiBhbnkpOiBzdHJpbmcgPT4ge1xyXG4gICAgICBpZiAoIWlkKSByZXR1cm4gJyc7XHJcbiAgICAgIHJldHVybiBTdHJpbmcoaWQpLnRvTG93ZXJDYXNlKCkudHJpbSgpO1xyXG4gICAgfTtcclxuICAgIGNvbnN0IG5vcm1hbGl6ZWRDbGVhbmVySWQgPSBub3JtYWxpemVVdWlkKGNsZWFuZXJJZCk7XHJcblxyXG4gICAgLy8gQ2hlY2sgc2luZ2xlIGNsZWFuZXIgYXNzaWdubWVudFxyXG4gICAgY29uc3QgaXNBc3NpZ25lZFNpbmdsZSA9IGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWQgJiYgXHJcbiAgICAgIG5vcm1hbGl6ZVV1aWQoYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZCkgPT09IG5vcm1hbGl6ZWRDbGVhbmVySWQ7XHJcblxyXG4gICAgLy8gQ2hlY2sgbXVsdGlwbGUgY2xlYW5lciBhc3NpZ25tZW50XHJcbiAgICBsZXQgaXNBc3NpZ25lZE11bHRpcGxlID0gZmFsc2U7XHJcbiAgICBpZiAoYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMgJiYgQXJyYXkuaXNBcnJheShib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcykpIHtcclxuICAgICAgaXNBc3NpZ25lZE11bHRpcGxlID0gYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMuc29tZShcclxuICAgICAgICAoaWQ6IHN0cmluZykgPT4gbm9ybWFsaXplVXVpZChpZCkgPT09IG5vcm1hbGl6ZWRDbGVhbmVySWRcclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIWlzQXNzaWduZWRTaW5nbGUgJiYgIWlzQXNzaWduZWRNdWx0aXBsZSkge1xyXG4gICAgICByZXR1cm4geyBcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSwgXHJcbiAgICAgICAgZXJyb3I6ICdVbmF1dGhvcml6ZWQ6IFlvdSBhcmUgbm90IGFzc2lnbmVkIHRvIHRoaXMgYm9va2luZycgXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgYm9va2luZzogYm9va2luZyBhcyBCb29raW5nIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIGdldENsZWFuZXJCb29raW5nQnlJZDonLCBlcnJvcik7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0ZhaWxlZCB0byBmZXRjaCBib29raW5nJyxcclxuICAgIH07XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogVXBkYXRlIGJvb2tpbmcgc3RhdHVzICh3aXRoIGF1dGhvcml6YXRpb24gY2hlY2sgZm9yIGF1dGhlbnRpY2F0ZWQgY2xlYW5lcilcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVCb29raW5nU3RhdHVzKFxyXG4gIGJvb2tpbmdJZDogc3RyaW5nLFxyXG4gIHN0YXR1czogQm9va2luZ1snc3RhdHVzJ11cclxuKTogUHJvbWlzZTx7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBib29raW5nPzogQm9va2luZztcclxuICBlcnJvcj86IHN0cmluZztcclxufT4ge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBHZXQgYXV0aGVudGljYXRlZCBjbGVhbmVyIGZpcnN0XHJcbiAgICBjb25zdCBjbGVhbmVyUmVzdWx0ID0gYXdhaXQgZ2V0Q3VycmVudENsZWFuZXIoKTtcclxuICAgIGlmICghY2xlYW5lclJlc3VsdC5zdWNjZXNzIHx8ICFjbGVhbmVyUmVzdWx0LmNsZWFuZXIpIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnTm90IGF1dGhlbnRpY2F0ZWQgb3IgY2xlYW5lciBwcm9maWxlIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBjbGVhbmVySWQgPSBjbGVhbmVyUmVzdWx0LmNsZWFuZXIuaWQ7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xyXG5cclxuICAgIC8vIEZpcnN0LCB2ZXJpZnkgdGhlIGNsZWFuZXIgaXMgYXNzaWduZWQgdG8gdGhpcyBib29raW5nXHJcbiAgICBjb25zdCB7IGRhdGE6IGJvb2tpbmcsIGVycm9yOiBmZXRjaEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnYm9va2luZ3MnKVxyXG4gICAgICAuc2VsZWN0KCcqJylcclxuICAgICAgLmVxKCdpZCcsIGJvb2tpbmdJZClcclxuICAgICAgLm1heWJlU2luZ2xlKCk7XHJcblxyXG4gICAgaWYgKGZldGNoRXJyb3IgfHwgIWJvb2tpbmcpIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnQm9va2luZyBub3QgZm91bmQnIH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2hlY2sgYXV0aG9yaXphdGlvbjogY2xlYW5lciBtdXN0IGJlIGFzc2lnbmVkIHRvIHRoaXMgYm9va2luZ1xyXG4gICAgY29uc3Qgbm9ybWFsaXplVXVpZCA9IChpZDogYW55KTogc3RyaW5nID0+IHtcclxuICAgICAgaWYgKCFpZCkgcmV0dXJuICcnO1xyXG4gICAgICByZXR1cm4gU3RyaW5nKGlkKS50b0xvd2VyQ2FzZSgpLnRyaW0oKTtcclxuICAgIH07XHJcbiAgICBjb25zdCBub3JtYWxpemVkQ2xlYW5lcklkID0gbm9ybWFsaXplVXVpZChjbGVhbmVySWQpO1xyXG5cclxuICAgIGNvbnN0IGlzQXNzaWduZWRTaW5nbGUgPSBib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkICYmIFxyXG4gICAgICBub3JtYWxpemVVdWlkKGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWQpID09PSBub3JtYWxpemVkQ2xlYW5lcklkO1xyXG5cclxuICAgIGxldCBpc0Fzc2lnbmVkTXVsdGlwbGUgPSBmYWxzZTtcclxuICAgIGlmIChib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcyAmJiBBcnJheS5pc0FycmF5KGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWRzKSkge1xyXG4gICAgICBpc0Fzc2lnbmVkTXVsdGlwbGUgPSBib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcy5zb21lKFxyXG4gICAgICAgIChpZDogc3RyaW5nKSA9PiBub3JtYWxpemVVdWlkKGlkKSA9PT0gbm9ybWFsaXplZENsZWFuZXJJZFxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGlzQXNzaWduZWQgPSBpc0Fzc2lnbmVkU2luZ2xlIHx8IGlzQXNzaWduZWRNdWx0aXBsZTtcclxuXHJcbiAgICBpZiAoIWlzQXNzaWduZWQpIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnVW5hdXRob3JpemVkOiBZb3UgYXJlIG5vdCBhc3NpZ25lZCB0byB0aGlzIGJvb2tpbmcnIH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVmFsaWRhdGUgc3RhdHVzIHRyYW5zaXRpb25cclxuICAgIGNvbnN0IHZhbGlkVHJhbnNpdGlvbnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZ1tdPiA9IHtcclxuICAgICAgJ3BlbmRpbmcnOiBbJ2NvbmZpcm1lZCcsICdjYW5jZWxsZWQnXSxcclxuICAgICAgJ2NvbmZpcm1lZCc6IFsnb25fbXlfd2F5JywgJ2NhbmNlbGxlZCddLFxyXG4gICAgICAnb25fbXlfd2F5JzogWydzdGFydGVkJywgJ2NhbmNlbGxlZCddLFxyXG4gICAgICAnc3RhcnRlZCc6IFsnY29tcGxldGVkJywgJ2NhbmNlbGxlZCddLFxyXG4gICAgICAnY29tcGxldGVkJzogW10sXHJcbiAgICAgICdjYW5jZWxsZWQnOiBbXSxcclxuICAgIH07XHJcblxyXG4gICAgY29uc3QgY3VycmVudFN0YXR1cyA9IGJvb2tpbmcuc3RhdHVzO1xyXG4gICAgY29uc3QgYWxsb3dlZFN0YXR1c2VzID0gdmFsaWRUcmFuc2l0aW9uc1tjdXJyZW50U3RhdHVzXSB8fCBbXTtcclxuICAgIFxyXG4gICAgaWYgKCFhbGxvd2VkU3RhdHVzZXMuaW5jbHVkZXMoc3RhdHVzKSAmJiBzdGF0dXMgIT09IGN1cnJlbnRTdGF0dXMpIHtcclxuICAgICAgcmV0dXJuIHsgXHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsIFxyXG4gICAgICAgIGVycm9yOiBgSW52YWxpZCBzdGF0dXMgdHJhbnNpdGlvbjogY2Fubm90IGNoYW5nZSBmcm9tICR7Y3VycmVudFN0YXR1c30gdG8gJHtzdGF0dXN9YCBcclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBVcGRhdGUgYm9va2luZyBzdGF0dXNcclxuICAgIGNvbnN0IHsgZGF0YTogdXBkYXRlZEJvb2tpbmcsIGVycm9yOiB1cGRhdGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2Jvb2tpbmdzJylcclxuICAgICAgLnVwZGF0ZSh7IFxyXG4gICAgICAgIHN0YXR1cyxcclxuICAgICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgIH0pXHJcbiAgICAgIC5lcSgnaWQnLCBib29raW5nSWQpXHJcbiAgICAgIC5zZWxlY3QoKVxyXG4gICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgaWYgKHVwZGF0ZUVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGJvb2tpbmcgc3RhdHVzOicsIHVwZGF0ZUVycm9yKTtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiB1cGRhdGVFcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgYm9va2luZzogdXBkYXRlZEJvb2tpbmcgYXMgQm9va2luZyB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiB1cGRhdGVCb29raW5nU3RhdHVzOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnRmFpbGVkIHRvIHVwZGF0ZSBib29raW5nIHN0YXR1cycsXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFJlcG9ydCBsYXRlbmVzcyBmb3IgYSBib29raW5nICh3aXRoIGF1dGhvcml6YXRpb24gY2hlY2sgZm9yIGF1dGhlbnRpY2F0ZWQgY2xlYW5lcilcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXBvcnRMYXRlbmVzcyhcclxuICBib29raW5nSWQ6IHN0cmluZyxcclxuICBleHBlY3RlZEFycml2YWxUaW1lOiBzdHJpbmcsIC8vIElTTyB0aW1lc3RhbXBcclxuICByZWFzb246IHN0cmluZ1xyXG4pOiBQcm9taXNlPHtcclxuICBzdWNjZXNzOiBib29sZWFuO1xyXG4gIGJvb2tpbmc/OiBCb29raW5nO1xyXG4gIGVycm9yPzogc3RyaW5nO1xyXG59PiB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIEdldCBhdXRoZW50aWNhdGVkIGNsZWFuZXIgZmlyc3RcclxuICAgIGNvbnN0IGNsZWFuZXJSZXN1bHQgPSBhd2FpdCBnZXRDdXJyZW50Q2xlYW5lcigpO1xyXG4gICAgaWYgKCFjbGVhbmVyUmVzdWx0LnN1Y2Nlc3MgfHwgIWNsZWFuZXJSZXN1bHQuY2xlYW5lcikge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdOb3QgYXV0aGVudGljYXRlZCBvciBjbGVhbmVyIHByb2ZpbGUgbm90IGZvdW5kJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGNsZWFuZXJJZCA9IGNsZWFuZXJSZXN1bHQuY2xlYW5lci5pZDtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQ2xpZW50KCk7XHJcblxyXG4gICAgLy8gVmVyaWZ5IGF1dGhvcml6YXRpb25cclxuICAgIGNvbnN0IHsgZGF0YTogYm9va2luZywgZXJyb3I6IGZldGNoRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdib29raW5ncycpXHJcbiAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAuZXEoJ2lkJywgYm9va2luZ0lkKVxyXG4gICAgICAubWF5YmVTaW5nbGUoKTtcclxuXHJcbiAgICBpZiAoZmV0Y2hFcnJvciB8fCAhYm9va2luZykge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdCb29raW5nIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDaGVjayBhdXRob3JpemF0aW9uOiBjbGVhbmVyIG11c3QgYmUgYXNzaWduZWQgdG8gdGhpcyBib29raW5nXHJcbiAgICBjb25zdCBub3JtYWxpemVVdWlkID0gKGlkOiBhbnkpOiBzdHJpbmcgPT4ge1xyXG4gICAgICBpZiAoIWlkKSByZXR1cm4gJyc7XHJcbiAgICAgIHJldHVybiBTdHJpbmcoaWQpLnRvTG93ZXJDYXNlKCkudHJpbSgpO1xyXG4gICAgfTtcclxuICAgIGNvbnN0IG5vcm1hbGl6ZWRDbGVhbmVySWQgPSBub3JtYWxpemVVdWlkKGNsZWFuZXJJZCk7XHJcblxyXG4gICAgY29uc3QgaXNBc3NpZ25lZFNpbmdsZSA9IGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWQgJiYgXHJcbiAgICAgIG5vcm1hbGl6ZVV1aWQoYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZCkgPT09IG5vcm1hbGl6ZWRDbGVhbmVySWQ7XHJcblxyXG4gICAgbGV0IGlzQXNzaWduZWRNdWx0aXBsZSA9IGZhbHNlO1xyXG4gICAgaWYgKGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWRzICYmIEFycmF5LmlzQXJyYXkoYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMpKSB7XHJcbiAgICAgIGlzQXNzaWduZWRNdWx0aXBsZSA9IGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWRzLnNvbWUoXHJcbiAgICAgICAgKGlkOiBzdHJpbmcpID0+IG5vcm1hbGl6ZVV1aWQoaWQpID09PSBub3JtYWxpemVkQ2xlYW5lcklkXHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgaXNBc3NpZ25lZCA9IGlzQXNzaWduZWRTaW5nbGUgfHwgaXNBc3NpZ25lZE11bHRpcGxlO1xyXG5cclxuICAgIGlmICghaXNBc3NpZ25lZCkge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdVbmF1dGhvcml6ZWQ6IFlvdSBhcmUgbm90IGFzc2lnbmVkIHRvIHRoaXMgYm9va2luZycgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBVcGRhdGUgYm9va2luZyB3aXRoIGxhdGVuZXNzIGluZm9ybWF0aW9uXHJcbiAgICBjb25zdCB7IGRhdGE6IHVwZGF0ZWRCb29raW5nLCBlcnJvcjogdXBkYXRlRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdib29raW5ncycpXHJcbiAgICAgIC51cGRhdGUoe1xyXG4gICAgICAgIGV4cGVjdGVkX2Fycml2YWxfdGltZTogZXhwZWN0ZWRBcnJpdmFsVGltZSxcclxuICAgICAgICBsYXRlbmVzc19yZWFzb246IHJlYXNvbixcclxuICAgICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgIH0pXHJcbiAgICAgIC5lcSgnaWQnLCBib29raW5nSWQpXHJcbiAgICAgIC5zZWxlY3QoKVxyXG4gICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgaWYgKHVwZGF0ZUVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlcG9ydGluZyBsYXRlbmVzczonLCB1cGRhdGVFcnJvcik7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogdXBkYXRlRXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGJvb2tpbmc6IHVwZGF0ZWRCb29raW5nIGFzIEJvb2tpbmcgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gcmVwb3J0TGF0ZW5lc3M6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdGYWlsZWQgdG8gcmVwb3J0IGxhdGVuZXNzJyxcclxuICAgIH07XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogQ2FsY3VsYXRlIGVhcm5pbmdzIGZvciBtdWx0aXBsZSBib29raW5ncyBhdCBvbmNlXHJcbiAqIFRoaXMgaXMgbW9yZSBlZmZpY2llbnQgdGhhbiBjYWxjdWxhdGluZyBlYXJuaW5ncyBvbmUgYm9va2luZyBhdCBhIHRpbWVcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjYWxjdWxhdGVCb29raW5nc0Vhcm5pbmdzKGJvb2tpbmdJZHM6IHN0cmluZ1tdKTogUHJvbWlzZTx7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBlYXJuaW5ncz86IFJlY29yZDxzdHJpbmcsIHsgYmFzZUVhcm5pbmdzOiBudW1iZXI7IHRpcEFtb3VudDogbnVtYmVyOyB0b3RhbEVhcm5pbmdzOiBudW1iZXIgfT47XHJcbiAgZXJyb3I/OiBzdHJpbmc7XHJcbn0+IHtcclxuICB0cnkge1xyXG4gICAgLy8gR2V0IGF1dGhlbnRpY2F0ZWQgY2xlYW5lciBmaXJzdFxyXG4gICAgY29uc3QgY2xlYW5lclJlc3VsdCA9IGF3YWl0IGdldEN1cnJlbnRDbGVhbmVyKCk7XHJcbiAgICBpZiAoIWNsZWFuZXJSZXN1bHQuc3VjY2VzcyB8fCAhY2xlYW5lclJlc3VsdC5jbGVhbmVyKSB7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ05vdCBhdXRoZW50aWNhdGVkIG9yIGNsZWFuZXIgcHJvZmlsZSBub3QgZm91bmQnIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgY2xlYW5lcklkID0gY2xlYW5lclJlc3VsdC5jbGVhbmVyLmlkO1xyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBhd2FpdCBjcmVhdGVDbGllbnQoKTtcclxuXHJcbiAgICBpZiAoYm9va2luZ0lkcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZWFybmluZ3M6IHt9IH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gR2V0IGNsZWFuZXIgaW5mbyBmb3IgdGVudXJlIGNhbGN1bGF0aW9uXHJcbiAgICBjb25zdCB7IGRhdGE6IGNsZWFuZXIsIGVycm9yOiBjbGVhbmVyRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdjbGVhbmVycycpXHJcbiAgICAgIC5zZWxlY3QoJ2NyZWF0ZWRfYXQnKVxyXG4gICAgICAuZXEoJ2lkJywgY2xlYW5lcklkKVxyXG4gICAgICAubWF5YmVTaW5nbGUoKTtcclxuXHJcbiAgICBpZiAoY2xlYW5lckVycm9yIHx8ICFjbGVhbmVyKSB7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0NsZWFuZXIgbm90IGZvdW5kJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEdldCBhbGwgYm9va2luZ3NcclxuICAgIGNvbnN0IHsgZGF0YTogYm9va2luZ3MsIGVycm9yOiBib29raW5nc0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnYm9va2luZ3MnKVxyXG4gICAgICAuc2VsZWN0KCcqJylcclxuICAgICAgLmluKCdpZCcsIGJvb2tpbmdJZHMpO1xyXG5cclxuICAgIGlmIChib29raW5nc0Vycm9yIHx8ICFib29raW5ncykge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdGYWlsZWQgdG8gZmV0Y2ggYm9va2luZ3MnIH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gR2V0IGFsbCBjbGVhbmVyIGJvb2tpbmdzIHRvIGNhbGN1bGF0ZSBob3Vyc1xyXG4gICAgY29uc3QgeyBkYXRhOiBzaW5nbGVCb29raW5ncyB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2Jvb2tpbmdzJylcclxuICAgICAgLnNlbGVjdCgnc3RhdHVzLCBwYXltZW50X3N0YXR1cywgc2VydmljZV9kdXJhdGlvbiwgcHJlZmVycmVkX2NsZWFuZXJfaWQsIHByZWZlcnJlZF9jbGVhbmVyX2lkcycpXHJcbiAgICAgIC5lcSgncHJlZmVycmVkX2NsZWFuZXJfaWQnLCBjbGVhbmVySWQpO1xyXG5cclxuICAgIGNvbnN0IHsgZGF0YTogYWxsTXVsdGlCb29raW5ncyB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2Jvb2tpbmdzJylcclxuICAgICAgLnNlbGVjdCgnc3RhdHVzLCBwYXltZW50X3N0YXR1cywgc2VydmljZV9kdXJhdGlvbiwgcHJlZmVycmVkX2NsZWFuZXJfaWQsIHByZWZlcnJlZF9jbGVhbmVyX2lkcycpXHJcbiAgICAgIC5ub3QoJ3ByZWZlcnJlZF9jbGVhbmVyX2lkcycsICdpcycsIG51bGwpO1xyXG5cclxuICAgIC8vIEZpbHRlciBib29raW5ncyBhc3NpZ25lZCB0byB0aGlzIGNsZWFuZXJcclxuICAgIGNvbnN0IG5vcm1hbGl6ZVV1aWQgPSAoaWQ6IGFueSk6IHN0cmluZyA9PiB7XHJcbiAgICAgIGlmICghaWQpIHJldHVybiAnJztcclxuICAgICAgcmV0dXJuIFN0cmluZyhpZCkudG9Mb3dlckNhc2UoKS50cmltKCk7XHJcbiAgICB9O1xyXG4gICAgY29uc3Qgbm9ybWFsaXplZENsZWFuZXJJZCA9IG5vcm1hbGl6ZVV1aWQoY2xlYW5lcklkKTtcclxuXHJcbiAgICBjb25zdCBhcnJheUJvb2tpbmdzID0gKGFsbE11bHRpQm9va2luZ3MgfHwgW10pLmZpbHRlcigoYjogYW55KSA9PiB7XHJcbiAgICAgIGlmICghYi5wcmVmZXJyZWRfY2xlYW5lcl9pZHMgfHwgIUFycmF5LmlzQXJyYXkoYi5wcmVmZXJyZWRfY2xlYW5lcl9pZHMpKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChiLnByZWZlcnJlZF9jbGVhbmVyX2lkcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGIucHJlZmVycmVkX2NsZWFuZXJfaWRzLnNvbWUoKGlkOiBzdHJpbmcpID0+IG5vcm1hbGl6ZVV1aWQoaWQpID09PSBub3JtYWxpemVkQ2xlYW5lcklkKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIENvbWJpbmUgYW5kIHJlbW92ZSBkdXBsaWNhdGVzXHJcbiAgICBjb25zdCBhbGxCb29raW5nc01hcCA9IG5ldyBNYXA8c3RyaW5nLCBhbnk+KCk7XHJcbiAgICAoc2luZ2xlQm9va2luZ3MgfHwgW10pLmZvckVhY2goKGI6IGFueSkgPT4ge1xyXG4gICAgICBpZiAoYi5pZCkge1xyXG4gICAgICAgIGFsbEJvb2tpbmdzTWFwLnNldChiLmlkLCBiKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBhcnJheUJvb2tpbmdzLmZvckVhY2goKGI6IGFueSkgPT4ge1xyXG4gICAgICBpZiAoYi5pZCAmJiAhYWxsQm9va2luZ3NNYXAuaGFzKGIuaWQpKSB7XHJcbiAgICAgICAgYWxsQm9va2luZ3NNYXAuc2V0KGIuaWQsIGIpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBjbGVhbmVyQm9va2luZ3MgPSBBcnJheS5mcm9tKGFsbEJvb2tpbmdzTWFwLnZhbHVlcygpKTtcclxuXHJcbiAgICAvLyBDYWxjdWxhdGUgdGVudXJlIGFuZCBob3Vyc1xyXG4gICAgY29uc3QgdGVudXJlTW9udGhzID0gY2FsY3VsYXRlQ2xlYW5lclRlbnVyZShjbGVhbmVyLmNyZWF0ZWRfYXQpO1xyXG4gICAgY29uc3QgdG90YWxIb3VycyA9IGNhbGN1bGF0ZVRvdGFsSG91cnMoY2xlYW5lckJvb2tpbmdzKTtcclxuICAgIGNvbnN0IGVhcm5pbmdzUGVyY2VudGFnZSA9IGdldEVhcm5pbmdzUGVyY2VudGFnZSh0ZW51cmVNb250aHMsIHRvdGFsSG91cnMpO1xyXG5cclxuICAgIC8vIENhbGN1bGF0ZSBlYXJuaW5ncyBmb3IgZWFjaCBib29raW5nXHJcbiAgICBjb25zdCBlYXJuaW5nc1JlY29yZDogUmVjb3JkPHN0cmluZywgeyBiYXNlRWFybmluZ3M6IG51bWJlcjsgdGlwQW1vdW50OiBudW1iZXI7IHRvdGFsRWFybmluZ3M6IG51bWJlciB9PiA9IHt9O1xyXG5cclxuICAgIGZvciAoY29uc3QgYm9va2luZyBvZiBib29raW5ncykge1xyXG4gICAgICBjb25zdCBiYXNlRWFybmluZ3MgPSBjYWxjdWxhdGVDbGVhbmVyRWFybmluZ3MoXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgc2VydmljZV90eXBlOiBib29raW5nLnNlcnZpY2VfdHlwZSB8fCAnJyxcclxuICAgICAgICAgIHRvdGFsX2Ftb3VudDogTnVtYmVyKGJvb2tpbmcudG90YWxfYW1vdW50KSB8fCAwLFxyXG4gICAgICAgICAgc2VydmljZV9mZWU6IE51bWJlcihib29raW5nLnNlcnZpY2VfZmVlKSB8fCAwLFxyXG4gICAgICAgICAgZXF1aXBtZW50X3N1cHBseV9wcmljZTogTnVtYmVyKGJvb2tpbmcuZXF1aXBtZW50X3N1cHBseV9wcmljZSkgfHwgMCxcclxuICAgICAgICAgIGFkZGl0aW9uYWxfY2xlYW5lcnNfcHJpY2U6IE51bWJlcihib29raW5nLmFkZGl0aW9uYWxfY2xlYW5lcnNfcHJpY2UpIHx8IDAsXHJcbiAgICAgICAgICBwcmVmZXJyZWRfY2xlYW5lcl9pZHM6IGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWRzLFxyXG4gICAgICAgICAgcHJlZmVycmVkX2NsZWFuZXJfaWQ6IGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWQsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBjbGVhbmVySWQsXHJcbiAgICAgICAgZWFybmluZ3NQZXJjZW50YWdlLFxyXG4gICAgICAgIGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWRzXHJcbiAgICAgICk7XHJcblxyXG4gICAgICBjb25zdCB0aXBBbW91bnQgPSBjYWxjdWxhdGVUaXBQZXJDbGVhbmVyKFxyXG4gICAgICAgIE51bWJlcihib29raW5nLnRpcF9hbW91bnQpIHx8IDAsXHJcbiAgICAgICAgYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMsXHJcbiAgICAgICAgYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZFxyXG4gICAgICApO1xyXG5cclxuICAgICAgZWFybmluZ3NSZWNvcmRbYm9va2luZy5pZF0gPSB7XHJcbiAgICAgICAgYmFzZUVhcm5pbmdzLFxyXG4gICAgICAgIHRpcEFtb3VudCxcclxuICAgICAgICB0b3RhbEVhcm5pbmdzOiBiYXNlRWFybmluZ3MgKyB0aXBBbW91bnQsXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZWFybmluZ3M6IGVhcm5pbmdzUmVjb3JkIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNhbGN1bGF0aW5nIGJvb2tpbmdzIGVhcm5pbmdzOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnRmFpbGVkIHRvIGNhbGN1bGF0ZSBlYXJuaW5ncycsXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEdldCBjbGVhbmVyIHN0YXRpc3RpY3MgZm9yIHRoZSBhdXRoZW50aWNhdGVkIGNsZWFuZXJcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDbGVhbmVyU3RhdHMoKTogUHJvbWlzZTx7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBzdGF0cz86IHtcclxuICAgIHRvdGFsQm9va2luZ3M6IG51bWJlcjtcclxuICAgIGNvbXBsZXRlZEJvb2tpbmdzOiBudW1iZXI7XHJcbiAgICB1cGNvbWluZ0Jvb2tpbmdzOiBudW1iZXI7XHJcbiAgICB0b2RheUJvb2tpbmdzOiBudW1iZXI7XHJcbiAgICB0b3RhbEVhcm5pbmdzOiBudW1iZXI7XHJcbiAgICBtb250aGx5RWFybmluZ3M6IG51bWJlcjtcclxuICAgIGF2ZXJhZ2VSYXRpbmc6IG51bWJlcjtcclxuICAgIHJlbGlhYmlsaXR5U2NvcmU6IG51bWJlcjtcclxuICAgIGNvbXBsZXRpb25SYXRlOiBudW1iZXI7XHJcbiAgICBvblRpbWVSYXRlOiBudW1iZXI7XHJcbiAgfTtcclxuICBlcnJvcj86IHN0cmluZztcclxufT4ge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBHZXQgYXV0aGVudGljYXRlZCBjbGVhbmVyIGZpcnN0XHJcbiAgICBjb25zdCBjbGVhbmVyUmVzdWx0ID0gYXdhaXQgZ2V0Q3VycmVudENsZWFuZXIoKTtcclxuICAgIGlmICghY2xlYW5lclJlc3VsdC5zdWNjZXNzIHx8ICFjbGVhbmVyUmVzdWx0LmNsZWFuZXIpIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnTm90IGF1dGhlbnRpY2F0ZWQgb3IgY2xlYW5lciBwcm9maWxlIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBjbGVhbmVySWQgPSBjbGVhbmVyUmVzdWx0LmNsZWFuZXIuaWQ7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xyXG5cclxuICAgIC8vIEdldCBjbGVhbmVyIGluZm8gaW5jbHVkaW5nIGNyZWF0ZWRfYXQgZm9yIHRlbnVyZSBjYWxjdWxhdGlvblxyXG4gICAgY29uc3QgeyBkYXRhOiBjbGVhbmVyLCBlcnJvcjogY2xlYW5lckVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnY2xlYW5lcnMnKVxyXG4gICAgICAuc2VsZWN0KCdyYXRpbmcsIHJlbGlhYmlsaXR5X3Njb3JlLCB0b3RhbF9ib29raW5ncywgY29tcGxldGVkX2Jvb2tpbmdzLCBvbl90aW1lX2Jvb2tpbmdzLCBjcmVhdGVkX2F0JylcclxuICAgICAgLmVxKCdpZCcsIGNsZWFuZXJJZClcclxuICAgICAgLm1heWJlU2luZ2xlKCk7XHJcblxyXG4gICAgaWYgKGNsZWFuZXJFcnJvciB8fCAhY2xlYW5lcikge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdDbGVhbmVyIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBHZXQgYWxsIGJvb2tpbmdzIGFzc2lnbmVkIHRvIHRoaXMgY2xlYW5lclxyXG4gICAgLy8gRmV0Y2ggYm9va2luZ3Mgd2l0aCBwcmVmZXJyZWRfY2xlYW5lcl9pZCAoc2luZ2xlKSAtIGluY2x1ZGUgYWxsIGZpZWxkcyBuZWVkZWQgZm9yIGVhcm5pbmdzIGNhbGN1bGF0aW9uXHJcbiAgICBjb25zdCB7IGRhdGE6IHNpbmdsZUJvb2tpbmdzLCBlcnJvcjogc2luZ2xlRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdib29raW5ncycpXHJcbiAgICAgIC5zZWxlY3QoJ2lkLCBzdGF0dXMsIHNlcnZpY2VfZGF0ZSwgdG90YWxfYW1vdW50LCBwYXltZW50X3N0YXR1cywgc2VydmljZV90eXBlLCBzZXJ2aWNlX2ZlZSwgc3VidG90YWwsIHRpcF9hbW91bnQsIHNlcnZpY2VfZHVyYXRpb24sIGVxdWlwbWVudF9zdXBwbHlfcHJpY2UsIGFkZGl0aW9uYWxfY2xlYW5lcnNfcHJpY2UsIHByZWZlcnJlZF9jbGVhbmVyX2lkLCBwcmVmZXJyZWRfY2xlYW5lcl9pZHMnKVxyXG4gICAgICAuZXEoJ3ByZWZlcnJlZF9jbGVhbmVyX2lkJywgY2xlYW5lcklkKTtcclxuXHJcbiAgICAvLyBGZXRjaCBib29raW5ncyB3aXRoIHByZWZlcnJlZF9jbGVhbmVyX2lkcyAoYXJyYXkpIC0gZmV0Y2ggYWxsIHdpdGggYXJyYXlzLCB0aGVuIGZpbHRlciBpbiBKU1xyXG4gICAgY29uc3QgeyBkYXRhOiBhbGxNdWx0aUJvb2tpbmdzLCBlcnJvcjogbXVsdGlFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2Jvb2tpbmdzJylcclxuICAgICAgLnNlbGVjdCgnaWQsIHN0YXR1cywgc2VydmljZV9kYXRlLCB0b3RhbF9hbW91bnQsIHBheW1lbnRfc3RhdHVzLCBzZXJ2aWNlX3R5cGUsIHNlcnZpY2VfZmVlLCBzdWJ0b3RhbCwgdGlwX2Ftb3VudCwgc2VydmljZV9kdXJhdGlvbiwgZXF1aXBtZW50X3N1cHBseV9wcmljZSwgYWRkaXRpb25hbF9jbGVhbmVyc19wcmljZSwgcHJlZmVycmVkX2NsZWFuZXJfaWRzLCBwcmVmZXJyZWRfY2xlYW5lcl9pZCcpXHJcbiAgICAgIC5ub3QoJ3ByZWZlcnJlZF9jbGVhbmVyX2lkcycsICdpcycsIG51bGwpO1xyXG5cclxuICAgIGlmIChzaW5nbGVFcnJvciB8fCBtdWx0aUVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGJvb2tpbmdzIGZvciBzdGF0czonLCBzaW5nbGVFcnJvciB8fCBtdWx0aUVycm9yKTtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAoc2luZ2xlRXJyb3IgfHwgbXVsdGlFcnJvcik/Lm1lc3NhZ2UgfHwgJ0ZhaWxlZCB0byBmZXRjaCBib29raW5ncycgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBEZWJ1ZyBsb2dnaW5nXHJcbiAgICBjb25zb2xlLmxvZygnW2dldENsZWFuZXJTdGF0c10gRmV0Y2hlZCBib29raW5nczonLCB7XHJcbiAgICAgIGNsZWFuZXJJZCxcclxuICAgICAgc2luZ2xlQm9va2luZ3NDb3VudDogc2luZ2xlQm9va2luZ3M/Lmxlbmd0aCB8fCAwLFxyXG4gICAgICBhbGxNdWx0aUJvb2tpbmdzQ291bnQ6IGFsbE11bHRpQm9va2luZ3M/Lmxlbmd0aCB8fCAwLFxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gRmlsdGVyIGJvb2tpbmdzIHdoZXJlIHByZWZlcnJlZF9jbGVhbmVyX2lkcyBhcnJheSBjb250YWlucyB0aGlzIGNsZWFuZXJJZFxyXG4gICAgLy8gTm9ybWFsaXplIFVVSURzIGZvciBjb21wYXJpc29uIChoYW5kbGUgY2FzZSBkaWZmZXJlbmNlcyBhbmQgc3RyaW5nIGZvcm1hdHMpXHJcbiAgICBjb25zdCBub3JtYWxpemVVdWlkID0gKGlkOiBhbnkpOiBzdHJpbmcgPT4ge1xyXG4gICAgICBpZiAoIWlkKSByZXR1cm4gJyc7XHJcbiAgICAgIHJldHVybiBTdHJpbmcoaWQpLnRvTG93ZXJDYXNlKCkudHJpbSgpO1xyXG4gICAgfTtcclxuICAgIGNvbnN0IG5vcm1hbGl6ZWRDbGVhbmVySWQgPSBub3JtYWxpemVVdWlkKGNsZWFuZXJJZCk7XHJcbiAgICBcclxuICAgIGNvbnN0IGFycmF5Qm9va2luZ3MgPSAoYWxsTXVsdGlCb29raW5ncyB8fCBbXSkuZmlsdGVyKChib29raW5nOiBhbnkpID0+IHtcclxuICAgICAgaWYgKCFib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcyB8fCAhQXJyYXkuaXNBcnJheShib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcykpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgLy8gQ2hlY2sgaWYgYXJyYXkgaXMgZW1wdHlcclxuICAgICAgaWYgKGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWRzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgICAvLyBDaGVjayBpZiBhbnkgSUQgaW4gdGhlIGFycmF5IG1hdGNoZXMgdGhlIGNsZWFuZXJJZCAoY2FzZS1pbnNlbnNpdGl2ZSlcclxuICAgICAgcmV0dXJuIGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWRzLnNvbWUoKGlkOiBzdHJpbmcpID0+IG5vcm1hbGl6ZVV1aWQoaWQpID09PSBub3JtYWxpemVkQ2xlYW5lcklkKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIENvbWJpbmUgYW5kIHJlbW92ZSBkdXBsaWNhdGVzIGJ5IElEXHJcbiAgICBjb25zdCBhbGxCb29raW5nc01hcCA9IG5ldyBNYXA8c3RyaW5nLCBhbnk+KCk7XHJcbiAgICAoc2luZ2xlQm9va2luZ3MgfHwgW10pLmZvckVhY2goKGJvb2tpbmc6IGFueSkgPT4ge1xyXG4gICAgICBpZiAoYm9va2luZy5pZCkge1xyXG4gICAgICAgIGFsbEJvb2tpbmdzTWFwLnNldChib29raW5nLmlkLCBib29raW5nKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBhcnJheUJvb2tpbmdzLmZvckVhY2goKGJvb2tpbmc6IGFueSkgPT4ge1xyXG4gICAgICBpZiAoYm9va2luZy5pZCAmJiAhYWxsQm9va2luZ3NNYXAuaGFzKGJvb2tpbmcuaWQpKSB7XHJcbiAgICAgICAgYWxsQm9va2luZ3NNYXAuc2V0KGJvb2tpbmcuaWQsIGJvb2tpbmcpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgY29uc3QgYWxsQm9va2luZ3MgPSBBcnJheS5mcm9tKGFsbEJvb2tpbmdzTWFwLnZhbHVlcygpKTtcclxuXHJcbiAgICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xyXG4gICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcclxuICAgIGNvbnN0IGZpcnN0RGF5T2ZNb250aCA9IG5ldyBEYXRlKG5vdy5nZXRGdWxsWWVhcigpLCBub3cuZ2V0TW9udGgoKSwgMSkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xyXG4gICAgY29uc3QgY29tcGxldGVkQm9va2luZ3MgPSBhbGxCb29raW5ncy5maWx0ZXIoYiA9PiBiLnN0YXR1cyA9PT0gJ2NvbXBsZXRlZCcpO1xyXG4gICAgY29uc3QgdXBjb21pbmdCb29raW5ncyA9IGFsbEJvb2tpbmdzLmZpbHRlcihiID0+IFxyXG4gICAgICBbJ3BlbmRpbmcnLCAnY29uZmlybWVkJywgJ29uX215X3dheScsICdzdGFydGVkJ10uaW5jbHVkZXMoYi5zdGF0dXMpICYmXHJcbiAgICAgIGIuc2VydmljZV9kYXRlID49IHRvZGF5XHJcbiAgICApO1xyXG4gICAgY29uc3QgdG9kYXlCb29raW5ncyA9IGFsbEJvb2tpbmdzLmZpbHRlcihiID0+IGIuc2VydmljZV9kYXRlID09PSB0b2RheSk7XHJcbiAgICBjb25zdCBwYWlkQm9va2luZ3MgPSBhbGxCb29raW5ncy5maWx0ZXIoYiA9PiBiLnBheW1lbnRfc3RhdHVzID09PSAncGFpZCcpO1xyXG4gICAgY29uc3QgbW9udGhseVBhaWRCb29raW5ncyA9IHBhaWRCb29raW5ncy5maWx0ZXIoYiA9PiBiLnNlcnZpY2VfZGF0ZSA+PSBmaXJzdERheU9mTW9udGgpO1xyXG5cclxuICAgIC8vIENhbGN1bGF0ZSBjbGVhbmVyIHRlbnVyZSBhbmQgdG90YWwgaG91cnMgZm9yIGVsaWdpYmlsaXR5IGRldGVybWluYXRpb25cclxuICAgIGNvbnN0IHRlbnVyZU1vbnRocyA9IGNhbGN1bGF0ZUNsZWFuZXJUZW51cmUoY2xlYW5lci5jcmVhdGVkX2F0KTtcclxuICAgIGNvbnN0IHRvdGFsSG91cnMgPSBjYWxjdWxhdGVUb3RhbEhvdXJzKGFsbEJvb2tpbmdzKTtcclxuICAgIGNvbnN0IGVhcm5pbmdzUGVyY2VudGFnZSA9IGdldEVhcm5pbmdzUGVyY2VudGFnZSh0ZW51cmVNb250aHMsIHRvdGFsSG91cnMpO1xyXG5cclxuICAgIC8vIENhbGN1bGF0ZSBlYXJuaW5ncyB1c2luZyB0aGUgbmV3IHN5c3RlbVxyXG4gICAgLy8gT25seSBjYWxjdWxhdGUgZWFybmluZ3MgZm9yIHBhaWQgYm9va2luZ3MgKGVhcm5pbmdzIGFyZSBvbmx5IHBhaWQgd2hlbiBjdXN0b21lciBoYXMgcGFpZClcclxuICAgIC8vIEVxdWlwbWVudCBmZWUgYW5kIGFkZGl0aW9uYWwgY2xlYW5lcnMgY2hhcmdlcyBhcmUgZXhjbHVkZWQgZnJvbSBjbGVhbmVyIGVhcm5pbmdzXHJcbiAgICBjb25zdCB0b3RhbEVhcm5pbmdzID0gcGFpZEJvb2tpbmdzLnJlZHVjZSgoc3VtLCBib29raW5nKSA9PiB7XHJcbiAgICAgIGNvbnN0IGVhcm5pbmdzID0gY2FsY3VsYXRlVG90YWxFYXJuaW5nc0Zyb21Cb29raW5nKFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIHNlcnZpY2VfdHlwZTogYm9va2luZy5zZXJ2aWNlX3R5cGUgfHwgJycsXHJcbiAgICAgICAgICB0b3RhbF9hbW91bnQ6IE51bWJlcihib29raW5nLnRvdGFsX2Ftb3VudCkgfHwgMCxcclxuICAgICAgICAgIHNlcnZpY2VfZmVlOiBOdW1iZXIoYm9va2luZy5zZXJ2aWNlX2ZlZSkgfHwgMCxcclxuICAgICAgICAgIGVxdWlwbWVudF9zdXBwbHlfcHJpY2U6IE51bWJlcihib29raW5nLmVxdWlwbWVudF9zdXBwbHlfcHJpY2UpIHx8IDAsXHJcbiAgICAgICAgICBhZGRpdGlvbmFsX2NsZWFuZXJzX3ByaWNlOiBOdW1iZXIoYm9va2luZy5hZGRpdGlvbmFsX2NsZWFuZXJzX3ByaWNlKSB8fCAwLFxyXG4gICAgICAgICAgdGlwX2Ftb3VudDogTnVtYmVyKGJvb2tpbmcudGlwX2Ftb3VudCkgfHwgMCxcclxuICAgICAgICAgIHByZWZlcnJlZF9jbGVhbmVyX2lkczogYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMsXHJcbiAgICAgICAgICBwcmVmZXJyZWRfY2xlYW5lcl9pZDogYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZCxcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNsZWFuZXJJZCxcclxuICAgICAgICBlYXJuaW5nc1BlcmNlbnRhZ2VcclxuICAgICAgKTtcclxuICAgICAgcmV0dXJuIHN1bSArIGVhcm5pbmdzO1xyXG4gICAgfSwgMCk7XHJcblxyXG4gICAgY29uc3QgbW9udGhseUVhcm5pbmdzID0gbW9udGhseVBhaWRCb29raW5ncy5yZWR1Y2UoKHN1bSwgYm9va2luZykgPT4ge1xyXG4gICAgICBjb25zdCBlYXJuaW5ncyA9IGNhbGN1bGF0ZVRvdGFsRWFybmluZ3NGcm9tQm9va2luZyhcclxuICAgICAgICB7XHJcbiAgICAgICAgICBzZXJ2aWNlX3R5cGU6IGJvb2tpbmcuc2VydmljZV90eXBlIHx8ICcnLFxyXG4gICAgICAgICAgdG90YWxfYW1vdW50OiBOdW1iZXIoYm9va2luZy50b3RhbF9hbW91bnQpIHx8IDAsXHJcbiAgICAgICAgICBzZXJ2aWNlX2ZlZTogTnVtYmVyKGJvb2tpbmcuc2VydmljZV9mZWUpIHx8IDAsXHJcbiAgICAgICAgICBlcXVpcG1lbnRfc3VwcGx5X3ByaWNlOiBOdW1iZXIoYm9va2luZy5lcXVpcG1lbnRfc3VwcGx5X3ByaWNlKSB8fCAwLFxyXG4gICAgICAgICAgYWRkaXRpb25hbF9jbGVhbmVyc19wcmljZTogTnVtYmVyKGJvb2tpbmcuYWRkaXRpb25hbF9jbGVhbmVyc19wcmljZSkgfHwgMCxcclxuICAgICAgICAgIHRpcF9hbW91bnQ6IE51bWJlcihib29raW5nLnRpcF9hbW91bnQpIHx8IDAsXHJcbiAgICAgICAgICBwcmVmZXJyZWRfY2xlYW5lcl9pZHM6IGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWRzLFxyXG4gICAgICAgICAgcHJlZmVycmVkX2NsZWFuZXJfaWQ6IGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWQsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBjbGVhbmVySWQsXHJcbiAgICAgICAgZWFybmluZ3NQZXJjZW50YWdlXHJcbiAgICAgICk7XHJcbiAgICAgIHJldHVybiBzdW0gKyBlYXJuaW5ncztcclxuICAgIH0sIDApO1xyXG5cclxuICAgIGNvbnN0IGNvbXBsZXRpb25SYXRlID0gY2xlYW5lci50b3RhbF9ib29raW5ncyBcclxuICAgICAgPyAoY2xlYW5lci5jb21wbGV0ZWRfYm9va2luZ3MgfHwgMCkgLyBjbGVhbmVyLnRvdGFsX2Jvb2tpbmdzICogMTAwIFxyXG4gICAgICA6IDA7XHJcbiAgICBcclxuICAgIGNvbnN0IG9uVGltZVJhdGUgPSBjbGVhbmVyLmNvbXBsZXRlZF9ib29raW5nc1xyXG4gICAgICA/IChjbGVhbmVyLm9uX3RpbWVfYm9va2luZ3MgfHwgMCkgLyBjbGVhbmVyLmNvbXBsZXRlZF9ib29raW5ncyAqIDEwMFxyXG4gICAgICA6IDA7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgc3RhdHM6IHtcclxuICAgICAgICB0b3RhbEJvb2tpbmdzOiBhbGxCb29raW5ncy5sZW5ndGgsXHJcbiAgICAgICAgY29tcGxldGVkQm9va2luZ3M6IGNvbXBsZXRlZEJvb2tpbmdzLmxlbmd0aCxcclxuICAgICAgICB1cGNvbWluZ0Jvb2tpbmdzOiB1cGNvbWluZ0Jvb2tpbmdzLmxlbmd0aCxcclxuICAgICAgICB0b2RheUJvb2tpbmdzOiB0b2RheUJvb2tpbmdzLmxlbmd0aCxcclxuICAgICAgICB0b3RhbEVhcm5pbmdzLFxyXG4gICAgICAgIG1vbnRobHlFYXJuaW5ncyxcclxuICAgICAgICBhdmVyYWdlUmF0aW5nOiBOdW1iZXIoY2xlYW5lci5yYXRpbmcpIHx8IDAsXHJcbiAgICAgICAgcmVsaWFiaWxpdHlTY29yZTogTnVtYmVyKGNsZWFuZXIucmVsaWFiaWxpdHlfc2NvcmUpIHx8IDAsXHJcbiAgICAgICAgY29tcGxldGlvblJhdGUsXHJcbiAgICAgICAgb25UaW1lUmF0ZSxcclxuICAgICAgfSxcclxuICAgIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIGdldENsZWFuZXJTdGF0czonLCBlcnJvcik7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0ZhaWxlZCB0byBmZXRjaCBzdGF0cycsXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFVwZGF0ZSBjbGVhbmVyIGF2YWlsYWJpbGl0eVxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUNsZWFuZXJBdmFpbGFiaWxpdHkoXHJcbiAgY2xlYW5lcklkOiBzdHJpbmcsXHJcbiAgdXBkYXRlczoge1xyXG4gICAgaXNBdmFpbGFibGU/OiBib29sZWFuO1xyXG4gICAgYXZhaWxhYmxlTW9uZGF5PzogYm9vbGVhbjtcclxuICAgIGF2YWlsYWJsZVR1ZXNkYXk/OiBib29sZWFuO1xyXG4gICAgYXZhaWxhYmxlV2VkbmVzZGF5PzogYm9vbGVhbjtcclxuICAgIGF2YWlsYWJsZVRodXJzZGF5PzogYm9vbGVhbjtcclxuICAgIGF2YWlsYWJsZUZyaWRheT86IGJvb2xlYW47XHJcbiAgICBhdmFpbGFibGVTYXR1cmRheT86IGJvb2xlYW47XHJcbiAgICBhdmFpbGFibGVTdW5kYXk/OiBib29sZWFuO1xyXG4gIH1cclxuKTogUHJvbWlzZTx7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBjbGVhbmVyPzogQ2xlYW5lcjtcclxuICBlcnJvcj86IHN0cmluZztcclxufT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xyXG5cclxuICAgIGNvbnN0IHVwZGF0ZURhdGE6IGFueSA9IHtcclxuICAgICAgdXBkYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgfTtcclxuXHJcbiAgICBpZiAodXBkYXRlcy5pc0F2YWlsYWJsZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHVwZGF0ZURhdGEuaXNfYXZhaWxhYmxlID0gdXBkYXRlcy5pc0F2YWlsYWJsZTtcclxuICAgIH1cclxuICAgIGlmICh1cGRhdGVzLmF2YWlsYWJsZU1vbmRheSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHVwZGF0ZURhdGEuYXZhaWxhYmxlX21vbmRheSA9IHVwZGF0ZXMuYXZhaWxhYmxlTW9uZGF5O1xyXG4gICAgfVxyXG4gICAgaWYgKHVwZGF0ZXMuYXZhaWxhYmxlVHVlc2RheSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHVwZGF0ZURhdGEuYXZhaWxhYmxlX3R1ZXNkYXkgPSB1cGRhdGVzLmF2YWlsYWJsZVR1ZXNkYXk7XHJcbiAgICB9XHJcbiAgICBpZiAodXBkYXRlcy5hdmFpbGFibGVXZWRuZXNkYXkgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB1cGRhdGVEYXRhLmF2YWlsYWJsZV93ZWRuZXNkYXkgPSB1cGRhdGVzLmF2YWlsYWJsZVdlZG5lc2RheTtcclxuICAgIH1cclxuICAgIGlmICh1cGRhdGVzLmF2YWlsYWJsZVRodXJzZGF5ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgdXBkYXRlRGF0YS5hdmFpbGFibGVfdGh1cnNkYXkgPSB1cGRhdGVzLmF2YWlsYWJsZVRodXJzZGF5O1xyXG4gICAgfVxyXG4gICAgaWYgKHVwZGF0ZXMuYXZhaWxhYmxlRnJpZGF5ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgdXBkYXRlRGF0YS5hdmFpbGFibGVfZnJpZGF5ID0gdXBkYXRlcy5hdmFpbGFibGVGcmlkYXk7XHJcbiAgICB9XHJcbiAgICBpZiAodXBkYXRlcy5hdmFpbGFibGVTYXR1cmRheSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHVwZGF0ZURhdGEuYXZhaWxhYmxlX3NhdHVyZGF5ID0gdXBkYXRlcy5hdmFpbGFibGVTYXR1cmRheTtcclxuICAgIH1cclxuICAgIGlmICh1cGRhdGVzLmF2YWlsYWJsZVN1bmRheSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHVwZGF0ZURhdGEuYXZhaWxhYmxlX3N1bmRheSA9IHVwZGF0ZXMuYXZhaWxhYmxlU3VuZGF5O1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHsgZGF0YTogdXBkYXRlZENsZWFuZXIsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnY2xlYW5lcnMnKVxyXG4gICAgICAudXBkYXRlKHVwZGF0ZURhdGEpXHJcbiAgICAgIC5lcSgnaWQnLCBjbGVhbmVySWQpXHJcbiAgICAgIC5zZWxlY3QoKVxyXG4gICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgaWYgKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGNsZWFuZXIgYXZhaWxhYmlsaXR5OicsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgY2xlYW5lcjogdXBkYXRlZENsZWFuZXIgYXMgQ2xlYW5lciB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiB1cGRhdGVDbGVhbmVyQXZhaWxhYmlsaXR5OicsIGVycm9yKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnRmFpbGVkIHRvIHVwZGF0ZSBhdmFpbGFiaWxpdHknLFxyXG4gICAgfTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI2UkF1THNCLCtMQUFBIn0=
}),
"[project]/app/cleaner/data:41dff6 [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "calculateBookingsEarnings",
    ()=>$$RSC_SERVER_ACTION_8
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"400c3b38a11e4946f9888927b9dcc25cc258d8b9d2":"calculateBookingsEarnings"},"app/cleaner/actions.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_8 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("400c3b38a11e4946f9888927b9dcc25cc258d8b9d2", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "calculateBookingsEarnings");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vYWN0aW9ucy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHNlcnZlcic7XHJcblxyXG5pbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAL2xpYi9zdXBhYmFzZS9zZXJ2ZXInO1xyXG5pbXBvcnQgeyBjcmVhdGVBZG1pbkNsaWVudCB9IGZyb20gJ0AvbGliL3N1cGFiYXNlL3NlcnZlci1hZG1pbic7XHJcbmltcG9ydCB7IEJvb2tpbmcgfSBmcm9tICdAL3R5cGVzL2Jvb2tpbmcnO1xyXG5pbXBvcnQgeyBDbGVhbmVyIH0gZnJvbSAnQC90eXBlcy9ib29raW5nJztcclxuaW1wb3J0IHtcclxuICBjYWxjdWxhdGVDbGVhbmVyVGVudXJlLFxyXG4gIGNhbGN1bGF0ZVRvdGFsSG91cnMsXHJcbiAgZ2V0RWFybmluZ3NQZXJjZW50YWdlLFxyXG4gIGNhbGN1bGF0ZVRvdGFsRWFybmluZ3NGcm9tQm9va2luZyxcclxuICBjYWxjdWxhdGVDbGVhbmVyRWFybmluZ3MsXHJcbiAgY2FsY3VsYXRlVGlwUGVyQ2xlYW5lcixcclxufSBmcm9tICdAL2xpYi91dGlscy9jbGVhbmVyLWVhcm5pbmdzJztcclxuXHJcbi8qKlxyXG4gKiBHZXQgY2xlYW5lciBieSBwaG9uZSBudW1iZXJcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDbGVhbmVyQnlQaG9uZShwaG9uZTogc3RyaW5nKTogUHJvbWlzZTx7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBjbGVhbmVyPzogQ2xlYW5lcjtcclxuICBlcnJvcj86IHN0cmluZztcclxufT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xyXG4gICAgXHJcbiAgICAvLyBOb3JtYWxpemUgcGhvbmUgbnVtYmVyIChyZW1vdmUgc3BhY2VzLCBkYXNoZXMsIGV0Yy4pXHJcbiAgICBjb25zdCBub3JtYWxpemVkUGhvbmUgPSBwaG9uZS5yZXBsYWNlKC9cXHMrL2csICcnKS50cmltKCk7XHJcbiAgICBcclxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdjbGVhbmVycycpXHJcbiAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAub3IoYHBob25lLmVxLiR7bm9ybWFsaXplZFBob25lfSxwaG9uZS5lcS4rJHtub3JtYWxpemVkUGhvbmV9YClcclxuICAgICAgLmVxKCdpc19hY3RpdmUnLCB0cnVlKVxyXG4gICAgICAubWF5YmVTaW5nbGUoKTtcclxuXHJcbiAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY2xlYW5lciBieSBwaG9uZTonLCBlcnJvcik7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG5cclxuICAgIGlmICghZGF0YSkge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdDbGVhbmVyIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBjbGVhbmVyOiBkYXRhIGFzIENsZWFuZXIgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gZ2V0Q2xlYW5lckJ5UGhvbmU6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdGYWlsZWQgdG8gZmV0Y2ggY2xlYW5lcicsXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEF1dGhlbnRpY2F0ZSBjbGVhbmVyIHdpdGggcGhvbmUgYW5kIHBhc3N3b3JkXHJcbiAqIFVzZXMgU3VwYWJhc2UgQXV0aCAtIGV4cGVjdHMgZW1haWwgZm9ybWF0OiB7cGhvbmV9QGNsZWFuZXJzLnNoYWxlYW4ubG9jYWxcclxuICogQWRtaW4gc2hvdWxkIGNyZWF0ZSBhdXRoIGFjY291bnRzIHdpdGggdGhpcyBlbWFpbCBmb3JtYXQgd2hlbiBjcmVhdGluZyBjbGVhbmVyIGFjY291bnRzXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXV0aGVudGljYXRlQ2xlYW5lcihcclxuICBwaG9uZTogc3RyaW5nLFxyXG4gIHBhc3N3b3JkOiBzdHJpbmdcclxuKTogUHJvbWlzZTx7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBjbGVhbmVyPzogQ2xlYW5lcjtcclxuICBlcnJvcj86IHN0cmluZztcclxufT4ge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBGaXJzdCwgZmluZCB0aGUgY2xlYW5lciBieSBwaG9uZSB0byB2ZXJpZnkgdGhleSBleGlzdFxyXG4gICAgY29uc3QgY2xlYW5lclJlc3VsdCA9IGF3YWl0IGdldENsZWFuZXJCeVBob25lKHBob25lKTtcclxuICAgIGlmICghY2xlYW5lclJlc3VsdC5zdWNjZXNzIHx8ICFjbGVhbmVyUmVzdWx0LmNsZWFuZXIpIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnSW52YWxpZCBwaG9uZSBudW1iZXIgb3IgcGFzc3dvcmQnIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgY2xlYW5lciA9IGNsZWFuZXJSZXN1bHQuY2xlYW5lcjtcclxuXHJcbiAgICAvLyBVc2UgcGhvbmUtYmFzZWQgZW1haWwgZm9ybWF0IGZvciBsb2dpblxyXG4gICAgLy8gRm9ybWF0OiB7cGhvbmV9QGNsZWFuZXJzLnNoYWxlYW4ubG9jYWxcclxuICAgIC8vIE5vcm1hbGl6ZSBwaG9uZSAocmVtb3ZlIHNwYWNlcywga2VlcCArIGlmIHByZXNlbnQpXHJcbiAgICBjb25zdCBub3JtYWxpemVkUGhvbmUgPSBwaG9uZS5yZXBsYWNlKC9cXHMrL2csICcnKS50cmltKCk7XHJcbiAgICBjb25zdCBhdXRoRW1haWwgPSBgJHtub3JtYWxpemVkUGhvbmV9QGNsZWFuZXJzLnNoYWxlYW4ubG9jYWxgO1xyXG5cclxuICAgIC8vIEF1dGhlbnRpY2F0ZSB3aXRoIFN1cGFiYXNlIEF1dGggdXNpbmcgY2xpZW50LXNpZGUgKHRoaXMgc2hvdWxkIGJlIGNhbGxlZCBmcm9tIGNsaWVudClcclxuICAgIC8vIE5vdGU6IFRoaXMgZnVuY3Rpb24gc2hvdWxkIGlkZWFsbHkgYmUgY2FsbGVkIGZyb20gYSBjbGllbnQgY29tcG9uZW50XHJcbiAgICAvLyBGb3Igc2VydmVyLXNpZGUsIHdlJ2xsIHJldHVybiB0aGUgY2xlYW5lciBpbmZvIGFuZCBsZXQgY2xpZW50IGhhbmRsZSBhdXRoXHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xyXG4gICAgXHJcbiAgICAvLyBUcnkgdG8gYXV0aGVudGljYXRlXHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLnNpZ25JbldpdGhQYXNzd29yZCh7XHJcbiAgICAgIGVtYWlsOiBhdXRoRW1haWwsXHJcbiAgICAgIHBhc3N3b3JkLFxyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0F1dGhlbnRpY2F0aW9uIGVycm9yOicsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnSW52YWxpZCBwaG9uZSBudW1iZXIgb3IgcGFzc3dvcmQnIH07XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCFkYXRhLnVzZXIpIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnQXV0aGVudGljYXRpb24gZmFpbGVkJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFVwZGF0ZSBjbGVhbmVyJ3MgYXV0aF91c2VyX2lkIGlmIG5vdCBzZXRcclxuICAgIGlmICghY2xlYW5lci5hdXRoX3VzZXJfaWQpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBhZG1pblN1cGFiYXNlID0gY3JlYXRlQWRtaW5DbGllbnQoKTtcclxuICAgICAgICBhd2FpdCBhZG1pblN1cGFiYXNlXHJcbiAgICAgICAgICAuZnJvbSgnY2xlYW5lcnMnKVxyXG4gICAgICAgICAgLnVwZGF0ZSh7IGF1dGhfdXNlcl9pZDogZGF0YS51c2VyLmlkIH0pXHJcbiAgICAgICAgICAuZXEoJ2lkJywgY2xlYW5lci5pZCk7XHJcbiAgICAgIH0gY2F0Y2ggKHVwZGF0ZUVycm9yKSB7XHJcbiAgICAgICAgLy8gTG9nIGJ1dCBkb24ndCBmYWlsIC0gYXV0aF91c2VyX2lkIHVwZGF0ZSBpcyBvcHRpb25hbFxyXG4gICAgICAgIGNvbnNvbGUud2FybignQ291bGQgbm90IHVwZGF0ZSBhdXRoX3VzZXJfaWQ6JywgdXBkYXRlRXJyb3IpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgY2xlYW5lciB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBhdXRoZW50aWNhdGVDbGVhbmVyOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnQXV0aGVudGljYXRpb24gZmFpbGVkJyxcclxuICAgIH07XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogR2V0IGN1cnJlbnQgYXV0aGVudGljYXRlZCBjbGVhbmVyXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q3VycmVudENsZWFuZXIoKTogUHJvbWlzZTx7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBjbGVhbmVyPzogQ2xlYW5lcjtcclxuICBlcnJvcj86IHN0cmluZztcclxufT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xyXG4gICAgY29uc3QgeyBkYXRhOiB7IHVzZXIgfSwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5nZXRVc2VyKCk7XHJcblxyXG4gICAgaWYgKGF1dGhFcnJvciB8fCAhdXNlcikge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdOb3QgYXV0aGVudGljYXRlZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBUcnkgdG8gZmluZCBjbGVhbmVyIGJ5IGF1dGhfdXNlcl9pZCBmaXJzdFxyXG4gICAgbGV0IGNsZWFuZXJRdWVyeSA9IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdjbGVhbmVycycpXHJcbiAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAuZXEoJ2F1dGhfdXNlcl9pZCcsIHVzZXIuaWQpXHJcbiAgICAgIC5lcSgnaXNfYWN0aXZlJywgdHJ1ZSlcclxuICAgICAgLm1heWJlU2luZ2xlKCk7XHJcblxyXG4gICAgbGV0IHsgZGF0YTogY2xlYW5lciwgZXJyb3I6IGNsZWFuZXJFcnJvciB9ID0gYXdhaXQgY2xlYW5lclF1ZXJ5O1xyXG5cclxuICAgIC8vIElmIG5vdCBmb3VuZCBieSBhdXRoX3VzZXJfaWQsIHRyeSB0byBtYXRjaCBieSBwaG9uZSBmcm9tIGVtYWlsXHJcbiAgICBpZiAoIWNsZWFuZXIgJiYgIWNsZWFuZXJFcnJvciAmJiB1c2VyLmVtYWlsKSB7XHJcbiAgICAgIC8vIEV4dHJhY3QgcGhvbmUgZnJvbSBlbWFpbCBmb3JtYXQ6IHtwaG9uZX1AY2xlYW5lcnMuc2hhbGVhbi5sb2NhbFxyXG4gICAgICBjb25zdCBwaG9uZU1hdGNoID0gdXNlci5lbWFpbC5tYXRjaCgvXiguKylAY2xlYW5lcnNcXC5zaGFsZWFuXFwubG9jYWwkLyk7XHJcbiAgICAgIGlmIChwaG9uZU1hdGNoKSB7XHJcbiAgICAgICAgY29uc3QgcGhvbmUgPSBwaG9uZU1hdGNoWzFdO1xyXG4gICAgICAgIGNvbnN0IHBob25lUmVzdWx0ID0gYXdhaXQgZ2V0Q2xlYW5lckJ5UGhvbmUocGhvbmUpO1xyXG4gICAgICAgIGlmIChwaG9uZVJlc3VsdC5zdWNjZXNzICYmIHBob25lUmVzdWx0LmNsZWFuZXIpIHtcclxuICAgICAgICAgIGNsZWFuZXIgPSBwaG9uZVJlc3VsdC5jbGVhbmVyO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChjbGVhbmVyRXJyb3IgfHwgIWNsZWFuZXIpIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnQ2xlYW5lciBwcm9maWxlIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBjbGVhbmVyOiBjbGVhbmVyIGFzIENsZWFuZXIgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gZ2V0Q3VycmVudENsZWFuZXI6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdGYWlsZWQgdG8gZ2V0IGNsZWFuZXInLFxyXG4gICAgfTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZXQgYm9va2luZ3MgYXNzaWduZWQgdG8gdGhlIGF1dGhlbnRpY2F0ZWQgY2xlYW5lclxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENsZWFuZXJCb29raW5ncyhcclxuICBmaWx0ZXI/OiAnYWxsJyB8ICd0b2RheScgfCAndXBjb21pbmcnIHwgJ3Bhc3QnIHwgJ29uX215X3dheScgfCAnc3RhcnRlZCdcclxuKTogUHJvbWlzZTx7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBib29raW5ncz86IEJvb2tpbmdbXTtcclxuICBlcnJvcj86IHN0cmluZztcclxufT4ge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBHZXQgYXV0aGVudGljYXRlZCBjbGVhbmVyIGZpcnN0XHJcbiAgICBjb25zdCBjbGVhbmVyUmVzdWx0ID0gYXdhaXQgZ2V0Q3VycmVudENsZWFuZXIoKTtcclxuICAgIGlmICghY2xlYW5lclJlc3VsdC5zdWNjZXNzIHx8ICFjbGVhbmVyUmVzdWx0LmNsZWFuZXIpIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnTm90IGF1dGhlbnRpY2F0ZWQgb3IgY2xlYW5lciBwcm9maWxlIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBjbGVhbmVySWQgPSBjbGVhbmVyUmVzdWx0LmNsZWFuZXIuaWQ7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xyXG4gICAgXHJcbiAgICAvLyBGZXRjaCBib29raW5ncyB3aGVyZSBjbGVhbmVyIGlzIGFzc2lnbmVkIHZpYSBwcmVmZXJyZWRfY2xlYW5lcl9pZCAoc2luZ2xlKVxyXG4gICAgbGV0IHNpbmdsZVF1ZXJ5ID0gc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2Jvb2tpbmdzJylcclxuICAgICAgLnNlbGVjdCgnKicpXHJcbiAgICAgIC5lcSgncHJlZmVycmVkX2NsZWFuZXJfaWQnLCBjbGVhbmVySWQpO1xyXG5cclxuICAgIC8vIEZldGNoIGJvb2tpbmdzIHdpdGggcHJlZmVycmVkX2NsZWFuZXJfaWRzIChhcnJheSkgLSBmZXRjaCBhbGwgd2l0aCBhcnJheXMsIHRoZW4gZmlsdGVyXHJcbiAgICBsZXQgYXJyYXlRdWVyeSA9IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdib29raW5ncycpXHJcbiAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAubm90KCdwcmVmZXJyZWRfY2xlYW5lcl9pZHMnLCAnaXMnLCBudWxsKTtcclxuXHJcbiAgICAvLyBBcHBseSBmaWx0ZXJzIHRvIGJvdGggcXVlcmllc1xyXG4gICAgaWYgKGZpbHRlciAmJiBmaWx0ZXIgIT09ICdhbGwnKSB7XHJcbiAgICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XHJcbiAgICAgIFxyXG4gICAgICBzd2l0Y2ggKGZpbHRlcikge1xyXG4gICAgICAgIGNhc2UgJ3RvZGF5JzpcclxuICAgICAgICAgIHNpbmdsZVF1ZXJ5ID0gc2luZ2xlUXVlcnkuZXEoJ3NlcnZpY2VfZGF0ZScsIHRvZGF5KTtcclxuICAgICAgICAgIGFycmF5UXVlcnkgPSBhcnJheVF1ZXJ5LmVxKCdzZXJ2aWNlX2RhdGUnLCB0b2RheSk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICd1cGNvbWluZyc6XHJcbiAgICAgICAgICBzaW5nbGVRdWVyeSA9IHNpbmdsZVF1ZXJ5Lmd0ZSgnc2VydmljZV9kYXRlJywgdG9kYXkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAuaW4oJ3N0YXR1cycsIFsncGVuZGluZycsICdjb25maXJtZWQnLCAnb25fbXlfd2F5JywgJ3N0YXJ0ZWQnXSk7XHJcbiAgICAgICAgICBhcnJheVF1ZXJ5ID0gYXJyYXlRdWVyeS5ndGUoJ3NlcnZpY2VfZGF0ZScsIHRvZGF5KVxyXG4gICAgICAgICAgICAgICAgICAgICAgLmluKCdzdGF0dXMnLCBbJ3BlbmRpbmcnLCAnY29uZmlybWVkJywgJ29uX215X3dheScsICdzdGFydGVkJ10pO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAncGFzdCc6XHJcbiAgICAgICAgICBzaW5nbGVRdWVyeSA9IHNpbmdsZVF1ZXJ5Lmx0KCdzZXJ2aWNlX2RhdGUnLCB0b2RheSlcclxuICAgICAgICAgICAgICAgICAgICAgIC5vcignc3RhdHVzLmVxLmNvbXBsZXRlZCxzdGF0dXMuZXEuY2FuY2VsbGVkJyk7XHJcbiAgICAgICAgICBhcnJheVF1ZXJ5ID0gYXJyYXlRdWVyeS5sdCgnc2VydmljZV9kYXRlJywgdG9kYXkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAub3IoJ3N0YXR1cy5lcS5jb21wbGV0ZWQsc3RhdHVzLmVxLmNhbmNlbGxlZCcpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnb25fbXlfd2F5JzpcclxuICAgICAgICAgIHNpbmdsZVF1ZXJ5ID0gc2luZ2xlUXVlcnkuZXEoJ3N0YXR1cycsICdvbl9teV93YXknKTtcclxuICAgICAgICAgIGFycmF5UXVlcnkgPSBhcnJheVF1ZXJ5LmVxKCdzdGF0dXMnLCAnb25fbXlfd2F5Jyk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdzdGFydGVkJzpcclxuICAgICAgICAgIHNpbmdsZVF1ZXJ5ID0gc2luZ2xlUXVlcnkuZXEoJ3N0YXR1cycsICdzdGFydGVkJyk7XHJcbiAgICAgICAgICBhcnJheVF1ZXJ5ID0gYXJyYXlRdWVyeS5lcSgnc3RhdHVzJywgJ3N0YXJ0ZWQnKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRXhlY3V0ZSBib3RoIHF1ZXJpZXNcclxuICAgIGNvbnN0IFtzaW5nbGVSZXN1bHQsIGFycmF5UmVzdWx0XSA9IGF3YWl0IFByb21pc2UuYWxsKFtcclxuICAgICAgc2luZ2xlUXVlcnkub3JkZXIoJ3NlcnZpY2VfZGF0ZScsIHsgYXNjZW5kaW5nOiB0cnVlIH0pLm9yZGVyKCdzZXJ2aWNlX3RpbWUnLCB7IGFzY2VuZGluZzogdHJ1ZSB9KSxcclxuICAgICAgYXJyYXlRdWVyeS5vcmRlcignc2VydmljZV9kYXRlJywgeyBhc2NlbmRpbmc6IHRydWUgfSkub3JkZXIoJ3NlcnZpY2VfdGltZScsIHsgYXNjZW5kaW5nOiB0cnVlIH0pXHJcbiAgICBdKTtcclxuXHJcbiAgICBpZiAoc2luZ2xlUmVzdWx0LmVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGNsZWFuZXIgYm9va2luZ3MgKHNpbmdsZSk6Jywgc2luZ2xlUmVzdWx0LmVycm9yKTtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBzaW5nbGVSZXN1bHQuZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChhcnJheVJlc3VsdC5lcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBjbGVhbmVyIGJvb2tpbmdzIChhcnJheSk6JywgYXJyYXlSZXN1bHQuZXJyb3IpO1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGFycmF5UmVzdWx0LmVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBEZWJ1ZyBsb2dnaW5nXHJcbiAgICBjb25zb2xlLmxvZygnW2dldENsZWFuZXJCb29raW5nc10gRmV0Y2hlZCBib29raW5nczonLCB7XHJcbiAgICAgIGNsZWFuZXJJZCxcclxuICAgICAgZmlsdGVyLFxyXG4gICAgICBzaW5nbGVCb29raW5nc0NvdW50OiBzaW5nbGVSZXN1bHQuZGF0YT8ubGVuZ3RoIHx8IDAsXHJcbiAgICAgIGFycmF5Qm9va2luZ3NDb3VudDogYXJyYXlSZXN1bHQuZGF0YT8ubGVuZ3RoIHx8IDAsXHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBGaWx0ZXIgYm9va2luZ3Mgd2hlcmUgcHJlZmVycmVkX2NsZWFuZXJfaWRzIGFycmF5IGNvbnRhaW5zIHRoaXMgY2xlYW5lcklkXHJcbiAgICAvLyBOb3JtYWxpemUgVVVJRHMgZm9yIGNvbXBhcmlzb24gKGhhbmRsZSBjYXNlIGRpZmZlcmVuY2VzIGFuZCBzdHJpbmcgZm9ybWF0cylcclxuICAgIGNvbnN0IG5vcm1hbGl6ZVV1aWQgPSAoaWQ6IGFueSk6IHN0cmluZyA9PiB7XHJcbiAgICAgIGlmICghaWQpIHJldHVybiAnJztcclxuICAgICAgcmV0dXJuIFN0cmluZyhpZCkudG9Mb3dlckNhc2UoKS50cmltKCk7XHJcbiAgICB9O1xyXG4gICAgY29uc3Qgbm9ybWFsaXplZENsZWFuZXJJZCA9IG5vcm1hbGl6ZVV1aWQoY2xlYW5lcklkKTtcclxuICAgIFxyXG4gICAgY29uc3QgZmlsdGVyZWRBcnJheUJvb2tpbmdzID0gKGFycmF5UmVzdWx0LmRhdGEgfHwgW10pLmZpbHRlcigoYm9va2luZzogYW55KSA9PiB7XHJcbiAgICAgIGlmICghYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMgfHwgIUFycmF5LmlzQXJyYXkoYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMpKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICAgIC8vIENoZWNrIGlmIGFycmF5IGlzIGVtcHR5XHJcbiAgICAgIGlmIChib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgLy8gQ2hlY2sgaWYgYW55IElEIGluIHRoZSBhcnJheSBtYXRjaGVzIHRoZSBjbGVhbmVySWQgKGNhc2UtaW5zZW5zaXRpdmUpXHJcbiAgICAgIHJldHVybiBib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcy5zb21lKChpZDogc3RyaW5nKSA9PiBub3JtYWxpemVVdWlkKGlkKSA9PT0gbm9ybWFsaXplZENsZWFuZXJJZCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBDb21iaW5lIHJlc3VsdHMgYW5kIHJlbW92ZSBkdXBsaWNhdGVzXHJcbiAgICBjb25zdCBhbGxCb29raW5ncyA9IFtcclxuICAgICAgLi4uKHNpbmdsZVJlc3VsdC5kYXRhIHx8IFtdKSxcclxuICAgICAgLi4uZmlsdGVyZWRBcnJheUJvb2tpbmdzXHJcbiAgICBdO1xyXG5cclxuICAgIC8vIFJlbW92ZSBkdXBsaWNhdGVzIGJ5IGJvb2tpbmcgSURcclxuICAgIGNvbnN0IHVuaXF1ZUJvb2tpbmdzTWFwID0gbmV3IE1hcDxzdHJpbmcsIEJvb2tpbmc+KCk7XHJcbiAgICBhbGxCb29raW5ncy5mb3JFYWNoKChib29raW5nOiBhbnkpID0+IHtcclxuICAgICAgaWYgKGJvb2tpbmcuaWQgJiYgIXVuaXF1ZUJvb2tpbmdzTWFwLmhhcyhib29raW5nLmlkKSkge1xyXG4gICAgICAgIHVuaXF1ZUJvb2tpbmdzTWFwLnNldChib29raW5nLmlkLCBib29raW5nIGFzIEJvb2tpbmcpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBib29raW5ncyA9IEFycmF5LmZyb20odW5pcXVlQm9va2luZ3NNYXAudmFsdWVzKCkpO1xyXG5cclxuICAgIC8vIFNvcnQgYnkgc2VydmljZV9kYXRlIGFuZCBzZXJ2aWNlX3RpbWVcclxuICAgIGJvb2tpbmdzLnNvcnQoKGEsIGIpID0+IHtcclxuICAgICAgY29uc3QgZGF0ZUNvbXBhcmUgPSBhLnNlcnZpY2VfZGF0ZS5sb2NhbGVDb21wYXJlKGIuc2VydmljZV9kYXRlKTtcclxuICAgICAgaWYgKGRhdGVDb21wYXJlICE9PSAwKSByZXR1cm4gZGF0ZUNvbXBhcmU7XHJcbiAgICAgIHJldHVybiBhLnNlcnZpY2VfdGltZS5sb2NhbGVDb21wYXJlKGIuc2VydmljZV90aW1lKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGJvb2tpbmdzIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIGdldENsZWFuZXJCb29raW5nczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0ZhaWxlZCB0byBmZXRjaCBib29raW5ncycsXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIENhbGN1bGF0ZSBjbGVhbmVyIGVhcm5pbmdzIGZvciBhIHNwZWNpZmljIGJvb2tpbmdcclxuICogVGhpcyBoZWxwZXIgZnVuY3Rpb24gaXMgdXNlZCB0byBkaXNwbGF5IGVhcm5pbmdzIG9uIGJvb2tpbmcgZGV0YWlscyBwYWdlXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2FsY3VsYXRlQm9va2luZ0Vhcm5pbmdzKGJvb2tpbmdJZDogc3RyaW5nKTogUHJvbWlzZTx7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBlYXJuaW5ncz86IHtcclxuICAgIGJhc2VFYXJuaW5nczogbnVtYmVyO1xyXG4gICAgdGlwQW1vdW50OiBudW1iZXI7XHJcbiAgICB0b3RhbEVhcm5pbmdzOiBudW1iZXI7XHJcbiAgICBlYXJuaW5nc1BlcmNlbnRhZ2U6IG51bWJlcjtcclxuICB9O1xyXG4gIGVycm9yPzogc3RyaW5nO1xyXG59PiB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIEdldCBhdXRoZW50aWNhdGVkIGNsZWFuZXIgZmlyc3RcclxuICAgIGNvbnN0IGNsZWFuZXJSZXN1bHQgPSBhd2FpdCBnZXRDdXJyZW50Q2xlYW5lcigpO1xyXG4gICAgaWYgKCFjbGVhbmVyUmVzdWx0LnN1Y2Nlc3MgfHwgIWNsZWFuZXJSZXN1bHQuY2xlYW5lcikge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdOb3QgYXV0aGVudGljYXRlZCBvciBjbGVhbmVyIHByb2ZpbGUgbm90IGZvdW5kJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGNsZWFuZXJJZCA9IGNsZWFuZXJSZXN1bHQuY2xlYW5lci5pZDtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQ2xpZW50KCk7XHJcblxyXG4gICAgLy8gR2V0IGNsZWFuZXIgaW5mbyBmb3IgdGVudXJlIGNhbGN1bGF0aW9uXHJcbiAgICBjb25zdCB7IGRhdGE6IGNsZWFuZXIsIGVycm9yOiBjbGVhbmVyRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdjbGVhbmVycycpXHJcbiAgICAgIC5zZWxlY3QoJ2NyZWF0ZWRfYXQnKVxyXG4gICAgICAuZXEoJ2lkJywgY2xlYW5lcklkKVxyXG4gICAgICAubWF5YmVTaW5nbGUoKTtcclxuXHJcbiAgICBpZiAoY2xlYW5lckVycm9yIHx8ICFjbGVhbmVyKSB7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0NsZWFuZXIgbm90IGZvdW5kJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEdldCB0aGUgYm9va2luZ1xyXG4gICAgY29uc3QgeyBkYXRhOiBib29raW5nLCBlcnJvcjogYm9va2luZ0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnYm9va2luZ3MnKVxyXG4gICAgICAuc2VsZWN0KCcqJylcclxuICAgICAgLmVxKCdpZCcsIGJvb2tpbmdJZClcclxuICAgICAgLm1heWJlU2luZ2xlKCk7XHJcblxyXG4gICAgaWYgKGJvb2tpbmdFcnJvciB8fCAhYm9va2luZykge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdCb29raW5nIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDYWxjdWxhdGUgdGVudXJlIGFuZCB0b3RhbCBob3VycyB0byBkZXRlcm1pbmUgcGVyY2VudGFnZVxyXG4gICAgLy8gRm9yIHNpbmdsZSBib29raW5nIGRpc3BsYXksIHdlIG5lZWQgYWxsIHBhaWQgY29tcGxldGVkIGJvb2tpbmdzIHRvIGNhbGN1bGF0ZSBob3Vyc1xyXG4gICAgLy8gVXNlIHRoZSBzYW1lIGFwcHJvYWNoIGFzIGdldENsZWFuZXJTdGF0c1xyXG4gICAgY29uc3QgeyBkYXRhOiBzaW5nbGVCb29raW5ncyB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2Jvb2tpbmdzJylcclxuICAgICAgLnNlbGVjdCgnc3RhdHVzLCBwYXltZW50X3N0YXR1cywgc2VydmljZV9kdXJhdGlvbiwgcHJlZmVycmVkX2NsZWFuZXJfaWQsIHByZWZlcnJlZF9jbGVhbmVyX2lkcycpXHJcbiAgICAgIC5lcSgncHJlZmVycmVkX2NsZWFuZXJfaWQnLCBjbGVhbmVySWQpO1xyXG5cclxuICAgIGNvbnN0IHsgZGF0YTogYWxsTXVsdGlCb29raW5ncyB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2Jvb2tpbmdzJylcclxuICAgICAgLnNlbGVjdCgnc3RhdHVzLCBwYXltZW50X3N0YXR1cywgc2VydmljZV9kdXJhdGlvbiwgcHJlZmVycmVkX2NsZWFuZXJfaWQsIHByZWZlcnJlZF9jbGVhbmVyX2lkcycpXHJcbiAgICAgIC5ub3QoJ3ByZWZlcnJlZF9jbGVhbmVyX2lkcycsICdpcycsIG51bGwpO1xyXG5cclxuICAgIC8vIEZpbHRlciBib29raW5ncyBhc3NpZ25lZCB0byB0aGlzIGNsZWFuZXJcclxuICAgIGNvbnN0IG5vcm1hbGl6ZVV1aWQgPSAoaWQ6IGFueSk6IHN0cmluZyA9PiB7XHJcbiAgICAgIGlmICghaWQpIHJldHVybiAnJztcclxuICAgICAgcmV0dXJuIFN0cmluZyhpZCkudG9Mb3dlckNhc2UoKS50cmltKCk7XHJcbiAgICB9O1xyXG4gICAgY29uc3Qgbm9ybWFsaXplZENsZWFuZXJJZCA9IG5vcm1hbGl6ZVV1aWQoY2xlYW5lcklkKTtcclxuXHJcbiAgICBjb25zdCBhcnJheUJvb2tpbmdzID0gKGFsbE11bHRpQm9va2luZ3MgfHwgW10pLmZpbHRlcigoYjogYW55KSA9PiB7XHJcbiAgICAgIGlmICghYi5wcmVmZXJyZWRfY2xlYW5lcl9pZHMgfHwgIUFycmF5LmlzQXJyYXkoYi5wcmVmZXJyZWRfY2xlYW5lcl9pZHMpKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChiLnByZWZlcnJlZF9jbGVhbmVyX2lkcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGIucHJlZmVycmVkX2NsZWFuZXJfaWRzLnNvbWUoKGlkOiBzdHJpbmcpID0+IG5vcm1hbGl6ZVV1aWQoaWQpID09PSBub3JtYWxpemVkQ2xlYW5lcklkKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIENvbWJpbmUgYW5kIHJlbW92ZSBkdXBsaWNhdGVzXHJcbiAgICBjb25zdCBhbGxCb29raW5nc01hcCA9IG5ldyBNYXA8c3RyaW5nLCBhbnk+KCk7XHJcbiAgICAoc2luZ2xlQm9va2luZ3MgfHwgW10pLmZvckVhY2goKGI6IGFueSkgPT4ge1xyXG4gICAgICBpZiAoYi5pZCkge1xyXG4gICAgICAgIGFsbEJvb2tpbmdzTWFwLnNldChiLmlkLCBiKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBhcnJheUJvb2tpbmdzLmZvckVhY2goKGI6IGFueSkgPT4ge1xyXG4gICAgICBpZiAoYi5pZCAmJiAhYWxsQm9va2luZ3NNYXAuaGFzKGIuaWQpKSB7XHJcbiAgICAgICAgYWxsQm9va2luZ3NNYXAuc2V0KGIuaWQsIGIpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBjbGVhbmVyQm9va2luZ3MgPSBBcnJheS5mcm9tKGFsbEJvb2tpbmdzTWFwLnZhbHVlcygpKTtcclxuXHJcbiAgICBjb25zdCB0ZW51cmVNb250aHMgPSBjYWxjdWxhdGVDbGVhbmVyVGVudXJlKGNsZWFuZXIuY3JlYXRlZF9hdCk7XHJcbiAgICBjb25zdCB0b3RhbEhvdXJzID0gY2FsY3VsYXRlVG90YWxIb3VycyhjbGVhbmVyQm9va2luZ3MpO1xyXG4gICAgY29uc3QgZWFybmluZ3NQZXJjZW50YWdlID0gZ2V0RWFybmluZ3NQZXJjZW50YWdlKHRlbnVyZU1vbnRocywgdG90YWxIb3Vycyk7XHJcblxyXG4gICAgLy8gQ2FsY3VsYXRlIGJhc2UgZWFybmluZ3NcclxuICAgIGNvbnN0IGJhc2VFYXJuaW5ncyA9IGNhbGN1bGF0ZUNsZWFuZXJFYXJuaW5ncyhcclxuICAgICAge1xyXG4gICAgICAgIHNlcnZpY2VfdHlwZTogYm9va2luZy5zZXJ2aWNlX3R5cGUgfHwgJycsXHJcbiAgICAgICAgdG90YWxfYW1vdW50OiBOdW1iZXIoYm9va2luZy50b3RhbF9hbW91bnQpIHx8IDAsXHJcbiAgICAgICAgc2VydmljZV9mZWU6IE51bWJlcihib29raW5nLnNlcnZpY2VfZmVlKSB8fCAwLFxyXG4gICAgICAgIHByZWZlcnJlZF9jbGVhbmVyX2lkczogYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMsXHJcbiAgICAgICAgcHJlZmVycmVkX2NsZWFuZXJfaWQ6IGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWQsXHJcbiAgICAgIH0sXHJcbiAgICAgIGNsZWFuZXJJZCxcclxuICAgICAgZWFybmluZ3NQZXJjZW50YWdlLFxyXG4gICAgICBib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkc1xyXG4gICAgKTtcclxuXHJcbiAgICAvLyBDYWxjdWxhdGUgdGlwIHBlciBjbGVhbmVyXHJcbiAgICBjb25zdCB0aXBBbW91bnQgPSBjYWxjdWxhdGVUaXBQZXJDbGVhbmVyKFxyXG4gICAgICBOdW1iZXIoYm9va2luZy50aXBfYW1vdW50KSB8fCAwLFxyXG4gICAgICBib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcyxcclxuICAgICAgYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZFxyXG4gICAgKTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICBlYXJuaW5nczoge1xyXG4gICAgICAgIGJhc2VFYXJuaW5ncyxcclxuICAgICAgICB0aXBBbW91bnQsXHJcbiAgICAgICAgdG90YWxFYXJuaW5nczogYmFzZUVhcm5pbmdzICsgdGlwQW1vdW50LFxyXG4gICAgICAgIGVhcm5pbmdzUGVyY2VudGFnZSxcclxuICAgICAgfSxcclxuICAgIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNhbGN1bGF0aW5nIGJvb2tpbmcgZWFybmluZ3M6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdGYWlsZWQgdG8gY2FsY3VsYXRlIGVhcm5pbmdzJyxcclxuICAgIH07XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogR2V0IGEgc3BlY2lmaWMgYm9va2luZyBieSBJRCAob25seSBpZiBhc3NpZ25lZCB0byBhdXRoZW50aWNhdGVkIGNsZWFuZXIpXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q2xlYW5lckJvb2tpbmdCeUlkKFxyXG4gIGJvb2tpbmdJZDogc3RyaW5nXHJcbik6IFByb21pc2U8e1xyXG4gIHN1Y2Nlc3M6IGJvb2xlYW47XHJcbiAgYm9va2luZz86IEJvb2tpbmc7XHJcbiAgZXJyb3I/OiBzdHJpbmc7XHJcbn0+IHtcclxuICB0cnkge1xyXG4gICAgLy8gR2V0IGF1dGhlbnRpY2F0ZWQgY2xlYW5lciBmaXJzdFxyXG4gICAgY29uc3QgY2xlYW5lclJlc3VsdCA9IGF3YWl0IGdldEN1cnJlbnRDbGVhbmVyKCk7XHJcbiAgICBpZiAoIWNsZWFuZXJSZXN1bHQuc3VjY2VzcyB8fCAhY2xlYW5lclJlc3VsdC5jbGVhbmVyKSB7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ05vdCBhdXRoZW50aWNhdGVkIG9yIGNsZWFuZXIgcHJvZmlsZSBub3QgZm91bmQnIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgY2xlYW5lcklkID0gY2xlYW5lclJlc3VsdC5jbGVhbmVyLmlkO1xyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBhd2FpdCBjcmVhdGVDbGllbnQoKTtcclxuXHJcbiAgICAvLyBGZXRjaCB0aGUgYm9va2luZ1xyXG4gICAgY29uc3QgeyBkYXRhOiBib29raW5nLCBlcnJvcjogZmV0Y2hFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2Jvb2tpbmdzJylcclxuICAgICAgLnNlbGVjdCgnKicpXHJcbiAgICAgIC5lcSgnaWQnLCBib29raW5nSWQpXHJcbiAgICAgIC5tYXliZVNpbmdsZSgpO1xyXG5cclxuICAgIGlmIChmZXRjaEVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGJvb2tpbmc6JywgZmV0Y2hFcnJvcik7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0Jvb2tpbmcgbm90IGZvdW5kJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIGlmICghYm9va2luZykge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdCb29raW5nIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBWZXJpZnkgdGhlIGNsZWFuZXIgaXMgYXNzaWduZWQgdG8gdGhpcyBib29raW5nXHJcbiAgICBjb25zdCBub3JtYWxpemVVdWlkID0gKGlkOiBhbnkpOiBzdHJpbmcgPT4ge1xyXG4gICAgICBpZiAoIWlkKSByZXR1cm4gJyc7XHJcbiAgICAgIHJldHVybiBTdHJpbmcoaWQpLnRvTG93ZXJDYXNlKCkudHJpbSgpO1xyXG4gICAgfTtcclxuICAgIGNvbnN0IG5vcm1hbGl6ZWRDbGVhbmVySWQgPSBub3JtYWxpemVVdWlkKGNsZWFuZXJJZCk7XHJcblxyXG4gICAgLy8gQ2hlY2sgc2luZ2xlIGNsZWFuZXIgYXNzaWdubWVudFxyXG4gICAgY29uc3QgaXNBc3NpZ25lZFNpbmdsZSA9IGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWQgJiYgXHJcbiAgICAgIG5vcm1hbGl6ZVV1aWQoYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZCkgPT09IG5vcm1hbGl6ZWRDbGVhbmVySWQ7XHJcblxyXG4gICAgLy8gQ2hlY2sgbXVsdGlwbGUgY2xlYW5lciBhc3NpZ25tZW50XHJcbiAgICBsZXQgaXNBc3NpZ25lZE11bHRpcGxlID0gZmFsc2U7XHJcbiAgICBpZiAoYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMgJiYgQXJyYXkuaXNBcnJheShib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcykpIHtcclxuICAgICAgaXNBc3NpZ25lZE11bHRpcGxlID0gYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMuc29tZShcclxuICAgICAgICAoaWQ6IHN0cmluZykgPT4gbm9ybWFsaXplVXVpZChpZCkgPT09IG5vcm1hbGl6ZWRDbGVhbmVySWRcclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIWlzQXNzaWduZWRTaW5nbGUgJiYgIWlzQXNzaWduZWRNdWx0aXBsZSkge1xyXG4gICAgICByZXR1cm4geyBcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSwgXHJcbiAgICAgICAgZXJyb3I6ICdVbmF1dGhvcml6ZWQ6IFlvdSBhcmUgbm90IGFzc2lnbmVkIHRvIHRoaXMgYm9va2luZycgXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgYm9va2luZzogYm9va2luZyBhcyBCb29raW5nIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIGdldENsZWFuZXJCb29raW5nQnlJZDonLCBlcnJvcik7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0ZhaWxlZCB0byBmZXRjaCBib29raW5nJyxcclxuICAgIH07XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogVXBkYXRlIGJvb2tpbmcgc3RhdHVzICh3aXRoIGF1dGhvcml6YXRpb24gY2hlY2sgZm9yIGF1dGhlbnRpY2F0ZWQgY2xlYW5lcilcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVCb29raW5nU3RhdHVzKFxyXG4gIGJvb2tpbmdJZDogc3RyaW5nLFxyXG4gIHN0YXR1czogQm9va2luZ1snc3RhdHVzJ11cclxuKTogUHJvbWlzZTx7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBib29raW5nPzogQm9va2luZztcclxuICBlcnJvcj86IHN0cmluZztcclxufT4ge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBHZXQgYXV0aGVudGljYXRlZCBjbGVhbmVyIGZpcnN0XHJcbiAgICBjb25zdCBjbGVhbmVyUmVzdWx0ID0gYXdhaXQgZ2V0Q3VycmVudENsZWFuZXIoKTtcclxuICAgIGlmICghY2xlYW5lclJlc3VsdC5zdWNjZXNzIHx8ICFjbGVhbmVyUmVzdWx0LmNsZWFuZXIpIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnTm90IGF1dGhlbnRpY2F0ZWQgb3IgY2xlYW5lciBwcm9maWxlIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBjbGVhbmVySWQgPSBjbGVhbmVyUmVzdWx0LmNsZWFuZXIuaWQ7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xyXG5cclxuICAgIC8vIEZpcnN0LCB2ZXJpZnkgdGhlIGNsZWFuZXIgaXMgYXNzaWduZWQgdG8gdGhpcyBib29raW5nXHJcbiAgICBjb25zdCB7IGRhdGE6IGJvb2tpbmcsIGVycm9yOiBmZXRjaEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnYm9va2luZ3MnKVxyXG4gICAgICAuc2VsZWN0KCcqJylcclxuICAgICAgLmVxKCdpZCcsIGJvb2tpbmdJZClcclxuICAgICAgLm1heWJlU2luZ2xlKCk7XHJcblxyXG4gICAgaWYgKGZldGNoRXJyb3IgfHwgIWJvb2tpbmcpIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnQm9va2luZyBub3QgZm91bmQnIH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2hlY2sgYXV0aG9yaXphdGlvbjogY2xlYW5lciBtdXN0IGJlIGFzc2lnbmVkIHRvIHRoaXMgYm9va2luZ1xyXG4gICAgY29uc3Qgbm9ybWFsaXplVXVpZCA9IChpZDogYW55KTogc3RyaW5nID0+IHtcclxuICAgICAgaWYgKCFpZCkgcmV0dXJuICcnO1xyXG4gICAgICByZXR1cm4gU3RyaW5nKGlkKS50b0xvd2VyQ2FzZSgpLnRyaW0oKTtcclxuICAgIH07XHJcbiAgICBjb25zdCBub3JtYWxpemVkQ2xlYW5lcklkID0gbm9ybWFsaXplVXVpZChjbGVhbmVySWQpO1xyXG5cclxuICAgIGNvbnN0IGlzQXNzaWduZWRTaW5nbGUgPSBib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkICYmIFxyXG4gICAgICBub3JtYWxpemVVdWlkKGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWQpID09PSBub3JtYWxpemVkQ2xlYW5lcklkO1xyXG5cclxuICAgIGxldCBpc0Fzc2lnbmVkTXVsdGlwbGUgPSBmYWxzZTtcclxuICAgIGlmIChib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcyAmJiBBcnJheS5pc0FycmF5KGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWRzKSkge1xyXG4gICAgICBpc0Fzc2lnbmVkTXVsdGlwbGUgPSBib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcy5zb21lKFxyXG4gICAgICAgIChpZDogc3RyaW5nKSA9PiBub3JtYWxpemVVdWlkKGlkKSA9PT0gbm9ybWFsaXplZENsZWFuZXJJZFxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGlzQXNzaWduZWQgPSBpc0Fzc2lnbmVkU2luZ2xlIHx8IGlzQXNzaWduZWRNdWx0aXBsZTtcclxuXHJcbiAgICBpZiAoIWlzQXNzaWduZWQpIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnVW5hdXRob3JpemVkOiBZb3UgYXJlIG5vdCBhc3NpZ25lZCB0byB0aGlzIGJvb2tpbmcnIH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVmFsaWRhdGUgc3RhdHVzIHRyYW5zaXRpb25cclxuICAgIGNvbnN0IHZhbGlkVHJhbnNpdGlvbnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZ1tdPiA9IHtcclxuICAgICAgJ3BlbmRpbmcnOiBbJ2NvbmZpcm1lZCcsICdjYW5jZWxsZWQnXSxcclxuICAgICAgJ2NvbmZpcm1lZCc6IFsnb25fbXlfd2F5JywgJ2NhbmNlbGxlZCddLFxyXG4gICAgICAnb25fbXlfd2F5JzogWydzdGFydGVkJywgJ2NhbmNlbGxlZCddLFxyXG4gICAgICAnc3RhcnRlZCc6IFsnY29tcGxldGVkJywgJ2NhbmNlbGxlZCddLFxyXG4gICAgICAnY29tcGxldGVkJzogW10sXHJcbiAgICAgICdjYW5jZWxsZWQnOiBbXSxcclxuICAgIH07XHJcblxyXG4gICAgY29uc3QgY3VycmVudFN0YXR1cyA9IGJvb2tpbmcuc3RhdHVzO1xyXG4gICAgY29uc3QgYWxsb3dlZFN0YXR1c2VzID0gdmFsaWRUcmFuc2l0aW9uc1tjdXJyZW50U3RhdHVzXSB8fCBbXTtcclxuICAgIFxyXG4gICAgaWYgKCFhbGxvd2VkU3RhdHVzZXMuaW5jbHVkZXMoc3RhdHVzKSAmJiBzdGF0dXMgIT09IGN1cnJlbnRTdGF0dXMpIHtcclxuICAgICAgcmV0dXJuIHsgXHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsIFxyXG4gICAgICAgIGVycm9yOiBgSW52YWxpZCBzdGF0dXMgdHJhbnNpdGlvbjogY2Fubm90IGNoYW5nZSBmcm9tICR7Y3VycmVudFN0YXR1c30gdG8gJHtzdGF0dXN9YCBcclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBVcGRhdGUgYm9va2luZyBzdGF0dXNcclxuICAgIGNvbnN0IHsgZGF0YTogdXBkYXRlZEJvb2tpbmcsIGVycm9yOiB1cGRhdGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2Jvb2tpbmdzJylcclxuICAgICAgLnVwZGF0ZSh7IFxyXG4gICAgICAgIHN0YXR1cyxcclxuICAgICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgIH0pXHJcbiAgICAgIC5lcSgnaWQnLCBib29raW5nSWQpXHJcbiAgICAgIC5zZWxlY3QoKVxyXG4gICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgaWYgKHVwZGF0ZUVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGJvb2tpbmcgc3RhdHVzOicsIHVwZGF0ZUVycm9yKTtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiB1cGRhdGVFcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgYm9va2luZzogdXBkYXRlZEJvb2tpbmcgYXMgQm9va2luZyB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiB1cGRhdGVCb29raW5nU3RhdHVzOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnRmFpbGVkIHRvIHVwZGF0ZSBib29raW5nIHN0YXR1cycsXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFJlcG9ydCBsYXRlbmVzcyBmb3IgYSBib29raW5nICh3aXRoIGF1dGhvcml6YXRpb24gY2hlY2sgZm9yIGF1dGhlbnRpY2F0ZWQgY2xlYW5lcilcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXBvcnRMYXRlbmVzcyhcclxuICBib29raW5nSWQ6IHN0cmluZyxcclxuICBleHBlY3RlZEFycml2YWxUaW1lOiBzdHJpbmcsIC8vIElTTyB0aW1lc3RhbXBcclxuICByZWFzb246IHN0cmluZ1xyXG4pOiBQcm9taXNlPHtcclxuICBzdWNjZXNzOiBib29sZWFuO1xyXG4gIGJvb2tpbmc/OiBCb29raW5nO1xyXG4gIGVycm9yPzogc3RyaW5nO1xyXG59PiB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIEdldCBhdXRoZW50aWNhdGVkIGNsZWFuZXIgZmlyc3RcclxuICAgIGNvbnN0IGNsZWFuZXJSZXN1bHQgPSBhd2FpdCBnZXRDdXJyZW50Q2xlYW5lcigpO1xyXG4gICAgaWYgKCFjbGVhbmVyUmVzdWx0LnN1Y2Nlc3MgfHwgIWNsZWFuZXJSZXN1bHQuY2xlYW5lcikge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdOb3QgYXV0aGVudGljYXRlZCBvciBjbGVhbmVyIHByb2ZpbGUgbm90IGZvdW5kJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGNsZWFuZXJJZCA9IGNsZWFuZXJSZXN1bHQuY2xlYW5lci5pZDtcclxuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQ2xpZW50KCk7XHJcblxyXG4gICAgLy8gVmVyaWZ5IGF1dGhvcml6YXRpb25cclxuICAgIGNvbnN0IHsgZGF0YTogYm9va2luZywgZXJyb3I6IGZldGNoRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdib29raW5ncycpXHJcbiAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAuZXEoJ2lkJywgYm9va2luZ0lkKVxyXG4gICAgICAubWF5YmVTaW5nbGUoKTtcclxuXHJcbiAgICBpZiAoZmV0Y2hFcnJvciB8fCAhYm9va2luZykge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdCb29raW5nIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDaGVjayBhdXRob3JpemF0aW9uOiBjbGVhbmVyIG11c3QgYmUgYXNzaWduZWQgdG8gdGhpcyBib29raW5nXHJcbiAgICBjb25zdCBub3JtYWxpemVVdWlkID0gKGlkOiBhbnkpOiBzdHJpbmcgPT4ge1xyXG4gICAgICBpZiAoIWlkKSByZXR1cm4gJyc7XHJcbiAgICAgIHJldHVybiBTdHJpbmcoaWQpLnRvTG93ZXJDYXNlKCkudHJpbSgpO1xyXG4gICAgfTtcclxuICAgIGNvbnN0IG5vcm1hbGl6ZWRDbGVhbmVySWQgPSBub3JtYWxpemVVdWlkKGNsZWFuZXJJZCk7XHJcblxyXG4gICAgY29uc3QgaXNBc3NpZ25lZFNpbmdsZSA9IGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWQgJiYgXHJcbiAgICAgIG5vcm1hbGl6ZVV1aWQoYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZCkgPT09IG5vcm1hbGl6ZWRDbGVhbmVySWQ7XHJcblxyXG4gICAgbGV0IGlzQXNzaWduZWRNdWx0aXBsZSA9IGZhbHNlO1xyXG4gICAgaWYgKGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWRzICYmIEFycmF5LmlzQXJyYXkoYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMpKSB7XHJcbiAgICAgIGlzQXNzaWduZWRNdWx0aXBsZSA9IGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWRzLnNvbWUoXHJcbiAgICAgICAgKGlkOiBzdHJpbmcpID0+IG5vcm1hbGl6ZVV1aWQoaWQpID09PSBub3JtYWxpemVkQ2xlYW5lcklkXHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgaXNBc3NpZ25lZCA9IGlzQXNzaWduZWRTaW5nbGUgfHwgaXNBc3NpZ25lZE11bHRpcGxlO1xyXG5cclxuICAgIGlmICghaXNBc3NpZ25lZCkge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdVbmF1dGhvcml6ZWQ6IFlvdSBhcmUgbm90IGFzc2lnbmVkIHRvIHRoaXMgYm9va2luZycgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBVcGRhdGUgYm9va2luZyB3aXRoIGxhdGVuZXNzIGluZm9ybWF0aW9uXHJcbiAgICBjb25zdCB7IGRhdGE6IHVwZGF0ZWRCb29raW5nLCBlcnJvcjogdXBkYXRlRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdib29raW5ncycpXHJcbiAgICAgIC51cGRhdGUoe1xyXG4gICAgICAgIGV4cGVjdGVkX2Fycml2YWxfdGltZTogZXhwZWN0ZWRBcnJpdmFsVGltZSxcclxuICAgICAgICBsYXRlbmVzc19yZWFzb246IHJlYXNvbixcclxuICAgICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgIH0pXHJcbiAgICAgIC5lcSgnaWQnLCBib29raW5nSWQpXHJcbiAgICAgIC5zZWxlY3QoKVxyXG4gICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgaWYgKHVwZGF0ZUVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlcG9ydGluZyBsYXRlbmVzczonLCB1cGRhdGVFcnJvcik7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogdXBkYXRlRXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGJvb2tpbmc6IHVwZGF0ZWRCb29raW5nIGFzIEJvb2tpbmcgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gcmVwb3J0TGF0ZW5lc3M6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdGYWlsZWQgdG8gcmVwb3J0IGxhdGVuZXNzJyxcclxuICAgIH07XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogQ2FsY3VsYXRlIGVhcm5pbmdzIGZvciBtdWx0aXBsZSBib29raW5ncyBhdCBvbmNlXHJcbiAqIFRoaXMgaXMgbW9yZSBlZmZpY2llbnQgdGhhbiBjYWxjdWxhdGluZyBlYXJuaW5ncyBvbmUgYm9va2luZyBhdCBhIHRpbWVcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjYWxjdWxhdGVCb29raW5nc0Vhcm5pbmdzKGJvb2tpbmdJZHM6IHN0cmluZ1tdKTogUHJvbWlzZTx7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBlYXJuaW5ncz86IFJlY29yZDxzdHJpbmcsIHsgYmFzZUVhcm5pbmdzOiBudW1iZXI7IHRpcEFtb3VudDogbnVtYmVyOyB0b3RhbEVhcm5pbmdzOiBudW1iZXIgfT47XHJcbiAgZXJyb3I/OiBzdHJpbmc7XHJcbn0+IHtcclxuICB0cnkge1xyXG4gICAgLy8gR2V0IGF1dGhlbnRpY2F0ZWQgY2xlYW5lciBmaXJzdFxyXG4gICAgY29uc3QgY2xlYW5lclJlc3VsdCA9IGF3YWl0IGdldEN1cnJlbnRDbGVhbmVyKCk7XHJcbiAgICBpZiAoIWNsZWFuZXJSZXN1bHQuc3VjY2VzcyB8fCAhY2xlYW5lclJlc3VsdC5jbGVhbmVyKSB7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ05vdCBhdXRoZW50aWNhdGVkIG9yIGNsZWFuZXIgcHJvZmlsZSBub3QgZm91bmQnIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgY2xlYW5lcklkID0gY2xlYW5lclJlc3VsdC5jbGVhbmVyLmlkO1xyXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBhd2FpdCBjcmVhdGVDbGllbnQoKTtcclxuXHJcbiAgICBpZiAoYm9va2luZ0lkcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZWFybmluZ3M6IHt9IH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gR2V0IGNsZWFuZXIgaW5mbyBmb3IgdGVudXJlIGNhbGN1bGF0aW9uXHJcbiAgICBjb25zdCB7IGRhdGE6IGNsZWFuZXIsIGVycm9yOiBjbGVhbmVyRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdjbGVhbmVycycpXHJcbiAgICAgIC5zZWxlY3QoJ2NyZWF0ZWRfYXQnKVxyXG4gICAgICAuZXEoJ2lkJywgY2xlYW5lcklkKVxyXG4gICAgICAubWF5YmVTaW5nbGUoKTtcclxuXHJcbiAgICBpZiAoY2xlYW5lckVycm9yIHx8ICFjbGVhbmVyKSB7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0NsZWFuZXIgbm90IGZvdW5kJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEdldCBhbGwgYm9va2luZ3NcclxuICAgIGNvbnN0IHsgZGF0YTogYm9va2luZ3MsIGVycm9yOiBib29raW5nc0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnYm9va2luZ3MnKVxyXG4gICAgICAuc2VsZWN0KCcqJylcclxuICAgICAgLmluKCdpZCcsIGJvb2tpbmdJZHMpO1xyXG5cclxuICAgIGlmIChib29raW5nc0Vycm9yIHx8ICFib29raW5ncykge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdGYWlsZWQgdG8gZmV0Y2ggYm9va2luZ3MnIH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gR2V0IGFsbCBjbGVhbmVyIGJvb2tpbmdzIHRvIGNhbGN1bGF0ZSBob3Vyc1xyXG4gICAgY29uc3QgeyBkYXRhOiBzaW5nbGVCb29raW5ncyB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2Jvb2tpbmdzJylcclxuICAgICAgLnNlbGVjdCgnc3RhdHVzLCBwYXltZW50X3N0YXR1cywgc2VydmljZV9kdXJhdGlvbiwgcHJlZmVycmVkX2NsZWFuZXJfaWQsIHByZWZlcnJlZF9jbGVhbmVyX2lkcycpXHJcbiAgICAgIC5lcSgncHJlZmVycmVkX2NsZWFuZXJfaWQnLCBjbGVhbmVySWQpO1xyXG5cclxuICAgIGNvbnN0IHsgZGF0YTogYWxsTXVsdGlCb29raW5ncyB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2Jvb2tpbmdzJylcclxuICAgICAgLnNlbGVjdCgnc3RhdHVzLCBwYXltZW50X3N0YXR1cywgc2VydmljZV9kdXJhdGlvbiwgcHJlZmVycmVkX2NsZWFuZXJfaWQsIHByZWZlcnJlZF9jbGVhbmVyX2lkcycpXHJcbiAgICAgIC5ub3QoJ3ByZWZlcnJlZF9jbGVhbmVyX2lkcycsICdpcycsIG51bGwpO1xyXG5cclxuICAgIC8vIEZpbHRlciBib29raW5ncyBhc3NpZ25lZCB0byB0aGlzIGNsZWFuZXJcclxuICAgIGNvbnN0IG5vcm1hbGl6ZVV1aWQgPSAoaWQ6IGFueSk6IHN0cmluZyA9PiB7XHJcbiAgICAgIGlmICghaWQpIHJldHVybiAnJztcclxuICAgICAgcmV0dXJuIFN0cmluZyhpZCkudG9Mb3dlckNhc2UoKS50cmltKCk7XHJcbiAgICB9O1xyXG4gICAgY29uc3Qgbm9ybWFsaXplZENsZWFuZXJJZCA9IG5vcm1hbGl6ZVV1aWQoY2xlYW5lcklkKTtcclxuXHJcbiAgICBjb25zdCBhcnJheUJvb2tpbmdzID0gKGFsbE11bHRpQm9va2luZ3MgfHwgW10pLmZpbHRlcigoYjogYW55KSA9PiB7XHJcbiAgICAgIGlmICghYi5wcmVmZXJyZWRfY2xlYW5lcl9pZHMgfHwgIUFycmF5LmlzQXJyYXkoYi5wcmVmZXJyZWRfY2xlYW5lcl9pZHMpKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChiLnByZWZlcnJlZF9jbGVhbmVyX2lkcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGIucHJlZmVycmVkX2NsZWFuZXJfaWRzLnNvbWUoKGlkOiBzdHJpbmcpID0+IG5vcm1hbGl6ZVV1aWQoaWQpID09PSBub3JtYWxpemVkQ2xlYW5lcklkKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIENvbWJpbmUgYW5kIHJlbW92ZSBkdXBsaWNhdGVzXHJcbiAgICBjb25zdCBhbGxCb29raW5nc01hcCA9IG5ldyBNYXA8c3RyaW5nLCBhbnk+KCk7XHJcbiAgICAoc2luZ2xlQm9va2luZ3MgfHwgW10pLmZvckVhY2goKGI6IGFueSkgPT4ge1xyXG4gICAgICBpZiAoYi5pZCkge1xyXG4gICAgICAgIGFsbEJvb2tpbmdzTWFwLnNldChiLmlkLCBiKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBhcnJheUJvb2tpbmdzLmZvckVhY2goKGI6IGFueSkgPT4ge1xyXG4gICAgICBpZiAoYi5pZCAmJiAhYWxsQm9va2luZ3NNYXAuaGFzKGIuaWQpKSB7XHJcbiAgICAgICAgYWxsQm9va2luZ3NNYXAuc2V0KGIuaWQsIGIpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBjbGVhbmVyQm9va2luZ3MgPSBBcnJheS5mcm9tKGFsbEJvb2tpbmdzTWFwLnZhbHVlcygpKTtcclxuXHJcbiAgICAvLyBDYWxjdWxhdGUgdGVudXJlIGFuZCBob3Vyc1xyXG4gICAgY29uc3QgdGVudXJlTW9udGhzID0gY2FsY3VsYXRlQ2xlYW5lclRlbnVyZShjbGVhbmVyLmNyZWF0ZWRfYXQpO1xyXG4gICAgY29uc3QgdG90YWxIb3VycyA9IGNhbGN1bGF0ZVRvdGFsSG91cnMoY2xlYW5lckJvb2tpbmdzKTtcclxuICAgIGNvbnN0IGVhcm5pbmdzUGVyY2VudGFnZSA9IGdldEVhcm5pbmdzUGVyY2VudGFnZSh0ZW51cmVNb250aHMsIHRvdGFsSG91cnMpO1xyXG5cclxuICAgIC8vIENhbGN1bGF0ZSBlYXJuaW5ncyBmb3IgZWFjaCBib29raW5nXHJcbiAgICBjb25zdCBlYXJuaW5nc1JlY29yZDogUmVjb3JkPHN0cmluZywgeyBiYXNlRWFybmluZ3M6IG51bWJlcjsgdGlwQW1vdW50OiBudW1iZXI7IHRvdGFsRWFybmluZ3M6IG51bWJlciB9PiA9IHt9O1xyXG5cclxuICAgIGZvciAoY29uc3QgYm9va2luZyBvZiBib29raW5ncykge1xyXG4gICAgICBjb25zdCBiYXNlRWFybmluZ3MgPSBjYWxjdWxhdGVDbGVhbmVyRWFybmluZ3MoXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgc2VydmljZV90eXBlOiBib29raW5nLnNlcnZpY2VfdHlwZSB8fCAnJyxcclxuICAgICAgICAgIHRvdGFsX2Ftb3VudDogTnVtYmVyKGJvb2tpbmcudG90YWxfYW1vdW50KSB8fCAwLFxyXG4gICAgICAgICAgc2VydmljZV9mZWU6IE51bWJlcihib29raW5nLnNlcnZpY2VfZmVlKSB8fCAwLFxyXG4gICAgICAgICAgZXF1aXBtZW50X3N1cHBseV9wcmljZTogTnVtYmVyKGJvb2tpbmcuZXF1aXBtZW50X3N1cHBseV9wcmljZSkgfHwgMCxcclxuICAgICAgICAgIGFkZGl0aW9uYWxfY2xlYW5lcnNfcHJpY2U6IE51bWJlcihib29raW5nLmFkZGl0aW9uYWxfY2xlYW5lcnNfcHJpY2UpIHx8IDAsXHJcbiAgICAgICAgICBwcmVmZXJyZWRfY2xlYW5lcl9pZHM6IGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWRzLFxyXG4gICAgICAgICAgcHJlZmVycmVkX2NsZWFuZXJfaWQ6IGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWQsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBjbGVhbmVySWQsXHJcbiAgICAgICAgZWFybmluZ3NQZXJjZW50YWdlLFxyXG4gICAgICAgIGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWRzXHJcbiAgICAgICk7XHJcblxyXG4gICAgICBjb25zdCB0aXBBbW91bnQgPSBjYWxjdWxhdGVUaXBQZXJDbGVhbmVyKFxyXG4gICAgICAgIE51bWJlcihib29raW5nLnRpcF9hbW91bnQpIHx8IDAsXHJcbiAgICAgICAgYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMsXHJcbiAgICAgICAgYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZFxyXG4gICAgICApO1xyXG5cclxuICAgICAgZWFybmluZ3NSZWNvcmRbYm9va2luZy5pZF0gPSB7XHJcbiAgICAgICAgYmFzZUVhcm5pbmdzLFxyXG4gICAgICAgIHRpcEFtb3VudCxcclxuICAgICAgICB0b3RhbEVhcm5pbmdzOiBiYXNlRWFybmluZ3MgKyB0aXBBbW91bnQsXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZWFybmluZ3M6IGVhcm5pbmdzUmVjb3JkIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNhbGN1bGF0aW5nIGJvb2tpbmdzIGVhcm5pbmdzOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnRmFpbGVkIHRvIGNhbGN1bGF0ZSBlYXJuaW5ncycsXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEdldCBjbGVhbmVyIHN0YXRpc3RpY3MgZm9yIHRoZSBhdXRoZW50aWNhdGVkIGNsZWFuZXJcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDbGVhbmVyU3RhdHMoKTogUHJvbWlzZTx7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBzdGF0cz86IHtcclxuICAgIHRvdGFsQm9va2luZ3M6IG51bWJlcjtcclxuICAgIGNvbXBsZXRlZEJvb2tpbmdzOiBudW1iZXI7XHJcbiAgICB1cGNvbWluZ0Jvb2tpbmdzOiBudW1iZXI7XHJcbiAgICB0b2RheUJvb2tpbmdzOiBudW1iZXI7XHJcbiAgICB0b3RhbEVhcm5pbmdzOiBudW1iZXI7XHJcbiAgICBtb250aGx5RWFybmluZ3M6IG51bWJlcjtcclxuICAgIGF2ZXJhZ2VSYXRpbmc6IG51bWJlcjtcclxuICAgIHJlbGlhYmlsaXR5U2NvcmU6IG51bWJlcjtcclxuICAgIGNvbXBsZXRpb25SYXRlOiBudW1iZXI7XHJcbiAgICBvblRpbWVSYXRlOiBudW1iZXI7XHJcbiAgfTtcclxuICBlcnJvcj86IHN0cmluZztcclxufT4ge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBHZXQgYXV0aGVudGljYXRlZCBjbGVhbmVyIGZpcnN0XHJcbiAgICBjb25zdCBjbGVhbmVyUmVzdWx0ID0gYXdhaXQgZ2V0Q3VycmVudENsZWFuZXIoKTtcclxuICAgIGlmICghY2xlYW5lclJlc3VsdC5zdWNjZXNzIHx8ICFjbGVhbmVyUmVzdWx0LmNsZWFuZXIpIHtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnTm90IGF1dGhlbnRpY2F0ZWQgb3IgY2xlYW5lciBwcm9maWxlIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBjbGVhbmVySWQgPSBjbGVhbmVyUmVzdWx0LmNsZWFuZXIuaWQ7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xyXG5cclxuICAgIC8vIEdldCBjbGVhbmVyIGluZm8gaW5jbHVkaW5nIGNyZWF0ZWRfYXQgZm9yIHRlbnVyZSBjYWxjdWxhdGlvblxyXG4gICAgY29uc3QgeyBkYXRhOiBjbGVhbmVyLCBlcnJvcjogY2xlYW5lckVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnY2xlYW5lcnMnKVxyXG4gICAgICAuc2VsZWN0KCdyYXRpbmcsIHJlbGlhYmlsaXR5X3Njb3JlLCB0b3RhbF9ib29raW5ncywgY29tcGxldGVkX2Jvb2tpbmdzLCBvbl90aW1lX2Jvb2tpbmdzLCBjcmVhdGVkX2F0JylcclxuICAgICAgLmVxKCdpZCcsIGNsZWFuZXJJZClcclxuICAgICAgLm1heWJlU2luZ2xlKCk7XHJcblxyXG4gICAgaWYgKGNsZWFuZXJFcnJvciB8fCAhY2xlYW5lcikge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdDbGVhbmVyIG5vdCBmb3VuZCcgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBHZXQgYWxsIGJvb2tpbmdzIGFzc2lnbmVkIHRvIHRoaXMgY2xlYW5lclxyXG4gICAgLy8gRmV0Y2ggYm9va2luZ3Mgd2l0aCBwcmVmZXJyZWRfY2xlYW5lcl9pZCAoc2luZ2xlKSAtIGluY2x1ZGUgYWxsIGZpZWxkcyBuZWVkZWQgZm9yIGVhcm5pbmdzIGNhbGN1bGF0aW9uXHJcbiAgICBjb25zdCB7IGRhdGE6IHNpbmdsZUJvb2tpbmdzLCBlcnJvcjogc2luZ2xlRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCdib29raW5ncycpXHJcbiAgICAgIC5zZWxlY3QoJ2lkLCBzdGF0dXMsIHNlcnZpY2VfZGF0ZSwgdG90YWxfYW1vdW50LCBwYXltZW50X3N0YXR1cywgc2VydmljZV90eXBlLCBzZXJ2aWNlX2ZlZSwgc3VidG90YWwsIHRpcF9hbW91bnQsIHNlcnZpY2VfZHVyYXRpb24sIGVxdWlwbWVudF9zdXBwbHlfcHJpY2UsIGFkZGl0aW9uYWxfY2xlYW5lcnNfcHJpY2UsIHByZWZlcnJlZF9jbGVhbmVyX2lkLCBwcmVmZXJyZWRfY2xlYW5lcl9pZHMnKVxyXG4gICAgICAuZXEoJ3ByZWZlcnJlZF9jbGVhbmVyX2lkJywgY2xlYW5lcklkKTtcclxuXHJcbiAgICAvLyBGZXRjaCBib29raW5ncyB3aXRoIHByZWZlcnJlZF9jbGVhbmVyX2lkcyAoYXJyYXkpIC0gZmV0Y2ggYWxsIHdpdGggYXJyYXlzLCB0aGVuIGZpbHRlciBpbiBKU1xyXG4gICAgY29uc3QgeyBkYXRhOiBhbGxNdWx0aUJvb2tpbmdzLCBlcnJvcjogbXVsdGlFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2Jvb2tpbmdzJylcclxuICAgICAgLnNlbGVjdCgnaWQsIHN0YXR1cywgc2VydmljZV9kYXRlLCB0b3RhbF9hbW91bnQsIHBheW1lbnRfc3RhdHVzLCBzZXJ2aWNlX3R5cGUsIHNlcnZpY2VfZmVlLCBzdWJ0b3RhbCwgdGlwX2Ftb3VudCwgc2VydmljZV9kdXJhdGlvbiwgZXF1aXBtZW50X3N1cHBseV9wcmljZSwgYWRkaXRpb25hbF9jbGVhbmVyc19wcmljZSwgcHJlZmVycmVkX2NsZWFuZXJfaWRzLCBwcmVmZXJyZWRfY2xlYW5lcl9pZCcpXHJcbiAgICAgIC5ub3QoJ3ByZWZlcnJlZF9jbGVhbmVyX2lkcycsICdpcycsIG51bGwpO1xyXG5cclxuICAgIGlmIChzaW5nbGVFcnJvciB8fCBtdWx0aUVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGJvb2tpbmdzIGZvciBzdGF0czonLCBzaW5nbGVFcnJvciB8fCBtdWx0aUVycm9yKTtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAoc2luZ2xlRXJyb3IgfHwgbXVsdGlFcnJvcik/Lm1lc3NhZ2UgfHwgJ0ZhaWxlZCB0byBmZXRjaCBib29raW5ncycgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBEZWJ1ZyBsb2dnaW5nXHJcbiAgICBjb25zb2xlLmxvZygnW2dldENsZWFuZXJTdGF0c10gRmV0Y2hlZCBib29raW5nczonLCB7XHJcbiAgICAgIGNsZWFuZXJJZCxcclxuICAgICAgc2luZ2xlQm9va2luZ3NDb3VudDogc2luZ2xlQm9va2luZ3M/Lmxlbmd0aCB8fCAwLFxyXG4gICAgICBhbGxNdWx0aUJvb2tpbmdzQ291bnQ6IGFsbE11bHRpQm9va2luZ3M/Lmxlbmd0aCB8fCAwLFxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gRmlsdGVyIGJvb2tpbmdzIHdoZXJlIHByZWZlcnJlZF9jbGVhbmVyX2lkcyBhcnJheSBjb250YWlucyB0aGlzIGNsZWFuZXJJZFxyXG4gICAgLy8gTm9ybWFsaXplIFVVSURzIGZvciBjb21wYXJpc29uIChoYW5kbGUgY2FzZSBkaWZmZXJlbmNlcyBhbmQgc3RyaW5nIGZvcm1hdHMpXHJcbiAgICBjb25zdCBub3JtYWxpemVVdWlkID0gKGlkOiBhbnkpOiBzdHJpbmcgPT4ge1xyXG4gICAgICBpZiAoIWlkKSByZXR1cm4gJyc7XHJcbiAgICAgIHJldHVybiBTdHJpbmcoaWQpLnRvTG93ZXJDYXNlKCkudHJpbSgpO1xyXG4gICAgfTtcclxuICAgIGNvbnN0IG5vcm1hbGl6ZWRDbGVhbmVySWQgPSBub3JtYWxpemVVdWlkKGNsZWFuZXJJZCk7XHJcbiAgICBcclxuICAgIGNvbnN0IGFycmF5Qm9va2luZ3MgPSAoYWxsTXVsdGlCb29raW5ncyB8fCBbXSkuZmlsdGVyKChib29raW5nOiBhbnkpID0+IHtcclxuICAgICAgaWYgKCFib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcyB8fCAhQXJyYXkuaXNBcnJheShib29raW5nLnByZWZlcnJlZF9jbGVhbmVyX2lkcykpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgLy8gQ2hlY2sgaWYgYXJyYXkgaXMgZW1wdHlcclxuICAgICAgaWYgKGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWRzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgICAvLyBDaGVjayBpZiBhbnkgSUQgaW4gdGhlIGFycmF5IG1hdGNoZXMgdGhlIGNsZWFuZXJJZCAoY2FzZS1pbnNlbnNpdGl2ZSlcclxuICAgICAgcmV0dXJuIGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWRzLnNvbWUoKGlkOiBzdHJpbmcpID0+IG5vcm1hbGl6ZVV1aWQoaWQpID09PSBub3JtYWxpemVkQ2xlYW5lcklkKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIENvbWJpbmUgYW5kIHJlbW92ZSBkdXBsaWNhdGVzIGJ5IElEXHJcbiAgICBjb25zdCBhbGxCb29raW5nc01hcCA9IG5ldyBNYXA8c3RyaW5nLCBhbnk+KCk7XHJcbiAgICAoc2luZ2xlQm9va2luZ3MgfHwgW10pLmZvckVhY2goKGJvb2tpbmc6IGFueSkgPT4ge1xyXG4gICAgICBpZiAoYm9va2luZy5pZCkge1xyXG4gICAgICAgIGFsbEJvb2tpbmdzTWFwLnNldChib29raW5nLmlkLCBib29raW5nKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBhcnJheUJvb2tpbmdzLmZvckVhY2goKGJvb2tpbmc6IGFueSkgPT4ge1xyXG4gICAgICBpZiAoYm9va2luZy5pZCAmJiAhYWxsQm9va2luZ3NNYXAuaGFzKGJvb2tpbmcuaWQpKSB7XHJcbiAgICAgICAgYWxsQm9va2luZ3NNYXAuc2V0KGJvb2tpbmcuaWQsIGJvb2tpbmcpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgY29uc3QgYWxsQm9va2luZ3MgPSBBcnJheS5mcm9tKGFsbEJvb2tpbmdzTWFwLnZhbHVlcygpKTtcclxuXHJcbiAgICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xyXG4gICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcclxuICAgIGNvbnN0IGZpcnN0RGF5T2ZNb250aCA9IG5ldyBEYXRlKG5vdy5nZXRGdWxsWWVhcigpLCBub3cuZ2V0TW9udGgoKSwgMSkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xyXG4gICAgY29uc3QgY29tcGxldGVkQm9va2luZ3MgPSBhbGxCb29raW5ncy5maWx0ZXIoYiA9PiBiLnN0YXR1cyA9PT0gJ2NvbXBsZXRlZCcpO1xyXG4gICAgY29uc3QgdXBjb21pbmdCb29raW5ncyA9IGFsbEJvb2tpbmdzLmZpbHRlcihiID0+IFxyXG4gICAgICBbJ3BlbmRpbmcnLCAnY29uZmlybWVkJywgJ29uX215X3dheScsICdzdGFydGVkJ10uaW5jbHVkZXMoYi5zdGF0dXMpICYmXHJcbiAgICAgIGIuc2VydmljZV9kYXRlID49IHRvZGF5XHJcbiAgICApO1xyXG4gICAgY29uc3QgdG9kYXlCb29raW5ncyA9IGFsbEJvb2tpbmdzLmZpbHRlcihiID0+IGIuc2VydmljZV9kYXRlID09PSB0b2RheSk7XHJcbiAgICBjb25zdCBwYWlkQm9va2luZ3MgPSBhbGxCb29raW5ncy5maWx0ZXIoYiA9PiBiLnBheW1lbnRfc3RhdHVzID09PSAncGFpZCcpO1xyXG4gICAgY29uc3QgbW9udGhseVBhaWRCb29raW5ncyA9IHBhaWRCb29raW5ncy5maWx0ZXIoYiA9PiBiLnNlcnZpY2VfZGF0ZSA+PSBmaXJzdERheU9mTW9udGgpO1xyXG5cclxuICAgIC8vIENhbGN1bGF0ZSBjbGVhbmVyIHRlbnVyZSBhbmQgdG90YWwgaG91cnMgZm9yIGVsaWdpYmlsaXR5IGRldGVybWluYXRpb25cclxuICAgIGNvbnN0IHRlbnVyZU1vbnRocyA9IGNhbGN1bGF0ZUNsZWFuZXJUZW51cmUoY2xlYW5lci5jcmVhdGVkX2F0KTtcclxuICAgIGNvbnN0IHRvdGFsSG91cnMgPSBjYWxjdWxhdGVUb3RhbEhvdXJzKGFsbEJvb2tpbmdzKTtcclxuICAgIGNvbnN0IGVhcm5pbmdzUGVyY2VudGFnZSA9IGdldEVhcm5pbmdzUGVyY2VudGFnZSh0ZW51cmVNb250aHMsIHRvdGFsSG91cnMpO1xyXG5cclxuICAgIC8vIENhbGN1bGF0ZSBlYXJuaW5ncyB1c2luZyB0aGUgbmV3IHN5c3RlbVxyXG4gICAgLy8gT25seSBjYWxjdWxhdGUgZWFybmluZ3MgZm9yIHBhaWQgYm9va2luZ3MgKGVhcm5pbmdzIGFyZSBvbmx5IHBhaWQgd2hlbiBjdXN0b21lciBoYXMgcGFpZClcclxuICAgIC8vIEVxdWlwbWVudCBmZWUgYW5kIGFkZGl0aW9uYWwgY2xlYW5lcnMgY2hhcmdlcyBhcmUgZXhjbHVkZWQgZnJvbSBjbGVhbmVyIGVhcm5pbmdzXHJcbiAgICBjb25zdCB0b3RhbEVhcm5pbmdzID0gcGFpZEJvb2tpbmdzLnJlZHVjZSgoc3VtLCBib29raW5nKSA9PiB7XHJcbiAgICAgIGNvbnN0IGVhcm5pbmdzID0gY2FsY3VsYXRlVG90YWxFYXJuaW5nc0Zyb21Cb29raW5nKFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIHNlcnZpY2VfdHlwZTogYm9va2luZy5zZXJ2aWNlX3R5cGUgfHwgJycsXHJcbiAgICAgICAgICB0b3RhbF9hbW91bnQ6IE51bWJlcihib29raW5nLnRvdGFsX2Ftb3VudCkgfHwgMCxcclxuICAgICAgICAgIHNlcnZpY2VfZmVlOiBOdW1iZXIoYm9va2luZy5zZXJ2aWNlX2ZlZSkgfHwgMCxcclxuICAgICAgICAgIGVxdWlwbWVudF9zdXBwbHlfcHJpY2U6IE51bWJlcihib29raW5nLmVxdWlwbWVudF9zdXBwbHlfcHJpY2UpIHx8IDAsXHJcbiAgICAgICAgICBhZGRpdGlvbmFsX2NsZWFuZXJzX3ByaWNlOiBOdW1iZXIoYm9va2luZy5hZGRpdGlvbmFsX2NsZWFuZXJzX3ByaWNlKSB8fCAwLFxyXG4gICAgICAgICAgdGlwX2Ftb3VudDogTnVtYmVyKGJvb2tpbmcudGlwX2Ftb3VudCkgfHwgMCxcclxuICAgICAgICAgIHByZWZlcnJlZF9jbGVhbmVyX2lkczogYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZHMsXHJcbiAgICAgICAgICBwcmVmZXJyZWRfY2xlYW5lcl9pZDogYm9va2luZy5wcmVmZXJyZWRfY2xlYW5lcl9pZCxcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNsZWFuZXJJZCxcclxuICAgICAgICBlYXJuaW5nc1BlcmNlbnRhZ2VcclxuICAgICAgKTtcclxuICAgICAgcmV0dXJuIHN1bSArIGVhcm5pbmdzO1xyXG4gICAgfSwgMCk7XHJcblxyXG4gICAgY29uc3QgbW9udGhseUVhcm5pbmdzID0gbW9udGhseVBhaWRCb29raW5ncy5yZWR1Y2UoKHN1bSwgYm9va2luZykgPT4ge1xyXG4gICAgICBjb25zdCBlYXJuaW5ncyA9IGNhbGN1bGF0ZVRvdGFsRWFybmluZ3NGcm9tQm9va2luZyhcclxuICAgICAgICB7XHJcbiAgICAgICAgICBzZXJ2aWNlX3R5cGU6IGJvb2tpbmcuc2VydmljZV90eXBlIHx8ICcnLFxyXG4gICAgICAgICAgdG90YWxfYW1vdW50OiBOdW1iZXIoYm9va2luZy50b3RhbF9hbW91bnQpIHx8IDAsXHJcbiAgICAgICAgICBzZXJ2aWNlX2ZlZTogTnVtYmVyKGJvb2tpbmcuc2VydmljZV9mZWUpIHx8IDAsXHJcbiAgICAgICAgICBlcXVpcG1lbnRfc3VwcGx5X3ByaWNlOiBOdW1iZXIoYm9va2luZy5lcXVpcG1lbnRfc3VwcGx5X3ByaWNlKSB8fCAwLFxyXG4gICAgICAgICAgYWRkaXRpb25hbF9jbGVhbmVyc19wcmljZTogTnVtYmVyKGJvb2tpbmcuYWRkaXRpb25hbF9jbGVhbmVyc19wcmljZSkgfHwgMCxcclxuICAgICAgICAgIHRpcF9hbW91bnQ6IE51bWJlcihib29raW5nLnRpcF9hbW91bnQpIHx8IDAsXHJcbiAgICAgICAgICBwcmVmZXJyZWRfY2xlYW5lcl9pZHM6IGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWRzLFxyXG4gICAgICAgICAgcHJlZmVycmVkX2NsZWFuZXJfaWQ6IGJvb2tpbmcucHJlZmVycmVkX2NsZWFuZXJfaWQsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBjbGVhbmVySWQsXHJcbiAgICAgICAgZWFybmluZ3NQZXJjZW50YWdlXHJcbiAgICAgICk7XHJcbiAgICAgIHJldHVybiBzdW0gKyBlYXJuaW5ncztcclxuICAgIH0sIDApO1xyXG5cclxuICAgIGNvbnN0IGNvbXBsZXRpb25SYXRlID0gY2xlYW5lci50b3RhbF9ib29raW5ncyBcclxuICAgICAgPyAoY2xlYW5lci5jb21wbGV0ZWRfYm9va2luZ3MgfHwgMCkgLyBjbGVhbmVyLnRvdGFsX2Jvb2tpbmdzICogMTAwIFxyXG4gICAgICA6IDA7XHJcbiAgICBcclxuICAgIGNvbnN0IG9uVGltZVJhdGUgPSBjbGVhbmVyLmNvbXBsZXRlZF9ib29raW5nc1xyXG4gICAgICA/IChjbGVhbmVyLm9uX3RpbWVfYm9va2luZ3MgfHwgMCkgLyBjbGVhbmVyLmNvbXBsZXRlZF9ib29raW5ncyAqIDEwMFxyXG4gICAgICA6IDA7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgc3RhdHM6IHtcclxuICAgICAgICB0b3RhbEJvb2tpbmdzOiBhbGxCb29raW5ncy5sZW5ndGgsXHJcbiAgICAgICAgY29tcGxldGVkQm9va2luZ3M6IGNvbXBsZXRlZEJvb2tpbmdzLmxlbmd0aCxcclxuICAgICAgICB1cGNvbWluZ0Jvb2tpbmdzOiB1cGNvbWluZ0Jvb2tpbmdzLmxlbmd0aCxcclxuICAgICAgICB0b2RheUJvb2tpbmdzOiB0b2RheUJvb2tpbmdzLmxlbmd0aCxcclxuICAgICAgICB0b3RhbEVhcm5pbmdzLFxyXG4gICAgICAgIG1vbnRobHlFYXJuaW5ncyxcclxuICAgICAgICBhdmVyYWdlUmF0aW5nOiBOdW1iZXIoY2xlYW5lci5yYXRpbmcpIHx8IDAsXHJcbiAgICAgICAgcmVsaWFiaWxpdHlTY29yZTogTnVtYmVyKGNsZWFuZXIucmVsaWFiaWxpdHlfc2NvcmUpIHx8IDAsXHJcbiAgICAgICAgY29tcGxldGlvblJhdGUsXHJcbiAgICAgICAgb25UaW1lUmF0ZSxcclxuICAgICAgfSxcclxuICAgIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIGdldENsZWFuZXJTdGF0czonLCBlcnJvcik7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0ZhaWxlZCB0byBmZXRjaCBzdGF0cycsXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFVwZGF0ZSBjbGVhbmVyIGF2YWlsYWJpbGl0eVxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUNsZWFuZXJBdmFpbGFiaWxpdHkoXHJcbiAgY2xlYW5lcklkOiBzdHJpbmcsXHJcbiAgdXBkYXRlczoge1xyXG4gICAgaXNBdmFpbGFibGU/OiBib29sZWFuO1xyXG4gICAgYXZhaWxhYmxlTW9uZGF5PzogYm9vbGVhbjtcclxuICAgIGF2YWlsYWJsZVR1ZXNkYXk/OiBib29sZWFuO1xyXG4gICAgYXZhaWxhYmxlV2VkbmVzZGF5PzogYm9vbGVhbjtcclxuICAgIGF2YWlsYWJsZVRodXJzZGF5PzogYm9vbGVhbjtcclxuICAgIGF2YWlsYWJsZUZyaWRheT86IGJvb2xlYW47XHJcbiAgICBhdmFpbGFibGVTYXR1cmRheT86IGJvb2xlYW47XHJcbiAgICBhdmFpbGFibGVTdW5kYXk/OiBib29sZWFuO1xyXG4gIH1cclxuKTogUHJvbWlzZTx7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBjbGVhbmVyPzogQ2xlYW5lcjtcclxuICBlcnJvcj86IHN0cmluZztcclxufT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xyXG5cclxuICAgIGNvbnN0IHVwZGF0ZURhdGE6IGFueSA9IHtcclxuICAgICAgdXBkYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgfTtcclxuXHJcbiAgICBpZiAodXBkYXRlcy5pc0F2YWlsYWJsZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHVwZGF0ZURhdGEuaXNfYXZhaWxhYmxlID0gdXBkYXRlcy5pc0F2YWlsYWJsZTtcclxuICAgIH1cclxuICAgIGlmICh1cGRhdGVzLmF2YWlsYWJsZU1vbmRheSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHVwZGF0ZURhdGEuYXZhaWxhYmxlX21vbmRheSA9IHVwZGF0ZXMuYXZhaWxhYmxlTW9uZGF5O1xyXG4gICAgfVxyXG4gICAgaWYgKHVwZGF0ZXMuYXZhaWxhYmxlVHVlc2RheSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHVwZGF0ZURhdGEuYXZhaWxhYmxlX3R1ZXNkYXkgPSB1cGRhdGVzLmF2YWlsYWJsZVR1ZXNkYXk7XHJcbiAgICB9XHJcbiAgICBpZiAodXBkYXRlcy5hdmFpbGFibGVXZWRuZXNkYXkgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB1cGRhdGVEYXRhLmF2YWlsYWJsZV93ZWRuZXNkYXkgPSB1cGRhdGVzLmF2YWlsYWJsZVdlZG5lc2RheTtcclxuICAgIH1cclxuICAgIGlmICh1cGRhdGVzLmF2YWlsYWJsZVRodXJzZGF5ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgdXBkYXRlRGF0YS5hdmFpbGFibGVfdGh1cnNkYXkgPSB1cGRhdGVzLmF2YWlsYWJsZVRodXJzZGF5O1xyXG4gICAgfVxyXG4gICAgaWYgKHVwZGF0ZXMuYXZhaWxhYmxlRnJpZGF5ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgdXBkYXRlRGF0YS5hdmFpbGFibGVfZnJpZGF5ID0gdXBkYXRlcy5hdmFpbGFibGVGcmlkYXk7XHJcbiAgICB9XHJcbiAgICBpZiAodXBkYXRlcy5hdmFpbGFibGVTYXR1cmRheSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHVwZGF0ZURhdGEuYXZhaWxhYmxlX3NhdHVyZGF5ID0gdXBkYXRlcy5hdmFpbGFibGVTYXR1cmRheTtcclxuICAgIH1cclxuICAgIGlmICh1cGRhdGVzLmF2YWlsYWJsZVN1bmRheSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHVwZGF0ZURhdGEuYXZhaWxhYmxlX3N1bmRheSA9IHVwZGF0ZXMuYXZhaWxhYmxlU3VuZGF5O1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHsgZGF0YTogdXBkYXRlZENsZWFuZXIsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnY2xlYW5lcnMnKVxyXG4gICAgICAudXBkYXRlKHVwZGF0ZURhdGEpXHJcbiAgICAgIC5lcSgnaWQnLCBjbGVhbmVySWQpXHJcbiAgICAgIC5zZWxlY3QoKVxyXG4gICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgaWYgKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGNsZWFuZXIgYXZhaWxhYmlsaXR5OicsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgY2xlYW5lcjogdXBkYXRlZENsZWFuZXIgYXMgQ2xlYW5lciB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiB1cGRhdGVDbGVhbmVyQXZhaWxhYmlsaXR5OicsIGVycm9yKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnRmFpbGVkIHRvIHVwZGF0ZSBhdmFpbGFiaWxpdHknLFxyXG4gICAgfTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJvU0Eyc0JzQixzTUFBQSJ9
}),
"[project]/src/components/ui/tabs.tsx [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Tabs",
    ()=>Tabs,
    "TabsContent",
    ()=>TabsContent,
    "TabsList",
    ()=>TabsList,
    "TabsTrigger",
    ()=>TabsTrigger
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$tabs$2f$dist$2f$index$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@radix-ui/react-tabs/dist/index.mjs [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/lib/utils.ts [app-ssr] (ecmascript)");
;
;
;
;
const Tabs = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$tabs$2f$dist$2f$index$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["Root"];
const TabsList = /*#__PURE__*/ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["forwardRef"](({ className, ...props }, ref)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$tabs$2f$dist$2f$index$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["List"], {
        ref: ref,
        className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["cn"])("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground", className),
        ...props
    }, void 0, false, {
        fileName: "[project]/src/components/ui/tabs.tsx",
        lineNumber: 12,
        columnNumber: 3
    }, ("TURBOPACK compile-time value", void 0)));
TabsList.displayName = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$tabs$2f$dist$2f$index$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["List"].displayName;
const TabsTrigger = /*#__PURE__*/ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["forwardRef"](({ className, ...props }, ref)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$tabs$2f$dist$2f$index$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["Trigger"], {
        ref: ref,
        className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["cn"])("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50", className),
        ...props
    }, void 0, false, {
        fileName: "[project]/src/components/ui/tabs.tsx",
        lineNumber: 27,
        columnNumber: 3
    }, ("TURBOPACK compile-time value", void 0)));
TabsTrigger.displayName = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$tabs$2f$dist$2f$index$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["Trigger"].displayName;
const TabsContent = /*#__PURE__*/ __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["forwardRef"](({ className, ...props }, ref)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$tabs$2f$dist$2f$index$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["Content"], {
        ref: ref,
        className: (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$utils$2e$ts__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["cn"])("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2", className),
        ...props
    }, void 0, false, {
        fileName: "[project]/src/components/ui/tabs.tsx",
        lineNumber: 42,
        columnNumber: 3
    }, ("TURBOPACK compile-time value", void 0)));
TabsContent.displayName = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$radix$2d$ui$2f$react$2d$tabs$2f$dist$2f$index$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["Content"].displayName;
;
}),
"[project]/app/cleaner/(dashboard)/bookings/page.tsx [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "default",
    ()=>CleanerBookingsPage
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$tanstack$2f$react$2d$query$2f$build$2f$modern$2f$useQuery$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@tanstack/react-query/build/modern/useQuery.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$cleaner$2f$components$2f$CleanerBookingCard$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/app/cleaner/components/CleanerBookingCard.tsx [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$cleaner$2f$data$3a$9a70e2__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$text$2f$javascript$3e$__ = __turbopack_context__.i("[project]/app/cleaner/data:9a70e2 [app-ssr] (ecmascript) <text/javascript>");
var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$cleaner$2f$data$3a$ad2aa4__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$text$2f$javascript$3e$__ = __turbopack_context__.i("[project]/app/cleaner/data:ad2aa4 [app-ssr] (ecmascript) <text/javascript>");
var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$cleaner$2f$data$3a$41dff6__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$text$2f$javascript$3e$__ = __turbopack_context__.i("[project]/app/cleaner/data:41dff6 [app-ssr] (ecmascript) <text/javascript>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$loader$2d$circle$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__Loader2$3e$__ = __turbopack_context__.i("[project]/node_modules/lucide-react/dist/esm/icons/loader-circle.js [app-ssr] (ecmascript) <export default as Loader2>");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$card$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/components/ui/card.tsx [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$tabs$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/components/ui/tabs.tsx [app-ssr] (ecmascript)");
'use client';
;
;
;
;
;
;
;
;
function CleanerBookingsPage() {
    const [bookings, setBookings] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["useState"])([]);
    const [loading, setLoading] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["useState"])(false);
    const [filter, setFilter] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["useState"])('today');
    const [cleaner, setCleaner] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["useState"])(null);
    const [bookingsEarnings, setBookingsEarnings] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["useState"])({});
    // Get current cleaner
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$tanstack$2f$react$2d$query$2f$build$2f$modern$2f$useQuery$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["useQuery"])({
        queryKey: [
            'current-cleaner'
        ],
        queryFn: async ()=>{
            const result = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$cleaner$2f$data$3a$ad2aa4__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$text$2f$javascript$3e$__["getCurrentCleaner"])();
            if (result.success && result.cleaner) {
                setCleaner(result.cleaner);
                return result.cleaner;
            }
            return null;
        },
        staleTime: 5 * 60 * 1000
    });
    const loadBookings = async ()=>{
        try {
            setLoading(true);
            const result = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$cleaner$2f$data$3a$9a70e2__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$text$2f$javascript$3e$__["getCleanerBookings"])(filter);
            if (result.success && result.bookings) {
                setBookings(result.bookings);
                // Calculate earnings for all bookings
                const bookingIds = (result.bookings || []).map((b)=>b.id);
                if (bookingIds.length > 0) {
                    const earningsResult = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$cleaner$2f$data$3a$41dff6__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$text$2f$javascript$3e$__["calculateBookingsEarnings"])(bookingIds);
                    if (earningsResult.success && earningsResult.earnings) {
                        setBookingsEarnings(earningsResult.earnings);
                    }
                }
            } else if (result.error) {
                console.error('Error loading bookings:', result.error);
            }
        } catch (error) {
            console.error('Error loading bookings:', error);
        } finally{
            setLoading(false);
        }
    };
    // Ensure filter is always a visible option
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["useEffect"])(()=>{
        if (filter === 'all' || filter === 'on_my_way' || filter === 'started') {
            setFilter('today');
        }
    }, [
        filter
    ]);
    // Load bookings when cleaner is available or filter changes
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["useEffect"])(()=>{
        if (cleaner?.id) {
            loadBookings();
        }
    // eslint-disable-next-line react-hooks/exhaustive-deps
    }, [
        cleaner?.id,
        filter
    ]);
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
        className: "space-y-4 sm:space-y-6 w-full max-w-full overflow-x-hidden",
        children: [
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                children: [
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("h1", {
                        className: "text-2xl sm:text-3xl md:text-4xl font-bold",
                        children: "My Bookings"
                    }, void 0, false, {
                        fileName: "[project]/app/cleaner/(dashboard)/bookings/page.tsx",
                        lineNumber: 79,
                        columnNumber: 9
                    }, this),
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                        className: "text-base sm:text-lg text-muted-foreground mt-1",
                        children: "View and manage all your assigned bookings"
                    }, void 0, false, {
                        fileName: "[project]/app/cleaner/(dashboard)/bookings/page.tsx",
                        lineNumber: 80,
                        columnNumber: 9
                    }, this)
                ]
            }, void 0, true, {
                fileName: "[project]/app/cleaner/(dashboard)/bookings/page.tsx",
                lineNumber: 78,
                columnNumber: 7
            }, this),
            cleaner && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$tabs$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["Tabs"], {
                value: filter,
                onValueChange: (value)=>setFilter(value),
                className: "w-full",
                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$tabs$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["TabsList"], {
                    className: "grid w-full grid-cols-3",
                    children: [
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$tabs$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["TabsTrigger"], {
                            value: "today",
                            children: "Today"
                        }, void 0, false, {
                            fileName: "[project]/app/cleaner/(dashboard)/bookings/page.tsx",
                            lineNumber: 89,
                            columnNumber: 13
                        }, this),
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$tabs$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["TabsTrigger"], {
                            value: "upcoming",
                            children: "Upcoming"
                        }, void 0, false, {
                            fileName: "[project]/app/cleaner/(dashboard)/bookings/page.tsx",
                            lineNumber: 90,
                            columnNumber: 13
                        }, this),
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$tabs$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["TabsTrigger"], {
                            value: "past",
                            children: "Past"
                        }, void 0, false, {
                            fileName: "[project]/app/cleaner/(dashboard)/bookings/page.tsx",
                            lineNumber: 91,
                            columnNumber: 13
                        }, this)
                    ]
                }, void 0, true, {
                    fileName: "[project]/app/cleaner/(dashboard)/bookings/page.tsx",
                    lineNumber: 88,
                    columnNumber: 11
                }, this)
            }, void 0, false, {
                fileName: "[project]/app/cleaner/(dashboard)/bookings/page.tsx",
                lineNumber: 87,
                columnNumber: 9
            }, this),
            !cleaner ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                className: "flex items-center justify-center py-8 sm:py-12",
                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$loader$2d$circle$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__Loader2$3e$__["Loader2"], {
                    className: "w-6 h-6 sm:w-8 sm:h-8 animate-spin text-primary"
                }, void 0, false, {
                    fileName: "[project]/app/cleaner/(dashboard)/bookings/page.tsx",
                    lineNumber: 99,
                    columnNumber: 11
                }, this)
            }, void 0, false, {
                fileName: "[project]/app/cleaner/(dashboard)/bookings/page.tsx",
                lineNumber: 98,
                columnNumber: 9
            }, this) : loading ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                className: "flex items-center justify-center py-8 sm:py-12",
                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$loader$2d$circle$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__Loader2$3e$__["Loader2"], {
                    className: "w-6 h-6 sm:w-8 sm:h-8 animate-spin text-primary"
                }, void 0, false, {
                    fileName: "[project]/app/cleaner/(dashboard)/bookings/page.tsx",
                    lineNumber: 103,
                    columnNumber: 11
                }, this)
            }, void 0, false, {
                fileName: "[project]/app/cleaner/(dashboard)/bookings/page.tsx",
                lineNumber: 102,
                columnNumber: 9
            }, this) : bookings.length === 0 ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$card$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["Card"], {
                className: "w-full max-w-full overflow-hidden",
                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$card$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["CardHeader"], {
                    className: "px-4 py-4 sm:px-6 sm:py-6",
                    children: [
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$card$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["CardTitle"], {
                            className: "text-lg sm:text-xl",
                            children: "No Bookings Found"
                        }, void 0, false, {
                            fileName: "[project]/app/cleaner/(dashboard)/bookings/page.tsx",
                            lineNumber: 108,
                            columnNumber: 13
                        }, this),
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$components$2f$ui$2f$card$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["CardDescription"], {
                            className: "text-sm mt-1",
                            children: `You don't have any ${filter.replace('_', ' ')} bookings.`
                        }, void 0, false, {
                            fileName: "[project]/app/cleaner/(dashboard)/bookings/page.tsx",
                            lineNumber: 109,
                            columnNumber: 13
                        }, this)
                    ]
                }, void 0, true, {
                    fileName: "[project]/app/cleaner/(dashboard)/bookings/page.tsx",
                    lineNumber: 107,
                    columnNumber: 11
                }, this)
            }, void 0, false, {
                fileName: "[project]/app/cleaner/(dashboard)/bookings/page.tsx",
                lineNumber: 106,
                columnNumber: 9
            }, this) : /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                className: "grid gap-3 sm:gap-4",
                children: bookings.map((booking)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$app$2f$cleaner$2f$components$2f$CleanerBookingCard$2e$tsx__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["CleanerBookingCard"], {
                        booking: booking,
                        earnings: bookingsEarnings[booking.id]?.totalEarnings
                    }, booking.id, false, {
                        fileName: "[project]/app/cleaner/(dashboard)/bookings/page.tsx",
                        lineNumber: 117,
                        columnNumber: 13
                    }, this))
            }, void 0, false, {
                fileName: "[project]/app/cleaner/(dashboard)/bookings/page.tsx",
                lineNumber: 115,
                columnNumber: 9
            }, this)
        ]
    }, void 0, true, {
        fileName: "[project]/app/cleaner/(dashboard)/bookings/page.tsx",
        lineNumber: 76,
        columnNumber: 5
    }, this);
}
}),
];

//# sourceMappingURL=_d0626603._.js.map