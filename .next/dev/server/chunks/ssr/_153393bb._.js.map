{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/27825/shalean-v2/shalean-reimagined/src/lib/supabase/server.ts"],"sourcesContent":["import { createServerClient } from '@supabase/ssr'\r\nimport { cookies } from 'next/headers'\r\n\r\nexport async function createClient() {\r\n  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL\r\n  const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY\r\n\r\n  if (!supabaseUrl || !supabaseAnonKey) {\r\n    console.error('Missing Supabase environment variables: NEXT_PUBLIC_SUPABASE_URL or NEXT_PUBLIC_SUPABASE_ANON_KEY')\r\n    throw new Error('Supabase configuration is missing. Please check your environment variables.')\r\n  }\r\n\r\n  try {\r\n    const cookieStore = await cookies()\r\n\r\n    return createServerClient(\r\n      supabaseUrl,\r\n      supabaseAnonKey,\r\n      {\r\n        cookies: {\r\n          getAll() {\r\n            return cookieStore.getAll()\r\n          },\r\n          setAll(cookiesToSet) {\r\n            try {\r\n              cookiesToSet.forEach(({ name, value, options }) =>\r\n                cookieStore.set(name, value, options)\r\n              )\r\n            } catch {\r\n              // The `setAll` method was called from a Server Component.\r\n              // This can be ignored if you have middleware refreshing\r\n              // user sessions.\r\n            }\r\n          },\r\n        },\r\n      }\r\n    )\r\n  } catch (error) {\r\n    console.error('Error creating Supabase client:', error)\r\n    throw error\r\n  }\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;;;AAEO,eAAe;IACpB,MAAM;IACN,MAAM;IAEN;;IAKA,IAAI;QACF,MAAM,cAAc,MAAM,IAAA,0IAAO;QAEjC,OAAO,IAAA,+LAAkB,EACvB,aACA,iBACA;YACE,SAAS;gBACP;oBACE,OAAO,YAAY,MAAM;gBAC3B;gBACA,QAAO,YAAY;oBACjB,IAAI;wBACF,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAC5C,YAAY,GAAG,CAAC,MAAM,OAAO;oBAEjC,EAAE,OAAM;oBACN,0DAA0D;oBAC1D,wDAAwD;oBACxD,iBAAiB;oBACnB;gBACF;YACF;QACF;IAEJ,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,mCAAmC;QACjD,MAAM;IACR;AACF"}},
    {"offset": {"line": 45, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/27825/shalean-v2/shalean-reimagined/app/admin/%28dashboard%29/layout-client.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const AdminLayoutClient = registerClientReference(\n    function() { throw new Error(\"Attempted to call AdminLayoutClient() from the server but AdminLayoutClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/admin/(dashboard)/layout-client.tsx <module evaluation>\",\n    \"AdminLayoutClient\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;AACO,MAAM,oBAAoB,IAAA,wQAAuB,EACpD;IAAa,MAAM,IAAI,MAAM;AAAkP,GAC/Q,yEACA","ignoreList":[0]}},
    {"offset": {"line": 59, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/27825/shalean-v2/shalean-reimagined/app/admin/%28dashboard%29/layout-client.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const AdminLayoutClient = registerClientReference(\n    function() { throw new Error(\"Attempted to call AdminLayoutClient() from the server but AdminLayoutClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/admin/(dashboard)/layout-client.tsx\",\n    \"AdminLayoutClient\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;AACO,MAAM,oBAAoB,IAAA,wQAAuB,EACpD;IAAa,MAAM,IAAI,MAAM;AAAkP,GAC/Q,qDACA","ignoreList":[0]}},
    {"offset": {"line": 73, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 81, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/27825/shalean-v2/shalean-reimagined/src/lib/supabase/server-admin.ts"],"sourcesContent":["import { createClient as createSupabaseClient } from '@supabase/supabase-js'\r\n\r\n/**\r\n * Creates a Supabase client with service role key (bypasses RLS)\r\n * Use this ONLY for server-side operations that need to bypass Row Level Security\r\n * This should only be used in server actions, API routes, and server components\r\n * \r\n * IMPORTANT: Add SUPABASE_SERVICE_ROLE_KEY to your .env.local file\r\n * Get it from: Supabase Dashboard -> Settings -> API -> service_role key (secret)\r\n */\r\nexport function createAdminClient() {\r\n  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!\r\n  const supabaseServiceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY\r\n\r\n  if (!supabaseServiceRoleKey) {\r\n    const errorMsg = 'SUPABASE_SERVICE_ROLE_KEY is not set. This is REQUIRED for profile operations.'\r\n    console.error('‚ùå', errorMsg)\r\n    console.error('üìù Get your service role key from: Supabase Dashboard -> Settings -> API -> service_role key (secret)')\r\n    console.error('üìù Add it to your .env.local file as: SUPABASE_SERVICE_ROLE_KEY=your_key_here')\r\n    \r\n    // Throw an error instead of falling back to anon key\r\n    // This forces users to set the service role key\r\n    throw new Error(errorMsg)\r\n  }\r\n\r\n  // Create client with service role key (bypasses RLS completely)\r\n  const client = createSupabaseClient(supabaseUrl, supabaseServiceRoleKey, {\r\n    auth: {\r\n      autoRefreshToken: false,\r\n      persistSession: false,\r\n    },\r\n    db: {\r\n      schema: 'public',\r\n    },\r\n  })\r\n  \r\n  return client\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAAA;;AAUO,SAAS;IACd,MAAM;IACN,MAAM,yBAAyB,QAAQ,GAAG,CAAC,yBAAyB;IAEpE,IAAI,CAAC,wBAAwB;QAC3B,MAAM,WAAW;QACjB,QAAQ,KAAK,CAAC,KAAK;QACnB,QAAQ,KAAK,CAAC;QACd,QAAQ,KAAK,CAAC;QAEd,qDAAqD;QACrD,gDAAgD;QAChD,MAAM,IAAI,MAAM;IAClB;IAEA,gEAAgE;IAChE,MAAM,SAAS,IAAA,8LAAoB,EAAC,aAAa,wBAAwB;QACvE,MAAM;YACJ,kBAAkB;YAClB,gBAAgB;QAClB;QACA,IAAI;YACF,QAAQ;QACV;IACF;IAEA,OAAO;AACT"}},
    {"offset": {"line": 115, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/27825/shalean-v2/shalean-reimagined/app/admin/actions.ts"],"sourcesContent":["'use server';\r\n\r\nimport { createClient } from '@/lib/supabase/server';\r\nimport { createAdminClient } from '@/lib/supabase/server-admin';\r\nimport { Booking } from '@/types/booking';\r\nimport { Cleaner } from '@/types/booking';\r\nimport { Profile } from '@/types/profile';\r\n\r\n/**\r\n * Check if user is an admin\r\n * Admins are identified by email pattern: *@admin.shalean.local\r\n * or user metadata with role: 'admin'\r\n */\r\nfunction isAdminUser(email: string | undefined, userMetadata?: any): boolean {\r\n  if (!email) return false;\r\n  \r\n  // Check email pattern\r\n  if (email.includes('@admin.shalean.local')) {\r\n    return true;\r\n  }\r\n  \r\n  // Check user metadata\r\n  if (userMetadata?.role === 'admin') {\r\n    return true;\r\n  }\r\n  \r\n  // Hardcoded admin emails (fallback)\r\n  const adminEmails = [\r\n    'admin@shalean.local',\r\n    'admin@admin.shalean.local',\r\n    'admin@shalean.com',\r\n  ];\r\n  \r\n  return adminEmails.includes(email.toLowerCase());\r\n}\r\n\r\n/**\r\n * Get current authenticated admin\r\n */\r\nexport async function getCurrentAdmin(): Promise<{\r\n  success: boolean;\r\n  admin?: {\r\n    id: string;\r\n    email: string;\r\n    name?: string;\r\n  };\r\n  error?: string;\r\n}> {\r\n  try {\r\n    const supabase = await createClient();\r\n    const { data: { user }, error: authError } = await supabase.auth.getUser();\r\n\r\n    if (authError || !user) {\r\n      return { success: false, error: 'Not authenticated' };\r\n    }\r\n\r\n    // Check if user is admin\r\n    if (!isAdminUser(user.email, user.user_metadata)) {\r\n      return { success: false, error: 'Not an admin user' };\r\n    }\r\n\r\n    return {\r\n      success: true,\r\n      admin: {\r\n        id: user.id,\r\n        email: user.email!,\r\n        name: user.user_metadata?.name || user.email?.split('@')[0],\r\n      },\r\n    };\r\n  } catch (error) {\r\n    console.error('Error in getCurrentAdmin:', error);\r\n    return {\r\n      success: false,\r\n      error: error instanceof Error ? error.message : 'Failed to get admin',\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * Authenticate admin (server-side)\r\n * Note: Actual authentication happens client-side, this just verifies the result\r\n */\r\nexport async function authenticateAdmin(\r\n  email: string,\r\n  password: string\r\n): Promise<{\r\n  success: boolean;\r\n  admin?: {\r\n    id: string;\r\n    email: string;\r\n    name?: string;\r\n  };\r\n  error?: string;\r\n}> {\r\n  try {\r\n    // Check if email matches admin pattern\r\n    if (!isAdminUser(email)) {\r\n      return { success: false, error: 'Not an admin email' };\r\n    }\r\n\r\n    // Authentication happens client-side, this is just validation\r\n    const supabase = await createClient();\r\n    const { data, error } = await supabase.auth.signInWithPassword({\r\n      email,\r\n      password,\r\n    });\r\n\r\n    if (error || !data.user) {\r\n      return { success: false, error: 'Invalid credentials' };\r\n    }\r\n\r\n    return {\r\n      success: true,\r\n      admin: {\r\n        id: data.user.id,\r\n        email: data.user.email!,\r\n        name: data.user.user_metadata?.name || data.user.email?.split('@')[0],\r\n      },\r\n    };\r\n  } catch (error) {\r\n    console.error('Error in authenticateAdmin:', error);\r\n    return {\r\n      success: false,\r\n      error: error instanceof Error ? error.message : 'Authentication failed',\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * Get admin statistics\r\n */\r\nexport async function getAdminStats(): Promise<{\r\n  success: boolean;\r\n  stats?: {\r\n    totalBookings: number;\r\n    activeBookings: number;\r\n    totalRevenue: number;\r\n    monthlyRevenue: number;\r\n    totalCustomers: number;\r\n    totalCleaners: number;\r\n    activeCleaners: number;\r\n    completionRate: number;\r\n  };\r\n  error?: string;\r\n}> {\r\n  try {\r\n    // Verify admin access\r\n    const adminResult = await getCurrentAdmin();\r\n    if (!adminResult.success) {\r\n      return { success: false, error: 'Not authenticated as admin' };\r\n    }\r\n\r\n    const supabase = createAdminClient();\r\n\r\n    // Get all bookings\r\n    const { data: bookings, error: bookingsError } = await supabase\r\n      .from('bookings')\r\n      .select('status, total_amount, payment_status, service_date, created_at');\r\n\r\n    if (bookingsError) {\r\n      console.error('Error fetching bookings:', bookingsError);\r\n      return { success: false, error: bookingsError.message };\r\n    }\r\n\r\n    // Get all customers (profiles)\r\n    const { data: customers, error: customersError } = await supabase\r\n      .from('profiles')\r\n      .select('id');\r\n\r\n    if (customersError) {\r\n      console.error('Error fetching customers:', customersError);\r\n      return { success: false, error: customersError.message };\r\n    }\r\n\r\n    // Get all cleaners\r\n    const { data: cleaners, error: cleanersError } = await supabase\r\n      .from('cleaners')\r\n      .select('id, is_active');\r\n\r\n    if (cleanersError) {\r\n      console.error('Error fetching cleaners:', cleanersError);\r\n      return { success: false, error: cleanersError.message };\r\n    }\r\n\r\n    const today = new Date().toISOString().split('T')[0];\r\n    const now = new Date();\r\n    const firstDayOfMonth = new Date(now.getFullYear(), now.getMonth(), 1).toISOString().split('T')[0];\r\n\r\n    const allBookings = bookings || [];\r\n    const activeBookings = allBookings.filter(\r\n      (b) => ['pending', 'confirmed', 'on_my_way', 'started'].includes(b.status)\r\n    ).length;\r\n    \r\n    const paidBookings = allBookings.filter((b) => b.payment_status === 'paid');\r\n    const totalRevenue = paidBookings.reduce((sum, b) => sum + (b.total_amount || 0), 0);\r\n    \r\n    const monthlyPaidBookings = allBookings.filter(\r\n      (b) => b.payment_status === 'paid' && b.service_date >= firstDayOfMonth\r\n    );\r\n    const monthlyRevenue = monthlyPaidBookings.reduce((sum, b) => sum + (b.total_amount || 0), 0);\r\n\r\n    const completedBookings = allBookings.filter((b) => b.status === 'completed').length;\r\n    const completionRate = allBookings.length > 0 ? (completedBookings / allBookings.length) * 100 : 0;\r\n\r\n    const allCleaners = cleaners || [];\r\n    const activeCleaners = allCleaners.filter((c) => c.is_active).length;\r\n\r\n    return {\r\n      success: true,\r\n      stats: {\r\n        totalBookings: allBookings.length,\r\n        activeBookings,\r\n        totalRevenue,\r\n        monthlyRevenue,\r\n        totalCustomers: customers?.length || 0,\r\n        totalCleaners: allCleaners.length,\r\n        activeCleaners,\r\n        completionRate: Math.round(completionRate * 100) / 100,\r\n      },\r\n    };\r\n  } catch (error) {\r\n    console.error('Error in getAdminStats:', error);\r\n    return {\r\n      success: false,\r\n      error: error instanceof Error ? error.message : 'Failed to fetch stats',\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * Get all bookings with optional filters\r\n */\r\nexport async function getAllBookings(\r\n  filter?: {\r\n    status?: string;\r\n    dateFrom?: string;\r\n    dateTo?: string;\r\n    customerEmail?: string;\r\n    cleanerId?: string;\r\n  }\r\n): Promise<{\r\n  success: boolean;\r\n  bookings?: Booking[];\r\n  error?: string;\r\n}> {\r\n  try {\r\n    // Verify admin access\r\n    const adminResult = await getCurrentAdmin();\r\n    if (!adminResult.success) {\r\n      return { success: false, error: 'Not authenticated as admin' };\r\n    }\r\n\r\n    const supabase = createAdminClient();\r\n\r\n    let query = supabase\r\n      .from('bookings')\r\n      .select('*')\r\n      .order('service_date', { ascending: false })\r\n      .order('created_at', { ascending: false });\r\n\r\n    if (filter) {\r\n      if (filter.status && filter.status !== 'all') {\r\n        query = query.eq('status', filter.status);\r\n      }\r\n      if (filter.dateFrom) {\r\n        query = query.gte('service_date', filter.dateFrom);\r\n      }\r\n      if (filter.dateTo) {\r\n        query = query.lte('service_date', filter.dateTo);\r\n      }\r\n      if (filter.customerEmail) {\r\n        query = query.eq('customer_email', filter.customerEmail);\r\n      }\r\n      if (filter.cleanerId) {\r\n        query = query.eq('preferred_cleaner_id', filter.cleanerId);\r\n      }\r\n    }\r\n\r\n    const { data, error } = await query;\r\n\r\n    if (error) {\r\n      console.error('Error fetching bookings:', error);\r\n      return { success: false, error: error.message };\r\n    }\r\n\r\n    return { success: true, bookings: data || [] };\r\n  } catch (error) {\r\n    console.error('Error in getAllBookings:', error);\r\n    return {\r\n      success: false,\r\n      error: error instanceof Error ? error.message : 'Failed to fetch bookings',\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * Get all customers\r\n */\r\nexport async function getAllCustomers(): Promise<{\r\n  success: boolean;\r\n  customers?: Profile[];\r\n  error?: string;\r\n}> {\r\n  try {\r\n    // Verify admin access\r\n    const adminResult = await getCurrentAdmin();\r\n    if (!adminResult.success) {\r\n      return { success: false, error: 'Not authenticated as admin' };\r\n    }\r\n\r\n    const supabase = createAdminClient();\r\n\r\n    const { data, error } = await supabase\r\n      .from('profiles')\r\n      .select('*')\r\n      .order('created_at', { ascending: false });\r\n\r\n    if (error) {\r\n      console.error('Error fetching customers:', error);\r\n      return { success: false, error: error.message };\r\n    }\r\n\r\n    return { success: true, customers: data || [] };\r\n  } catch (error) {\r\n    console.error('Error in getAllCustomers:', error);\r\n    return {\r\n      success: false,\r\n      error: error instanceof Error ? error.message : 'Failed to fetch customers',\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * Get all cleaners\r\n */\r\nexport async function getAllCleaners(): Promise<{\r\n  success: boolean;\r\n  cleaners?: Cleaner[];\r\n  error?: string;\r\n}> {\r\n  try {\r\n    // Verify admin access\r\n    const adminResult = await getCurrentAdmin();\r\n    if (!adminResult.success) {\r\n      return { success: false, error: 'Not authenticated as admin' };\r\n    }\r\n\r\n    const supabase = createAdminClient();\r\n\r\n    const { data, error } = await supabase\r\n      .from('cleaners')\r\n      .select('*')\r\n      .order('created_at', { ascending: false });\r\n\r\n    if (error) {\r\n      console.error('Error fetching cleaners:', error);\r\n      return { success: false, error: error.message };\r\n    }\r\n\r\n    return { success: true, cleaners: data || [] };\r\n  } catch (error) {\r\n    console.error('Error in getAllCleaners:', error);\r\n    return {\r\n      success: false,\r\n      error: error instanceof Error ? error.message : 'Failed to fetch cleaners',\r\n    };\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;AAEA;AACA;;;;;AAKA;;;;CAIC,GACD,SAAS,YAAY,KAAyB,EAAE,YAAkB;IAChE,IAAI,CAAC,OAAO,OAAO;IAEnB,sBAAsB;IACtB,IAAI,MAAM,QAAQ,CAAC,yBAAyB;QAC1C,OAAO;IACT;IAEA,sBAAsB;IACtB,IAAI,cAAc,SAAS,SAAS;QAClC,OAAO;IACT;IAEA,oCAAoC;IACpC,MAAM,cAAc;QAClB;QACA;QACA;KACD;IAED,OAAO,YAAY,QAAQ,CAAC,MAAM,WAAW;AAC/C;AAKO,eAAe;IASpB,IAAI;QACF,MAAM,WAAW,MAAM,IAAA,gJAAY;QACnC,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,OAAO,SAAS,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;QAExE,IAAI,aAAa,CAAC,MAAM;YACtB,OAAO;gBAAE,SAAS;gBAAO,OAAO;YAAoB;QACtD;QAEA,yBAAyB;QACzB,IAAI,CAAC,YAAY,KAAK,KAAK,EAAE,KAAK,aAAa,GAAG;YAChD,OAAO;gBAAE,SAAS;gBAAO,OAAO;YAAoB;QACtD;QAEA,OAAO;YACL,SAAS;YACT,OAAO;gBACL,IAAI,KAAK,EAAE;gBACX,OAAO,KAAK,KAAK;gBACjB,MAAM,KAAK,aAAa,EAAE,QAAQ,KAAK,KAAK,EAAE,MAAM,IAAI,CAAC,EAAE;YAC7D;QACF;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO;YACL,SAAS;YACT,OAAO,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QAClD;IACF;AACF;AAMO,eAAe,kBACpB,KAAa,EACb,QAAgB;IAUhB,IAAI;QACF,uCAAuC;QACvC,IAAI,CAAC,YAAY,QAAQ;YACvB,OAAO;gBAAE,SAAS;gBAAO,OAAO;YAAqB;QACvD;QAEA,8DAA8D;QAC9D,MAAM,WAAW,MAAM,IAAA,gJAAY;QACnC,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,kBAAkB,CAAC;YAC7D;YACA;QACF;QAEA,IAAI,SAAS,CAAC,KAAK,IAAI,EAAE;YACvB,OAAO;gBAAE,SAAS;gBAAO,OAAO;YAAsB;QACxD;QAEA,OAAO;YACL,SAAS;YACT,OAAO;gBACL,IAAI,KAAK,IAAI,CAAC,EAAE;gBAChB,OAAO,KAAK,IAAI,CAAC,KAAK;gBACtB,MAAM,KAAK,IAAI,CAAC,aAAa,EAAE,QAAQ,KAAK,IAAI,CAAC,KAAK,EAAE,MAAM,IAAI,CAAC,EAAE;YACvE;QACF;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,+BAA+B;QAC7C,OAAO;YACL,SAAS;YACT,OAAO,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QAClD;IACF;AACF;AAKO,eAAe;IAcpB,IAAI;QACF,sBAAsB;QACtB,MAAM,cAAc,MAAM;QAC1B,IAAI,CAAC,YAAY,OAAO,EAAE;YACxB,OAAO;gBAAE,SAAS;gBAAO,OAAO;YAA6B;QAC/D;QAEA,MAAM,WAAW,IAAA,8JAAiB;QAElC,mBAAmB;QACnB,MAAM,EAAE,MAAM,QAAQ,EAAE,OAAO,aAAa,EAAE,GAAG,MAAM,SACpD,IAAI,CAAC,YACL,MAAM,CAAC;QAEV,IAAI,eAAe;YACjB,QAAQ,KAAK,CAAC,4BAA4B;YAC1C,OAAO;gBAAE,SAAS;gBAAO,OAAO,cAAc,OAAO;YAAC;QACxD;QAEA,+BAA+B;QAC/B,MAAM,EAAE,MAAM,SAAS,EAAE,OAAO,cAAc,EAAE,GAAG,MAAM,SACtD,IAAI,CAAC,YACL,MAAM,CAAC;QAEV,IAAI,gBAAgB;YAClB,QAAQ,KAAK,CAAC,6BAA6B;YAC3C,OAAO;gBAAE,SAAS;gBAAO,OAAO,eAAe,OAAO;YAAC;QACzD;QAEA,mBAAmB;QACnB,MAAM,EAAE,MAAM,QAAQ,EAAE,OAAO,aAAa,EAAE,GAAG,MAAM,SACpD,IAAI,CAAC,YACL,MAAM,CAAC;QAEV,IAAI,eAAe;YACjB,QAAQ,KAAK,CAAC,4BAA4B;YAC1C,OAAO;gBAAE,SAAS;gBAAO,OAAO,cAAc,OAAO;YAAC;QACxD;QAEA,MAAM,QAAQ,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;QACpD,MAAM,MAAM,IAAI;QAChB,MAAM,kBAAkB,IAAI,KAAK,IAAI,WAAW,IAAI,IAAI,QAAQ,IAAI,GAAG,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;QAElG,MAAM,cAAc,YAAY,EAAE;QAClC,MAAM,iBAAiB,YAAY,MAAM,CACvC,CAAC,IAAM;gBAAC;gBAAW;gBAAa;gBAAa;aAAU,CAAC,QAAQ,CAAC,EAAE,MAAM,GACzE,MAAM;QAER,MAAM,eAAe,YAAY,MAAM,CAAC,CAAC,IAAM,EAAE,cAAc,KAAK;QACpE,MAAM,eAAe,aAAa,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,CAAC,EAAE,YAAY,IAAI,CAAC,GAAG;QAElF,MAAM,sBAAsB,YAAY,MAAM,CAC5C,CAAC,IAAM,EAAE,cAAc,KAAK,UAAU,EAAE,YAAY,IAAI;QAE1D,MAAM,iBAAiB,oBAAoB,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,CAAC,EAAE,YAAY,IAAI,CAAC,GAAG;QAE3F,MAAM,oBAAoB,YAAY,MAAM,CAAC,CAAC,IAAM,EAAE,MAAM,KAAK,aAAa,MAAM;QACpF,MAAM,iBAAiB,YAAY,MAAM,GAAG,IAAI,AAAC,oBAAoB,YAAY,MAAM,GAAI,MAAM;QAEjG,MAAM,cAAc,YAAY,EAAE;QAClC,MAAM,iBAAiB,YAAY,MAAM,CAAC,CAAC,IAAM,EAAE,SAAS,EAAE,MAAM;QAEpE,OAAO;YACL,SAAS;YACT,OAAO;gBACL,eAAe,YAAY,MAAM;gBACjC;gBACA;gBACA;gBACA,gBAAgB,WAAW,UAAU;gBACrC,eAAe,YAAY,MAAM;gBACjC;gBACA,gBAAgB,KAAK,KAAK,CAAC,iBAAiB,OAAO;YACrD;QACF;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,2BAA2B;QACzC,OAAO;YACL,SAAS;YACT,OAAO,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QAClD;IACF;AACF;AAKO,eAAe,eACpB,MAMC;IAMD,IAAI;QACF,sBAAsB;QACtB,MAAM,cAAc,MAAM;QAC1B,IAAI,CAAC,YAAY,OAAO,EAAE;YACxB,OAAO;gBAAE,SAAS;gBAAO,OAAO;YAA6B;QAC/D;QAEA,MAAM,WAAW,IAAA,8JAAiB;QAElC,IAAI,QAAQ,SACT,IAAI,CAAC,YACL,MAAM,CAAC,KACP,KAAK,CAAC,gBAAgB;YAAE,WAAW;QAAM,GACzC,KAAK,CAAC,cAAc;YAAE,WAAW;QAAM;QAE1C,IAAI,QAAQ;YACV,IAAI,OAAO,MAAM,IAAI,OAAO,MAAM,KAAK,OAAO;gBAC5C,QAAQ,MAAM,EAAE,CAAC,UAAU,OAAO,MAAM;YAC1C;YACA,IAAI,OAAO,QAAQ,EAAE;gBACnB,QAAQ,MAAM,GAAG,CAAC,gBAAgB,OAAO,QAAQ;YACnD;YACA,IAAI,OAAO,MAAM,EAAE;gBACjB,QAAQ,MAAM,GAAG,CAAC,gBAAgB,OAAO,MAAM;YACjD;YACA,IAAI,OAAO,aAAa,EAAE;gBACxB,QAAQ,MAAM,EAAE,CAAC,kBAAkB,OAAO,aAAa;YACzD;YACA,IAAI,OAAO,SAAS,EAAE;gBACpB,QAAQ,MAAM,EAAE,CAAC,wBAAwB,OAAO,SAAS;YAC3D;QACF;QAEA,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM;QAE9B,IAAI,OAAO;YACT,QAAQ,KAAK,CAAC,4BAA4B;YAC1C,OAAO;gBAAE,SAAS;gBAAO,OAAO,MAAM,OAAO;YAAC;QAChD;QAEA,OAAO;YAAE,SAAS;YAAM,UAAU,QAAQ,EAAE;QAAC;IAC/C,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,OAAO;YACL,SAAS;YACT,OAAO,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QAClD;IACF;AACF;AAKO,eAAe;IAKpB,IAAI;QACF,sBAAsB;QACtB,MAAM,cAAc,MAAM;QAC1B,IAAI,CAAC,YAAY,OAAO,EAAE;YACxB,OAAO;gBAAE,SAAS;gBAAO,OAAO;YAA6B;QAC/D;QAEA,MAAM,WAAW,IAAA,8JAAiB;QAElC,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAC3B,IAAI,CAAC,YACL,MAAM,CAAC,KACP,KAAK,CAAC,cAAc;YAAE,WAAW;QAAM;QAE1C,IAAI,OAAO;YACT,QAAQ,KAAK,CAAC,6BAA6B;YAC3C,OAAO;gBAAE,SAAS;gBAAO,OAAO,MAAM,OAAO;YAAC;QAChD;QAEA,OAAO;YAAE,SAAS;YAAM,WAAW,QAAQ,EAAE;QAAC;IAChD,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO;YACL,SAAS;YACT,OAAO,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QAClD;IACF;AACF;AAKO,eAAe;IAKpB,IAAI;QACF,sBAAsB;QACtB,MAAM,cAAc,MAAM;QAC1B,IAAI,CAAC,YAAY,OAAO,EAAE;YACxB,OAAO;gBAAE,SAAS;gBAAO,OAAO;YAA6B;QAC/D;QAEA,MAAM,WAAW,IAAA,8JAAiB;QAElC,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAC3B,IAAI,CAAC,YACL,MAAM,CAAC,KACP,KAAK,CAAC,cAAc;YAAE,WAAW;QAAM;QAE1C,IAAI,OAAO;YACT,QAAQ,KAAK,CAAC,4BAA4B;YAC1C,OAAO;gBAAE,SAAS;gBAAO,OAAO,MAAM,OAAO;YAAC;QAChD;QAEA,OAAO;YAAE,SAAS;YAAM,UAAU,QAAQ,EAAE;QAAC;IAC/C,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,OAAO;YACL,SAAS;YACT,OAAO,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QAClD;IACF;AACF;;;IAxUsB;IA2CA;IAiDA;IAqGA;IAkEA;IAqCA;;AAxSA,+OAAA;AA2CA,+OAAA;AAiDA,+OAAA;AAqGA,+OAAA;AAkEA,+OAAA;AAqCA,+OAAA"}},
    {"offset": {"line": 443, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/27825/shalean-v2/shalean-reimagined/app/admin/%28dashboard%29/layout.tsx"],"sourcesContent":["import { redirect } from 'next/navigation';\r\nimport { createClient } from '@/lib/supabase/server';\r\nimport { AdminLayoutClient } from './layout-client';\r\nimport { getCurrentAdmin } from '../actions';\r\n\r\nexport const dynamic = 'force-dynamic';\r\n\r\nexport default async function AdminDashboardLayout({\r\n  children,\r\n}: {\r\n  children: React.ReactNode;\r\n}) {\r\n  try {\r\n    // Server-side authentication check\r\n    const supabase = await createClient();\r\n\r\n    const {\r\n      data: { user },\r\n      error,\r\n    } = await supabase.auth.getUser();\r\n\r\n    if (error) {\r\n      console.error('Error getting user in admin layout:', error.message);\r\n      redirect('/admin/login?redirect=/admin');\r\n    }\r\n\r\n    if (!user) {\r\n      redirect('/admin/login?redirect=/admin');\r\n    }\r\n\r\n    // Verify user is an admin\r\n    const adminResult = await getCurrentAdmin();\r\n    if (!adminResult.success || !adminResult.admin) {\r\n      // User is authenticated but not an admin - redirect to login\r\n      redirect('/admin/login?redirect=/admin');\r\n    }\r\n\r\n    return <AdminLayoutClient>{children}</AdminLayoutClient>;\r\n  } catch (error) {\r\n    // Handle errors from createClient or other operations\r\n    console.error('Error in admin layout:', error);\r\n    redirect('/admin/login?redirect=/admin');\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;;AAAA;AAAA;AACA;AACA;AACA;;;;;;AAEO,MAAM,UAAU;AAER,eAAe,qBAAqB,EACjD,QAAQ,EAGT;IACC,IAAI;QACF,mCAAmC;QACnC,MAAM,WAAW,MAAM,IAAA,gJAAY;QAEnC,MAAM,EACJ,MAAM,EAAE,IAAI,EAAE,EACd,KAAK,EACN,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;QAE/B,IAAI,OAAO;YACT,QAAQ,KAAK,CAAC,uCAAuC,MAAM,OAAO;YAClE,IAAA,iMAAQ,EAAC;QACX;QAEA,IAAI,CAAC,MAAM;YACT,IAAA,iMAAQ,EAAC;QACX;QAEA,0BAA0B;QAC1B,MAAM,cAAc,MAAM,IAAA,0IAAe;QACzC,IAAI,CAAC,YAAY,OAAO,IAAI,CAAC,YAAY,KAAK,EAAE;YAC9C,6DAA6D;YAC7D,IAAA,iMAAQ,EAAC;QACX;QAEA,qBAAO,8OAAC,uKAAiB;sBAAE;;;;;;IAC7B,EAAE,OAAO,OAAO;QACd,sDAAsD;QACtD,QAAQ,KAAK,CAAC,0BAA0B;QACxC,IAAA,iMAAQ,EAAC;IACX;AACF"}}]
}