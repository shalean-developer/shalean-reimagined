(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15288,e=>{"use strict";var r=e.i(43476),t=e.i(71645),a=e.i(75157);let s=t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));s.displayName="Card";let n=t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",e),...t}));n.displayName="CardHeader";let o=t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("h3",{ref:s,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));o.displayName="CardTitle";let i=t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("p",{ref:s,className:(0,a.cn)("text-sm text-muted-foreground",e),...t}));i.displayName="CardDescription";let l=t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,a.cn)("p-6 pt-0",e),...t}));l.displayName="CardContent",t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,a.cn)("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter",e.s(["Card",()=>s,"CardContent",()=>l,"CardDescription",()=>i,"CardHeader",()=>n,"CardTitle",()=>o])},19455,e=>{"use strict";var r=e.i(43476),t=e.i(71645),a=e.i(91918),s=e.i(25913),n=e.i(75157);let o=(0,s.cva)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-lg text-sm font-semibold ring-offset-background transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-button hover:shadow-lg hover:-translate-y-0.5",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",hero:"bg-primary text-primary-foreground shadow-button hover:shadow-lg hover:-translate-y-0.5 hover:bg-primary/90",heroOutline:"border-2 border-primary bg-transparent text-primary hover:bg-primary hover:text-primary-foreground",cta:"bg-primary text-primary-foreground shadow-button hover:shadow-lg hover:-translate-y-1 hover:bg-primary/90"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-12 rounded-lg px-6",xl:"h-14 rounded-xl px-8 text-base",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),i=t.forwardRef(({className:e,variant:t,size:s,asChild:i=!1,...l},d)=>{let c=i?a.Slot:"button";return(0,r.jsx)(c,{className:(0,n.cn)(o({variant:t,size:s,className:e})),ref:d,...l})});i.displayName="Button",e.s(["Button",()=>i,"buttonVariants",()=>o])},31278,e=>{"use strict";let r=(0,e.i(75254).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>r],31278)},90571,e=>{"use strict";var r=function(){return(r=Object.assign||function(e){for(var r,t=1,a=arguments.length;t<a;t++)for(var s in r=arguments[t])Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s]);return e}).apply(this,arguments)};function t(e,r){var t={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&0>r.indexOf(a)&&(t[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,a=Object.getOwnPropertySymbols(e);s<a.length;s++)0>r.indexOf(a[s])&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(t[a[s]]=e[a[s]]);return t}function a(e,r,t,a){return new(t||(t=Promise))(function(s,n){function o(e){try{l(a.next(e))}catch(e){n(e)}}function i(e){try{l(a.throw(e))}catch(e){n(e)}}function l(e){var r;e.done?s(e.value):((r=e.value)instanceof t?r:new t(function(e){e(r)})).then(o,i)}l((a=a.apply(e,r||[])).next())})}function s(e,r,t){if(t||2==arguments.length)for(var a,s=0,n=r.length;s<n;s++)!a&&s in r||(a||(a=Array.prototype.slice.call(r,0,s)),a[s]=r[s]);return e.concat(a||Array.prototype.slice.call(r))}"function"==typeof SuppressedError&&SuppressedError,e.s(["__assign",()=>r,"__awaiter",()=>a,"__rest",()=>t,"__spreadArray",()=>s])},93479,e=>{"use strict";var r=e.i(43476),t=e.i(71645),a=e.i(75157);let s=t.forwardRef(({className:e,type:t,...s},n)=>(0,r.jsx)("input",{type:t,className:(0,a.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n,...s}));s.displayName="Input",e.s(["Input",()=>s])},10204,e=>{"use strict";var r=e.i(43476),t=e.i(71645),a=e.i(48425),s=t.forwardRef((e,t)=>(0,r.jsx)(a.Primitive.label,{...e,ref:t,onMouseDown:r=>{r.target.closest("button, input, select, textarea")||(e.onMouseDown?.(r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));s.displayName="Label";var n=e.i(25913),o=e.i(75157);let i=(0,n.cva)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),l=t.forwardRef(({className:e,...t},a)=>(0,r.jsx)(s,{ref:a,className:(0,o.cn)(i(),e),...t}));l.displayName=s.displayName,e.s(["Label",()=>l],10204)},51564,e=>{"use strict";var r=e.i(43476),t=e.i(71645),a=e.i(18566),s=e.i(11795);async function n(e,r){try{let t=e.trim(),a=r.trim();if(!t||!a)return{success:!1,error:"Phone number and password are required"};let n=t.replace(/\s+/g,"");n.startsWith("+")||(n=n.startsWith("0")?`+27${n.substring(1)}`:`+27${n}`);let o=n.replace(/\+/g,""),i=`${o}@cleaners.shalean.local`,l=(0,s.createClient)();console.log("[Cleaner Auth] Attempting login:",{inputPhone:t,normalizedPhone:n,phoneForEmail:o,authEmail:i,passwordLength:a.length,passwordFirst3:a.substring(0,3)});let{data:d,error:c}=await l.auth.signInWithPassword({email:i,password:a});if(c){if(console.error("[Cleaner Auth] Authentication failed:",{errorCode:c.status,errorMessage:c.message,attemptedEmail:i,normalizedPhone:n,phoneForEmail:o}),c.message?.includes("Invalid login credentials")||400===c.status)return{success:!1,error:"Invalid phone number or password. Please check your credentials and try again."};return{success:!1,error:c.message||"Invalid phone number or password"}}if(!d.user)return{success:!1,error:"Authentication failed"};let{data:u,error:p}=await l.from("cleaners").select("*").eq("phone",n).eq("is_active",!0).maybeSingle();if(p||!u)return await l.auth.signOut(),{success:!1,error:"Cleaner profile not found"};if(!u.auth_user_id){let{error:e}=await l.from("cleaners").update({auth_user_id:d.user.id}).eq("id",u.id);e&&console.warn("Could not update auth_user_id:",e)}return{success:!0,cleaner:u}}catch(e){return console.error("Error in authenticateCleanerClient:",e),{success:!1,error:e instanceof Error?e.message:"Authentication failed"}}}var o=e.i(19455),i=e.i(93479),l=e.i(10204),d=e.i(15288),c=e.i(31278),u=e.i(75254);let p=(0,u.default)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),f=(0,u.default)("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var m=e.i(46696);function h(){let e=(0,a.useRouter)(),s=(0,a.useSearchParams)(),[u,h]=(0,t.useState)(""),[g,x]=(0,t.useState)(""),[y,b]=(0,t.useState)(!1),[v,w]=(0,t.useState)(!1),j=s.get("redirect")||"/cleaner",N=async r=>{r.preventDefault(),b(!0);try{let r=u.trim(),t=g.trim();if(!r||!t){m.toast.error("Please enter both phone number and password"),b(!1);return}let a=await n(r,t);if(!a.success){m.toast.error(a.error||"Failed to sign in"),b(!1);return}a.cleaner&&(m.toast.success("Signed in successfully"),e.push(j),e.refresh())}catch(e){console.error("Login error:",e),m.toast.error("An unexpected error occurred. Please try again."),b(!1)}};return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center p-4 bg-muted/30",children:(0,r.jsxs)(d.Card,{className:"w-full max-w-md",children:[(0,r.jsxs)(d.CardHeader,{className:"space-y-1",children:[(0,r.jsx)(d.CardTitle,{className:"text-2xl font-bold text-center",children:"Cleaner Login"}),(0,r.jsx)(d.CardDescription,{className:"text-center",children:"Sign in with your phone number and password"})]}),(0,r.jsxs)(d.CardContent,{children:[(0,r.jsxs)("form",{onSubmit:N,className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(l.Label,{htmlFor:"phone",children:"Phone Number"}),(0,r.jsx)(i.Input,{id:"phone",type:"tel",placeholder:"0824644655 or +27824644655",value:u,onChange:e=>h(e.target.value),required:!0,disabled:y,autoComplete:"tel"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Enter your phone number (e.g., 0824644655 or +27824644655)"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(l.Label,{htmlFor:"password",children:"Password"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(i.Input,{id:"password",type:v?"text":"password",placeholder:"••••••••",value:g,onChange:e=>x(e.target.value),required:!0,disabled:y,autoComplete:"current-password",className:"pr-10"}),(0,r.jsx)(o.Button,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>w(!v),disabled:y,children:v?(0,r.jsx)(f,{className:"h-4 w-4 text-muted-foreground"}):(0,r.jsx)(p,{className:"h-4 w-4 text-muted-foreground"})})]})]}),(0,r.jsx)(o.Button,{type:"submit",className:"w-full",disabled:y,children:y?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Signing in..."]}):"Sign in"})]}),(0,r.jsxs)("div",{className:"mt-4 text-center text-sm",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"Need help? "}),(0,r.jsx)("span",{className:"text-muted-foreground",children:"Contact your administrator"})]})]})]})})}function g(){return(0,r.jsx)(t.Suspense,{fallback:(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center p-4 bg-muted/30",children:(0,r.jsxs)(d.Card,{className:"w-full max-w-md",children:[(0,r.jsxs)(d.CardHeader,{className:"space-y-1",children:[(0,r.jsx)(d.CardTitle,{className:"text-2xl font-bold text-center",children:"Cleaner Login"}),(0,r.jsx)(d.CardDescription,{className:"text-center",children:"Sign in with your phone number and password"})]}),(0,r.jsx)(d.CardContent,{children:(0,r.jsx)("div",{className:"flex justify-center py-8",children:(0,r.jsx)(c.Loader2,{className:"h-6 w-6 animate-spin text-muted-foreground"})})})]})}),children:(0,r.jsx)(h,{})})}e.s(["default",()=>g],51564)}]);