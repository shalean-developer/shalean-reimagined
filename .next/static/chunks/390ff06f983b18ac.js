(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,19455,e=>{"use strict";var r=e.i(43476),t=e.i(71645),a=e.i(91918),s=e.i(25913),d=e.i(75157);let i=(0,s.cva)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-lg text-sm font-semibold ring-offset-background transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-button hover:shadow-lg hover:-translate-y-0.5",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",hero:"bg-primary text-primary-foreground shadow-button hover:shadow-lg hover:-translate-y-0.5 hover:bg-primary/90",heroOutline:"border-2 border-primary bg-transparent text-primary hover:bg-primary hover:text-primary-foreground",cta:"bg-primary text-primary-foreground shadow-button hover:shadow-lg hover:-translate-y-1 hover:bg-primary/90"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-12 rounded-lg px-6",xl:"h-14 rounded-xl px-8 text-base",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),n=t.forwardRef(({className:e,variant:t,size:s,asChild:n=!1,...l},o)=>{let c=n?a.Slot:"button";return(0,r.jsx)(c,{className:(0,d.cn)(i({variant:t,size:s,className:e})),ref:o,...l})});n.displayName="Button",e.s(["Button",()=>n,"buttonVariants",()=>i])},15288,e=>{"use strict";var r=e.i(43476),t=e.i(71645),a=e.i(75157);let s=t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));s.displayName="Card";let d=t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",e),...t}));d.displayName="CardHeader";let i=t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("h3",{ref:s,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));i.displayName="CardTitle";let n=t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("p",{ref:s,className:(0,a.cn)("text-sm text-muted-foreground",e),...t}));n.displayName="CardDescription";let l=t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,a.cn)("p-6 pt-0",e),...t}));l.displayName="CardContent",t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,a.cn)("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter",e.s(["Card",()=>s,"CardContent",()=>l,"CardDescription",()=>n,"CardHeader",()=>d,"CardTitle",()=>i])},93023,e=>{"use strict";var r=e.i(43476),t=e.i(71645),a=e.i(19455),s=e.i(15288);function d(){let[e,d]=(0,t.useState)(!1),[i,n]=(0,t.useState)(!1),[l,o]=(0,t.useState)(null),[c,u]=(0,t.useState)(null),m=async()=>{n(!0),o(null),u(null);try{let e=await fetch("/api/admin/fix-duplicate-codes"),r=await e.json();e.ok||u(r.error||"Failed to check duplicates"),o({type:"check",data:r})}catch(e){u(e instanceof Error?e.message:"Unknown error occurred")}finally{n(!1)}},x=async()=>{d(!0),o(null),u(null);try{let e=await fetch("/api/admin/fix-duplicate-codes",{method:"POST"}),r=await e.json();e.ok||u(r.error||"Failed to fix duplicates"),o({type:"fix",data:r})}catch(e){u(e instanceof Error?e.message:"Unknown error occurred")}finally{d(!1)}};return(0,r.jsx)("div",{className:"container mx-auto py-10 max-w-4xl",children:(0,r.jsxs)(s.Card,{children:[(0,r.jsxs)(s.CardHeader,{children:[(0,r.jsx)(s.CardTitle,{children:"Fix Duplicate Referral Codes"}),(0,r.jsx)(s.CardDescription,{children:"Find and fix duplicate referral codes. Each referral code should be unique to one user."})]}),(0,r.jsxs)(s.CardContent,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)(a.Button,{onClick:m,disabled:i,variant:"outline",children:i?"Checking...":"Check for Duplicates"}),(0,r.jsx)(a.Button,{onClick:x,disabled:e||i,children:e?"Fixing...":"Fix Duplicates"})]}),c&&(0,r.jsxs)("div",{className:"p-4 bg-destructive/10 border border-destructive/20 rounded-md",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-destructive",children:"Error:"}),(0,r.jsx)("p",{className:"text-sm text-destructive/80",children:c})]}),l&&(0,r.jsxs)("div",{className:"space-y-4",children:["check"===l.type&&l.data.success&&(0,r.jsx)(r.Fragment,{children:l.data.duplicateCount>0?(0,r.jsxs)("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-md",children:[(0,r.jsxs)("p",{className:"text-sm font-medium text-yellow-800 mb-2",children:["Found ",l.data.duplicateCount," duplicate referral code(s)"]}),l.data.duplicates.map((e,t)=>(0,r.jsxs)("div",{className:"mt-3 p-3 bg-white rounded border border-yellow-300",children:[(0,r.jsxs)("p",{className:"text-sm font-semibold",children:["Code: ",e.code]}),(0,r.jsxs)("p",{className:"text-xs text-gray-600",children:["Used by ",e.count," profile(s):"]}),(0,r.jsx)("ul",{className:"mt-1 space-y-1",children:e.profiles.map((e,t)=>(0,r.jsxs)("li",{className:"text-xs",children:["• ",e.email," (created: ",new Date(e.created_at).toLocaleString(),")"]},t))})]},t))]}):(0,r.jsx)("div",{className:"p-4 bg-green-50 border border-green-200 rounded-md",children:(0,r.jsx)("p",{className:"text-sm font-medium text-green-800",children:"✅ No duplicate referral codes found!"})})}),"fix"===l.type&&l.data.success&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"p-4 bg-green-50 border border-green-200 rounded-md",children:(0,r.jsx)("p",{className:"text-sm font-medium text-green-800 mb-2",children:l.data.message})}),l.data.fixed&&l.data.fixed.length>0&&(0,r.jsxs)("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-md",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-blue-800 mb-2",children:"Fixed Profiles:"}),l.data.fixed.map((e,t)=>(0,r.jsx)("div",{className:"mt-2 text-sm",children:e.success?(0,r.jsx)("div",{className:"text-green-700",children:(0,r.jsxs)("p",{children:["✅ ",e.email,": ",e.oldCode," → ",e.newCode]})}):(0,r.jsx)("div",{className:"text-red-700",children:(0,r.jsxs)("p",{children:["❌ ",e.email,": Failed to fix - ",e.error]})})},t))]}),l.data.duplicates&&l.data.duplicates.length>0&&(0,r.jsxs)("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-md",children:[(0,r.jsx)("p",{className:"text-sm font-medium mb-2",children:"Duplicate Details:"}),l.data.duplicates.map((e,t)=>(0,r.jsxs)("div",{className:"mt-2 text-sm",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Code:"})," ",e.code]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Count:"})," ",e.count]})]},t))]})]}),(0,r.jsxs)("div",{className:"p-4 bg-muted rounded-md",children:[(0,r.jsx)("p",{className:"text-sm font-medium mb-2",children:"Full Result:"}),(0,r.jsx)("pre",{className:"text-xs overflow-auto bg-background p-3 rounded border",children:JSON.stringify(l.data,null,2)})]})]})]})]})})}e.s(["default",()=>d])}]);