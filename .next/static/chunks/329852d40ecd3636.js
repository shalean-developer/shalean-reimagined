(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15288,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(75157);let r=s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("div",{ref:r,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...s}));r.displayName="Card";let l=s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("div",{ref:r,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",e),...s}));l.displayName="CardHeader";let n=s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("h3",{ref:r,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",e),...s}));n.displayName="CardTitle";let i=s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("p",{ref:r,className:(0,a.cn)("text-sm text-muted-foreground",e),...s}));i.displayName="CardDescription";let c=s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("div",{ref:r,className:(0,a.cn)("p-6 pt-0",e),...s}));c.displayName="CardContent",s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("div",{ref:r,className:(0,a.cn)("flex items-center p-6 pt-0",e),...s})).displayName="CardFooter",e.s(["Card",()=>r,"CardContent",()=>c,"CardDescription",()=>i,"CardHeader",()=>l,"CardTitle",()=>n])},7233,e=>{"use strict";let t=(0,e.i(75254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},73375,e=>{"use strict";let t=(0,e.i(75254).default)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);e.s(["ChevronLeft",()=>t],73375)},28757,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(15288),r=e.i(19455),l=e.i(67489),n=e.i(73375),i=e.i(63059),c=e.i(7233);let d=(0,e.i(75254).default)("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]);var o=e.i(46696),x=e.i(11795);function m(){let[e,m]=(0,s.useState)(!1),[h,u]=(0,s.useState)(25),[p,f]=(0,s.useState)(1),[j,y]=(0,s.useState)(0),[g,N]=(0,s.useState)(""),[b,v]=(0,s.useState)([]),[C,w]=(0,s.useState)(!0),[S,k]=(0,s.useState)(0);(0,s.useEffect)(()=>{m(!0),(0,x.createClient)().auth.getUser().then(({data:{user:e}})=>{e?.email&&N(e.email)})},[]);let T=(0,s.useCallback)(async e=>{if(e)try{let e=await fetch("/api/profile/balance");if(e.ok){let t=await e.json();t.success&&y(t.balance||0)}else 401===e.status&&console.error("Unauthorized - user not authenticated")}catch(e){console.error("Error loading balance:",e)}},[]),R=(0,s.useCallback)(async(e,t,s)=>{if(!e)return void w(!1);try{w(!0);let e=await fetch(`/api/credit/transactions?page=${t}&limit=${s}`);if(e.ok){let t=await e.json();t.success&&(v(t.transactions||[]),k(t.total||0))}else 401===e.status&&console.error("Unauthorized - user not authenticated")}catch(e){console.error("Error loading transactions:",e)}finally{w(!1)}},[]),I=(0,s.useCallback)(async e=>{if(e)try{let t=await fetch("/api/credit/retry",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(t.ok){let s=await t.json();if(s.success&&s.results&&s.results.length>0){let t=s.results.filter(e=>e.success).length;t>0&&(o.toast.success(`Credited ${t} pending purchase(s) to your account!`),T(e),R(e,p,h))}}else 401===t.status&&console.error("Unauthorized - user not authenticated")}catch(e){console.error("Error checking pending credits:",e)}},[T,R,p,h]);(0,s.useEffect)(()=>{g&&(T(g),R(g,p,h),I(g))},[g,p,h,T,R,I]),(0,s.useEffect)(()=>{if(!g)return;let e=0,t=setInterval(()=>{++e<=4?(I(g),T(g),R(g,p,h)):clearInterval(t)},3e4);return()=>clearInterval(t)},[g,p,h,T,R,I]);let B=Math.ceil(S/h)||1,P=0===S?0:(p-1)*h+1,U=Math.min(p*h,S);return(0,t.jsxs)("div",{className:"space-y-4 sm:space-y-6 w-full max-w-full overflow-x-hidden",children:[(0,t.jsx)("div",{children:(0,t.jsx)("h1",{className:"text-2xl sm:text-3xl md:text-4xl font-bold",children:"ShaleanCred"})}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center",children:[(0,t.jsxs)(r.Button,{variant:"default",size:"lg",className:"bg-primary-light hover:bg-primary-light/90 text-primary font-semibold h-auto py-4 px-6 text-lg",onClick:()=>{window.location.href="/dashboard/shaleancred/buy"},children:[(0,t.jsx)(c.Plus,{className:"h-5 w-5 mr-2"}),"Buy ShaleanCred"]}),(0,t.jsxs)(a.Card,{className:"flex-1 sm:max-w-sm",children:[(0,t.jsx)(a.CardHeader,{className:"pb-2",children:(0,t.jsx)(a.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"ShaleanCred Balance"})}),(0,t.jsxs)(a.CardContent,{className:"flex items-center gap-3",children:[(0,t.jsx)(d,{className:"h-6 w-6 text-muted-foreground"}),(0,t.jsxs)("span",{className:"text-2xl font-bold",children:["R",j.toFixed(2)]})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("div",{className:"flex items-center gap-2",children:e?(0,t.jsxs)(l.Select,{value:h.toString(),onValueChange:e=>{let t=Number(e);u(t),f(1),g&&R(g,1,t)},children:[(0,t.jsx)(l.SelectTrigger,{className:"w-[120px] h-9",children:(0,t.jsx)(l.SelectValue,{})}),(0,t.jsxs)(l.SelectContent,{children:[(0,t.jsx)(l.SelectItem,{value:"10",children:"10 Items"}),(0,t.jsx)(l.SelectItem,{value:"25",children:"25 Items"}),(0,t.jsx)(l.SelectItem,{value:"50",children:"50 Items"}),(0,t.jsx)(l.SelectItem,{value:"100",children:"100 Items"})]})]}):(0,t.jsx)("div",{className:"w-[120px] h-9 flex items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm",children:(0,t.jsxs)("span",{children:[h," Items"]})})}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(r.Button,{variant:"default",size:"sm",onClick:()=>{if(p>1){let e=p-1;f(e),g&&R(g,e,h)}},disabled:1===p,className:"h-9",children:(0,t.jsx)(n.ChevronLeft,{className:"h-4 w-4"})}),(0,t.jsx)("span",{className:"text-sm text-muted-foreground px-2",children:p}),(0,t.jsx)(r.Button,{variant:"default",size:"sm",onClick:()=>{if(p<B){let e=p+1;f(e),g&&R(g,e,h)}},disabled:p>=B,className:"h-9",children:(0,t.jsx)(i.ChevronRight,{className:"h-4 w-4"})})]})]}),(0,t.jsxs)(a.Card,{children:[(0,t.jsx)(a.CardHeader,{children:(0,t.jsx)(a.CardTitle,{children:"Transaction History"})}),(0,t.jsx)(a.CardContent,{children:C?(0,t.jsx)("div",{className:"py-12 text-center",children:(0,t.jsx)("p",{className:"text-muted-foreground",children:"Loading transactions..."})}):0===S?(0,t.jsx)("div",{className:"py-12 text-center",children:(0,t.jsx)("p",{className:"text-muted-foreground",children:"No transactions to display"})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b",children:[(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-sm",children:"Date"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-sm",children:"Description"}),(0,t.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-sm",children:"Type"}),(0,t.jsx)("th",{className:"text-right py-3 px-4 font-semibold text-sm",children:"Amount"}),(0,t.jsx)("th",{className:"text-right py-3 px-4 font-semibold text-sm",children:"Balance After"}),(0,t.jsx)("th",{className:"text-center py-3 px-4 font-semibold text-sm",children:"Status"})]})}),(0,t.jsx)("tbody",{children:b.map(e=>(0,t.jsxs)("tr",{className:"border-b hover:bg-accent/50",children:[(0,t.jsx)("td",{className:"py-3 px-4 text-sm text-muted-foreground",children:new Date(e.date).toLocaleDateString("en-ZA",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),(0,t.jsx)("td",{className:"py-3 px-4 text-sm",children:e.description}),(0,t.jsxs)("td",{className:"py-3 px-4 text-sm",children:[(0,t.jsx)("span",{className:`font-medium ${"credit"===e.type?"text-green-600":"text-red-600"}`,children:"credit"===e.type?"+":"-"}),"purchase"===e.transactionType&&" Purchase","usage"===e.transactionType&&" Usage","refund"===e.transactionType&&" Refund","referral_reward"===e.transactionType&&" Referral Reward"]}),(0,t.jsx)("td",{className:"py-3 px-4 text-sm text-right font-medium",children:(0,t.jsxs)("span",{className:"credit"===e.type?"text-green-600":"text-red-600",children:["credit"===e.type?"+":"-","R",e.amount.toFixed(2)]})}),(0,t.jsxs)("td",{className:"py-3 px-4 text-sm text-right text-muted-foreground",children:["R",e.balanceAfter.toFixed(2)]}),(0,t.jsx)("td",{className:"py-3 px-4 text-sm text-center",children:(e=>{switch(e){case"completed":return(0,t.jsx)("span",{className:"px-2 py-1 text-xs rounded-full bg-green-100 text-green-800",children:"Completed"});case"pending":return(0,t.jsx)("span",{className:"px-2 py-1 text-xs rounded-full bg-yellow-100 text-yellow-800",children:"Pending"});case"failed":return(0,t.jsx)("span",{className:"px-2 py-1 text-xs rounded-full bg-red-100 text-red-800",children:"Failed"});default:return(0,t.jsx)("span",{className:"px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-800",children:e})}})(e.paymentStatus)})]},e.id))})]})}),S>0&&(0,t.jsxs)("div",{className:"mt-4 text-sm text-muted-foreground text-center",children:["Showing ",P," to ",U," of ",S," transactions"]})]})})]})]})}e.s(["default",()=>m],28757)}]);