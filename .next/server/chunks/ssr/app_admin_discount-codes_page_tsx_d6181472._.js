module.exports=[11733,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(99570),e=a.i(66718),f=a.i(70430),g=a.i(80701),h=a.i(7554),i=a.i(70121),j=a.i(50104),k=a.i(25152),l=a.i(77994),m=a.i(3688),n=a.i(30553),o="Switch",[p,q]=(0,j.createContextScope)(o),[r,s]=p(o),t=c.forwardRef((a,d)=>{let{__scopeSwitch:e,name:f,checked:g,defaultChecked:j,required:l,disabled:m,value:p="on",onCheckedChange:q,form:s,...t}=a,[u,v]=c.useState(null),y=(0,i.useComposedRefs)(d,a=>v(a)),z=c.useRef(!1),A=!u||s||!!u.closest("form"),[B,C]=(0,k.useControllableState)({prop:g,defaultProp:j??!1,onChange:q,caller:o});return(0,b.jsxs)(r,{scope:e,checked:B,disabled:m,children:[(0,b.jsx)(n.Primitive.button,{type:"button",role:"switch","aria-checked":B,"aria-required":l,"data-state":x(B),"data-disabled":m?"":void 0,disabled:m,value:p,...t,ref:y,onClick:(0,h.composeEventHandlers)(a.onClick,a=>{C(a=>!a),A&&(z.current=a.isPropagationStopped(),z.current||a.stopPropagation())})}),A&&(0,b.jsx)(w,{control:u,bubbles:!z.current,name:f,value:p,checked:B,required:l,disabled:m,form:s,style:{transform:"translateX(-100%)"}})]})});t.displayName=o;var u="SwitchThumb",v=c.forwardRef((a,c)=>{let{__scopeSwitch:d,...e}=a,f=s(u,d);return(0,b.jsx)(n.Primitive.span,{"data-state":x(f.checked),"data-disabled":f.disabled?"":void 0,...e,ref:c})});v.displayName=u;var w=c.forwardRef(({__scopeSwitch:a,control:d,checked:e,bubbles:f=!0,...g},h)=>{let j=c.useRef(null),k=(0,i.useComposedRefs)(j,h),n=(0,l.usePrevious)(e),o=(0,m.useSize)(d);return c.useEffect(()=>{let a=j.current;if(!a)return;let b=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(n!==e&&b){let c=new Event("click",{bubbles:f});b.call(a,e),a.dispatchEvent(c)}},[n,e,f]),(0,b.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:e,...g,tabIndex:-1,ref:k,style:{...g.style,...o,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function x(a){return a?"checked":"unchecked"}w.displayName="SwitchBubbleInput";var y=a.i(68114);let z=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)(t,{className:(0,y.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",a),...c,ref:d,children:(0,b.jsx)(v,{className:(0,y.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));z.displayName=t.displayName;var A=a.i(33508);function B({code:a,onClose:h,onSuccess:i}){let[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)({}),[n,o]=(0,c.useState)({code:a?.code||"",discount_type:a?.discount_type||"percentage",discount_value:a?.discount_value?.toString()||"",max_discount_amount:a?.max_discount_amount?.toString()||"",min_purchase_amount:a?.min_purchase_amount?.toString()||"",max_uses:a?.max_uses?.toString()||"",valid_from:a?.valid_from||"",valid_until:a?.valid_until||"",is_active:a?.is_active??!0}),p=async b=>{b.preventDefault(),m({}),k(!0);try{let b={code:n.code.trim().toUpperCase(),discount_type:n.discount_type,discount_value:parseFloat(n.discount_value),valid_from:n.valid_from,valid_until:n.valid_until,is_active:n.is_active};n.max_discount_amount.trim()&&(b.max_discount_amount=parseFloat(n.max_discount_amount)),n.min_purchase_amount.trim()&&(b.min_purchase_amount=parseFloat(n.min_purchase_amount)),n.max_uses.trim()&&(b.max_uses=parseInt(n.max_uses,10));let c=a?`/api/discount-codes/${a.id}`:"/api/discount-codes",d=a?"PUT":"POST",e=await fetch(c,{method:d,headers:{"Content-Type":"application/json"},body:JSON.stringify(b)}),f=await e.json();if(!e.ok){f.error?m({submit:f.error}):f.details?m({submit:f.details}):m({submit:"Failed to save discount code"}),k(!1);return}i()}catch(a){console.error("Error saving discount code:",a),m({submit:a instanceof Error?a.message:"An unexpected error occurred"}),k(!1)}},q=(a,b)=>{o(c=>({...c,[a]:b})),l[a]&&m(b=>{let c={...b};return delete c[a],c})};return(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,b.jsxs)("div",{className:"bg-background rounded-lg shadow-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)("div",{className:"sticky top-0 bg-background border-b p-6 flex justify-between items-center",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold",children:a?"Edit Discount Code":"Create Discount Code"}),(0,b.jsx)(d.Button,{variant:"ghost",size:"icon",onClick:h,children:(0,b.jsx)(A.X,{className:"w-4 h-4"})})]}),(0,b.jsxs)("form",{onSubmit:p,className:"p-6 space-y-6",children:[l.submit&&(0,b.jsx)("div",{className:"bg-destructive/10 text-destructive p-3 rounded-md text-sm",children:l.submit}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(f.Label,{htmlFor:"code",children:["Code ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsx)(e.Input,{id:"code",value:n.code,onChange:a=>q("code",a.target.value.toUpperCase()),placeholder:"SAVE10",required:!0,disabled:!!a}),l.code&&(0,b.jsx)("p",{className:"text-sm text-destructive",children:l.code})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(f.Label,{htmlFor:"discount_type",children:["Discount Type ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsxs)(g.Select,{value:n.discount_type,onValueChange:a=>q("discount_type",a),children:[(0,b.jsx)(g.SelectTrigger,{id:"discount_type",children:(0,b.jsx)(g.SelectValue,{})}),(0,b.jsxs)(g.SelectContent,{children:[(0,b.jsx)(g.SelectItem,{value:"percentage",children:"Percentage (%)"}),(0,b.jsx)(g.SelectItem,{value:"fixed",children:"Fixed Amount (R)"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(f.Label,{htmlFor:"discount_value",children:["Discount Value ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsx)(e.Input,{id:"discount_value",type:"number",step:"0.01",min:"0",max:"percentage"===n.discount_type?"100":void 0,value:n.discount_value,onChange:a=>q("discount_value",a.target.value),placeholder:"percentage"===n.discount_type?"10":"50.00",required:!0}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"percentage"===n.discount_type?"Enter percentage (0-100)":"Enter amount in ZAR"})]}),"percentage"===n.discount_type&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(f.Label,{htmlFor:"max_discount_amount",children:"Max Discount Amount (R)"}),(0,b.jsx)(e.Input,{id:"max_discount_amount",type:"number",step:"0.01",min:"0",value:n.max_discount_amount,onChange:a=>q("max_discount_amount",a.target.value),placeholder:"100.00"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Optional: Maximum discount amount for percentage discounts"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(f.Label,{htmlFor:"min_purchase_amount",children:"Min Purchase Amount (R)"}),(0,b.jsx)(e.Input,{id:"min_purchase_amount",type:"number",step:"0.01",min:"0",value:n.min_purchase_amount,onChange:a=>q("min_purchase_amount",a.target.value),placeholder:"100.00"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Optional: Minimum purchase amount required to use this code"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(f.Label,{htmlFor:"max_uses",children:"Max Uses"}),(0,b.jsx)(e.Input,{id:"max_uses",type:"number",min:"1",step:"1",value:n.max_uses,onChange:a=>q("max_uses",a.target.value),placeholder:"100"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Optional: Maximum number of times this code can be used"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(f.Label,{htmlFor:"valid_from",children:["Valid From ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsx)(e.Input,{id:"valid_from",type:"date",value:n.valid_from,onChange:a=>q("valid_from",a.target.value),required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(f.Label,{htmlFor:"valid_until",children:["Valid Until ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsx)(e.Input,{id:"valid_until",type:"date",value:n.valid_until,onChange:a=>q("valid_until",a.target.value),required:!0})]})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(z,{id:"is_active",checked:n.is_active,onCheckedChange:a=>q("is_active",a)}),(0,b.jsx)(f.Label,{htmlFor:"is_active",children:"Active"})]}),a&&(0,b.jsxs)("div",{className:"bg-muted p-4 rounded-md",children:[(0,b.jsx)("p",{className:"text-sm font-medium mb-2",children:"Usage Statistics"}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Used: ",a.used_count," / ",a.max_uses||"∞"]})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[(0,b.jsx)(d.Button,{type:"button",variant:"outline",onClick:h,children:"Cancel"}),(0,b.jsx)(d.Button,{type:"submit",disabled:j,children:j?"Saving...":a?"Update":"Create"})]})]})]})})}var C=a.i(6015),D=a.i(86304),E=a.i(99464),F=a.i(81560),G=a.i(96221),H=a.i(72228);function I({codes:a,loading:c,onEdit:e,onDelete:f}){return c?(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsx)(G.Loader2,{className:"w-6 h-6 animate-spin text-muted-foreground"})}):0===a.length?(0,b.jsxs)("div",{className:"text-center py-12 bg-muted/50 rounded-lg",children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"No discount codes found."}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Create your first discount code to get started."})]}):(0,b.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,b.jsxs)(C.Table,{children:[(0,b.jsx)(C.TableHeader,{children:(0,b.jsxs)(C.TableRow,{children:[(0,b.jsx)(C.TableHead,{children:"Code"}),(0,b.jsx)(C.TableHead,{children:"Type"}),(0,b.jsx)(C.TableHead,{children:"Value"}),(0,b.jsx)(C.TableHead,{children:"Status"}),(0,b.jsx)(C.TableHead,{children:"Usage"}),(0,b.jsx)(C.TableHead,{children:"Valid From"}),(0,b.jsx)(C.TableHead,{children:"Valid Until"}),(0,b.jsx)(C.TableHead,{className:"text-right",children:"Actions"})]})}),(0,b.jsx)(C.TableBody,{children:a.map(a=>{let c,g=(c=new Date,new Date(a.valid_until)<c),h=null!==a.max_uses&&a.used_count>=a.max_uses,i=!a.is_active;return(0,b.jsxs)(C.TableRow,{children:[(0,b.jsx)(C.TableCell,{className:"font-mono font-medium",children:a.code}),(0,b.jsx)(C.TableCell,{children:(0,b.jsx)(D.Badge,{variant:"outline",children:"percentage"===a.discount_type?"Percentage":"Fixed"})}),(0,b.jsxs)(C.TableCell,{className:"font-medium",children:["percentage"===a.discount_type?`${a.discount_value}%`:`R${a.discount_value.toFixed(2)}`,a.max_discount_amount&&"percentage"===a.discount_type&&(0,b.jsxs)("span",{className:"text-xs text-muted-foreground ml-1",children:["(max R",a.max_discount_amount.toFixed(2),")"]})]}),(0,b.jsx)(C.TableCell,{children:(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[i?(0,b.jsx)(D.Badge,{variant:"secondary",children:"Inactive"}):g?(0,b.jsx)(D.Badge,{variant:"destructive",children:"Expired"}):h?(0,b.jsx)(D.Badge,{variant:"secondary",children:"Maxed Out"}):(0,b.jsx)(D.Badge,{variant:"default",children:"Active"}),a.min_purchase_amount&&(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Min: R",a.min_purchase_amount.toFixed(2)]})]})}),(0,b.jsxs)(C.TableCell,{children:[a.used_count," / ",a.max_uses||"∞"]}),(0,b.jsx)(C.TableCell,{className:"text-sm text-muted-foreground",children:(0,H.format)(new Date(a.valid_from),"MMM dd, yyyy")}),(0,b.jsx)(C.TableCell,{className:"text-sm text-muted-foreground",children:(0,H.format)(new Date(a.valid_until),"MMM dd, yyyy")}),(0,b.jsx)(C.TableCell,{className:"text-right",children:(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(d.Button,{variant:"ghost",size:"icon",onClick:()=>e(a),children:(0,b.jsx)(E.Pencil,{className:"w-4 h-4"})}),(0,b.jsx)(d.Button,{variant:"ghost",size:"icon",onClick:()=>f(a.id),children:(0,b.jsx)(F.Trash2,{className:"w-4 h-4"})})]})})]},a.id)})})]})})}var J=a.i(15618);function K(){let[a,e]=(0,c.useState)([]),[f,g]=(0,c.useState)(!0),[h,i]=(0,c.useState)(!1),[j,k]=(0,c.useState)(null),[l,m]=(0,c.useState)(0),n=async()=>{try{g(!0);let a=await fetch("/api/discount-codes?limit=100");if(!a.ok)throw Error("Failed to fetch discount codes");let b=await a.json();e(b.data||[])}catch(a){console.error("Error fetching discount codes:",a)}finally{g(!1)}};(0,c.useEffect)(()=>{n()},[l]);let o=()=>{i(!1),k(null),m(a=>a+1)},p=async a=>{if(confirm("Are you sure you want to delete this discount code?"))try{let b=await fetch(`/api/discount-codes/${a}`,{method:"DELETE"});if(!b.ok){let a=await b.json();throw Error(a.error||"Failed to delete discount code")}m(a=>a+1)}catch(a){console.error("Error deleting discount code:",a),alert(a instanceof Error?a.message:"Failed to delete discount code")}};return(0,b.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Discount Codes"}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1",children:"Manage promotional discount codes for your booking system"})]}),(0,b.jsxs)(d.Button,{onClick:()=>{k(null),i(!0)},className:"gap-2",children:[(0,b.jsx)(J.Plus,{className:"w-4 h-4"}),"Create Discount Code"]})]}),h&&(0,b.jsx)(B,{code:j,onClose:o,onSuccess:o}),(0,b.jsx)(I,{codes:a,loading:f,onEdit:a=>{k(a),i(!0)},onDelete:p})]})}a.s(["default",()=>K],11733)}];

//# sourceMappingURL=app_admin_discount-codes_page_tsx_d6181472._.js.map