module.exports=[91119,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(68114);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...c}));e.displayName="Card";let f=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex flex-col space-y-1.5 p-6",a),...c}));f.displayName="CardHeader";let g=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("h3",{ref:e,className:(0,d.cn)("text-2xl font-semibold leading-none tracking-tight",a),...c}));g.displayName="CardTitle";let h=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("p",{ref:e,className:(0,d.cn)("text-sm text-muted-foreground",a),...c}));h.displayName="CardDescription";let i=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("p-6 pt-0",a),...c}));i.displayName="CardContent",c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex items-center p-6 pt-0",a),...c})).displayName="CardFooter",a.s(["Card",()=>e,"CardContent",()=>i,"CardDescription",()=>h,"CardHeader",()=>f,"CardTitle",()=>g])},15618,a=>{"use strict";let b=(0,a.i(70106).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);a.s(["Plus",()=>b],15618)},77994,a=>{"use strict";var b=a.i(72131);function c(a){let c=b.useRef({value:a,previous:a});return b.useMemo(()=>(c.current.value!==a&&(c.current.previous=c.current.value,c.current.value=a),c.current.previous),[a])}a.s(["usePrevious",()=>c])},5784,a=>{"use strict";let b=(0,a.i(70106).default)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);a.s(["ChevronDown",()=>b],5784)},13749,a=>{"use strict";let b=(0,a.i(70106).default)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);a.s(["ChevronLeft",()=>b],13749)},24355,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(91119),e=a.i(99570),f=a.i(80701),g=a.i(13749),h=a.i(50522),i=a.i(15618);let j=(0,a.i(70106).default)("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]);var k=a.i(23292),l=a.i(95445);function m(){let[a,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)(25),[p,q]=(0,c.useState)(1),[r,s]=(0,c.useState)(0),[t,u]=(0,c.useState)(""),[v,w]=(0,c.useState)([]),[x,y]=(0,c.useState)(!0),[z,A]=(0,c.useState)(0);(0,c.useEffect)(()=>{m(!0),(0,l.createClient)().auth.getUser().then(({data:{user:a}})=>{a?.email&&u(a.email)})},[]);let B=(0,c.useCallback)(async a=>{if(a)try{let a=await fetch("/api/profile/balance");if(a.ok){let b=await a.json();b.success&&s(b.balance||0)}else 401===a.status&&console.error("Unauthorized - user not authenticated")}catch(a){console.error("Error loading balance:",a)}},[]),C=(0,c.useCallback)(async(a,b,c)=>{if(!a)return void y(!1);try{y(!0);let a=await fetch(`/api/credit/transactions?page=${b}&limit=${c}`);if(a.ok){let b=await a.json();b.success&&(w(b.transactions||[]),A(b.total||0))}else 401===a.status&&console.error("Unauthorized - user not authenticated")}catch(a){console.error("Error loading transactions:",a)}finally{y(!1)}},[]),D=(0,c.useCallback)(async a=>{if(a)try{let b=await fetch("/api/credit/retry",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(b.ok){let c=await b.json();if(c.success&&c.results&&c.results.length>0){let b=c.results.filter(a=>a.success).length;b>0&&(k.toast.success(`Credited ${b} pending purchase(s) to your account!`),B(a),C(a,p,n))}}else 401===b.status&&console.error("Unauthorized - user not authenticated")}catch(a){console.error("Error checking pending credits:",a)}},[B,C,p,n]);(0,c.useEffect)(()=>{t&&(B(t),C(t,p,n),D(t))},[t,p,n,B,C,D]),(0,c.useEffect)(()=>{if(!t)return;let a=0,b=setInterval(()=>{++a<=4?(D(t),B(t),C(t,p,n)):clearInterval(b)},3e4);return()=>clearInterval(b)},[t,p,n,B,C,D]);let E=Math.ceil(z/n)||1,F=0===z?0:(p-1)*n+1,G=Math.min(p*n,z);return(0,b.jsxs)("div",{className:"space-y-4 sm:space-y-6 w-full max-w-full overflow-x-hidden",children:[(0,b.jsx)("div",{children:(0,b.jsx)("h1",{className:"text-2xl sm:text-3xl md:text-4xl font-bold",children:"ShaleanCred"})}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center",children:[(0,b.jsxs)(e.Button,{variant:"default",size:"lg",className:"bg-primary-light hover:bg-primary-light/90 text-primary font-semibold h-auto py-4 px-6 text-lg",onClick:()=>{window.location.href="/dashboard/shaleancred/buy"},children:[(0,b.jsx)(i.Plus,{className:"h-5 w-5 mr-2"}),"Buy ShaleanCred"]}),(0,b.jsxs)(d.Card,{className:"flex-1 sm:max-w-sm",children:[(0,b.jsx)(d.CardHeader,{className:"pb-2",children:(0,b.jsx)(d.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"ShaleanCred Balance"})}),(0,b.jsxs)(d.CardContent,{className:"flex items-center gap-3",children:[(0,b.jsx)(j,{className:"h-6 w-6 text-muted-foreground"}),(0,b.jsxs)("span",{className:"text-2xl font-bold",children:["R",r.toFixed(2)]})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("div",{className:"flex items-center gap-2",children:a?(0,b.jsxs)(f.Select,{value:n.toString(),onValueChange:a=>{let b=Number(a);o(b),q(1),t&&C(t,1,b)},children:[(0,b.jsx)(f.SelectTrigger,{className:"w-[120px] h-9",children:(0,b.jsx)(f.SelectValue,{})}),(0,b.jsxs)(f.SelectContent,{children:[(0,b.jsx)(f.SelectItem,{value:"10",children:"10 Items"}),(0,b.jsx)(f.SelectItem,{value:"25",children:"25 Items"}),(0,b.jsx)(f.SelectItem,{value:"50",children:"50 Items"}),(0,b.jsx)(f.SelectItem,{value:"100",children:"100 Items"})]})]}):(0,b.jsx)("div",{className:"w-[120px] h-9 flex items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm",children:(0,b.jsxs)("span",{children:[n," Items"]})})}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(e.Button,{variant:"default",size:"sm",onClick:()=>{if(p>1){let a=p-1;q(a),t&&C(t,a,n)}},disabled:1===p,className:"h-9",children:(0,b.jsx)(g.ChevronLeft,{className:"h-4 w-4"})}),(0,b.jsx)("span",{className:"text-sm text-muted-foreground px-2",children:p}),(0,b.jsx)(e.Button,{variant:"default",size:"sm",onClick:()=>{if(p<E){let a=p+1;q(a),t&&C(t,a,n)}},disabled:p>=E,className:"h-9",children:(0,b.jsx)(h.ChevronRight,{className:"h-4 w-4"})})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{children:"Transaction History"})}),(0,b.jsx)(d.CardContent,{children:x?(0,b.jsx)("div",{className:"py-12 text-center",children:(0,b.jsx)("p",{className:"text-muted-foreground",children:"Loading transactions..."})}):0===z?(0,b.jsx)("div",{className:"py-12 text-center",children:(0,b.jsx)("p",{className:"text-muted-foreground",children:"No transactions to display"})}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b",children:[(0,b.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-sm",children:"Date"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-sm",children:"Description"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-sm",children:"Type"}),(0,b.jsx)("th",{className:"text-right py-3 px-4 font-semibold text-sm",children:"Amount"}),(0,b.jsx)("th",{className:"text-right py-3 px-4 font-semibold text-sm",children:"Balance After"}),(0,b.jsx)("th",{className:"text-center py-3 px-4 font-semibold text-sm",children:"Status"})]})}),(0,b.jsx)("tbody",{children:v.map(a=>(0,b.jsxs)("tr",{className:"border-b hover:bg-accent/50",children:[(0,b.jsx)("td",{className:"py-3 px-4 text-sm text-muted-foreground",children:new Date(a.date).toLocaleDateString("en-ZA",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),(0,b.jsx)("td",{className:"py-3 px-4 text-sm",children:a.description}),(0,b.jsxs)("td",{className:"py-3 px-4 text-sm",children:[(0,b.jsx)("span",{className:`font-medium ${"credit"===a.type?"text-green-600":"text-red-600"}`,children:"credit"===a.type?"+":"-"}),"purchase"===a.transactionType&&" Purchase","usage"===a.transactionType&&" Usage","refund"===a.transactionType&&" Refund","referral_reward"===a.transactionType&&" Referral Reward"]}),(0,b.jsx)("td",{className:"py-3 px-4 text-sm text-right font-medium",children:(0,b.jsxs)("span",{className:"credit"===a.type?"text-green-600":"text-red-600",children:["credit"===a.type?"+":"-","R",a.amount.toFixed(2)]})}),(0,b.jsxs)("td",{className:"py-3 px-4 text-sm text-right text-muted-foreground",children:["R",a.balanceAfter.toFixed(2)]}),(0,b.jsx)("td",{className:"py-3 px-4 text-sm text-center",children:(a=>{switch(a){case"completed":return(0,b.jsx)("span",{className:"px-2 py-1 text-xs rounded-full bg-green-100 text-green-800",children:"Completed"});case"pending":return(0,b.jsx)("span",{className:"px-2 py-1 text-xs rounded-full bg-yellow-100 text-yellow-800",children:"Pending"});case"failed":return(0,b.jsx)("span",{className:"px-2 py-1 text-xs rounded-full bg-red-100 text-red-800",children:"Failed"});default:return(0,b.jsx)("span",{className:"px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-800",children:a})}})(a.paymentStatus)})]},a.id))})]})}),z>0&&(0,b.jsxs)("div",{className:"mt-4 text-sm text-muted-foreground text-center",children:["Showing ",F," to ",G," of ",z," transactions"]})]})})]})]})}a.s(["default",()=>m],24355)}];

//# sourceMappingURL=_555e2874._.js.map