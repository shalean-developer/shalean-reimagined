module.exports=[29789,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(33217),e=a.i(91119),f=a.i(99570),g=a.i(24987),h=a.i(96221),i=a.i(15618),j=a.i(23292),k=a.i(5050);let l=(0,k.createServerReference)("60c1b9bbbf0512ba645ad27bb23d69b431ccf214be",k.callServer,void 0,k.findSourceMapURL,"getCustomerLocations"),m=(0,k.createServerReference)("7006f6a543fd1e64a5a18d4b6997a274e04d8e8dec",k.callServer,void 0,k.findSourceMapURL,"createLocation"),n=(0,k.createServerReference)("6010ca52506169326b0ec9bef8267d64a7b180aff9",k.callServer,void 0,k.findSourceMapURL,"updateLocation"),o=(0,k.createServerReference)("40c8a733504bc3047640235398c947b14237259298",k.callServer,void 0,k.findSourceMapURL,"deleteLocation"),p=(0,k.createServerReference)("70acd45e560818e6fd33363f4c63d3d03f35846906",k.callServer,void 0,k.findSourceMapURL,"setDefaultLocation");var q=a.i(60090),r=a.i(86304);let s=(0,a.i(70106).default)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);var t=a.i(81560),u=a.i(21374);function v({location:a,onEdit:c,onDelete:d,onSetDefault:h,isDeleting:i=!1}){let j=[a.address,a.apt_unit,a.suburb,a.city,a.postal_code].filter(Boolean).join(", ");return(0,b.jsxs)(e.Card,{className:"hover:shadow-md transition-shadow border-border w-full max-w-full overflow-hidden",children:[(0,b.jsx)(e.CardHeader,{className:"pb-2 px-3 py-3 sm:px-4 sm:py-4 md:px-6 md:py-6",children:(0,b.jsx)("div",{className:"flex items-start justify-between gap-2",children:(0,b.jsx)("div",{className:"flex-1 min-w-0",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("h3",{className:"font-semibold text-base sm:text-lg md:text-xl truncate",children:a.nickname}),a.is_default&&(0,b.jsxs)(r.Badge,{className:"bg-primary text-primary-foreground text-xs sm:text-sm px-2 sm:px-3 py-0.5",children:[(0,b.jsx)(u.Star,{className:"w-3 h-3 mr-1"}),"Default"]})]})})})}),(0,b.jsx)(e.CardContent,{className:"px-3 pb-3 sm:px-4 sm:pb-4 md:px-6 md:pb-6 pt-0",children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-start gap-1.5 sm:gap-2 text-sm sm:text-base",children:[(0,b.jsx)(g.MapPin,{className:"w-4 h-4 sm:w-5 sm:h-5 text-muted-foreground mt-0.5 flex-shrink-0"}),(0,b.jsx)("span",{className:"text-muted-foreground break-words leading-relaxed",children:j})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2 pt-2 border-t border-border",children:[!a.is_default&&(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",onClick:()=>h(a.id),className:"text-xs sm:text-sm h-8 sm:h-9",disabled:i,children:[(0,b.jsx)(u.Star,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1.5"}),"Set Default"]}),(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",onClick:()=>c(a),className:"text-xs sm:text-sm h-8 sm:h-9",disabled:i,children:[(0,b.jsx)(s,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1.5"}),"Edit"]}),(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",onClick:()=>d(a.id),className:"text-xs sm:text-sm h-8 sm:h-9 text-destructive hover:text-destructive",disabled:i,children:[(0,b.jsx)(t.Trash2,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1.5"}),"Delete"]})]})]})})]})}var w=a.i(66718),x=a.i(70430),y=a.i(15055);function z({initialData:a,onSubmit:d,onCancel:i,isLoading:j=!1}){let[k,l]=(0,c.useState)({nickname:a?.nickname||"",address:a?.address||"",apt_unit:a?.apt_unit||"",suburb:a?.suburb||"",city:a?.city||"",postal_code:a?.postal_code||"",is_default:a?.is_default||!1}),m=async a=>{if(a.preventDefault(),!k.nickname.trim()||!k.address.trim()||!k.suburb.trim()||!k.city.trim())return;let b={nickname:k.nickname.trim(),address:k.address.trim(),apt_unit:k.apt_unit.trim()||null,suburb:k.suburb.trim(),city:k.city.trim(),postal_code:k.postal_code.trim()||null,is_default:k.is_default};await d(b)},n=(a,b)=>{l(c=>({...c,[a]:b}))};return(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsxs)(e.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(g.MapPin,{className:"w-5 h-5"}),a?"Edit Location":"Add New Location"]}),(0,b.jsx)(e.CardDescription,{children:a?"Update your location details below.":"Save a location for quick access when booking services."})]}),(0,b.jsx)(e.CardContent,{children:(0,b.jsxs)("form",{onSubmit:m,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(x.Label,{htmlFor:"nickname",children:"Nickname *"}),(0,b.jsx)(w.Input,{id:"nickname",placeholder:"e.g., Home, Office, Apartment",value:k.nickname,onChange:a=>n("nickname",a.target.value),required:!0,disabled:j})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(x.Label,{htmlFor:"address",children:"Street Address *"}),(0,b.jsx)(w.Input,{id:"address",placeholder:"123 Main Street",value:k.address,onChange:a=>n("address",a.target.value),required:!0,disabled:j})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(x.Label,{htmlFor:"apt_unit",children:"Apartment/Unit"}),(0,b.jsx)(w.Input,{id:"apt_unit",placeholder:"Apt 4B, Unit 12, etc.",value:k.apt_unit,onChange:a=>n("apt_unit",a.target.value),disabled:j})]}),(0,b.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(x.Label,{htmlFor:"suburb",children:"Suburb *"}),(0,b.jsx)(w.Input,{id:"suburb",placeholder:"Sandton",value:k.suburb,onChange:a=>n("suburb",a.target.value),required:!0,disabled:j})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(x.Label,{htmlFor:"city",children:"City *"}),(0,b.jsx)(w.Input,{id:"city",placeholder:"Johannesburg",value:k.city,onChange:a=>n("city",a.target.value),required:!0,disabled:j})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(x.Label,{htmlFor:"postal_code",children:"Postal Code"}),(0,b.jsx)(w.Input,{id:"postal_code",placeholder:"2196",value:k.postal_code,onChange:a=>n("postal_code",a.target.value),disabled:j})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2 pt-2",children:[(0,b.jsx)(y.Checkbox,{id:"is_default",checked:k.is_default,onCheckedChange:a=>n("is_default",!0===a),disabled:j}),(0,b.jsx)(x.Label,{htmlFor:"is_default",className:"text-sm font-normal cursor-pointer",children:"Set as default location"})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[i&&(0,b.jsx)(f.Button,{type:"button",variant:"outline",onClick:i,disabled:j,children:"Cancel"}),(0,b.jsx)(f.Button,{type:"submit",disabled:j,children:j?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),a?"Updating...":"Creating..."]}):a?"Update Location":"Create Location"})]})]})})]})}function A(){let[a,k]=(0,c.useState)(!0),[r,s]=(0,c.useState)(!1),[t,u]=(0,c.useState)(null),[w,x]=(0,c.useState)([]),[y,A]=(0,c.useState)(null),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)(null);(0,d.useQuery)({queryKey:["authenticated-user"],queryFn:async()=>{let a=await (0,q.getAuthenticatedUser)();return a.success&&a.email?(E(a.email),a.email):null},staleTime:3e5}),(0,c.useEffect)(()=>{(async()=>{if(!D)return k(!0);try{k(!0);let a=await l(D);a.success&&a.locations?x(a.locations):j.toast.error(a.error||"Failed to load locations")}catch(a){console.error("Error loading locations:",a),j.toast.error("An unexpected error occurred")}finally{k(!1)}})()},[D]);let F=async a=>{if(!D)return void j.toast.error("Please wait for authentication");try{s(!0);let b=await m(D,void 0,a);b.success&&b.location?(x(a=>[b.location,...a]),C(!1),A(null),j.toast.success("Location created successfully!")):j.toast.error(b.error||"Failed to create location")}catch(a){console.error("Error creating location:",a),j.toast.error("An unexpected error occurred")}finally{s(!1)}},G=async a=>{if(y)try{s(!0);let b=await n(y.id,a);b.success&&b.location?(x(a=>a.map(a=>a.id===y.id?b.location:a)),C(!1),A(null),j.toast.success("Location updated successfully!")):j.toast.error(b.error||"Failed to update location")}catch(a){console.error("Error updating location:",a),j.toast.error("An unexpected error occurred")}finally{s(!1)}},H=async a=>{if(confirm("Are you sure you want to delete this location?"))try{u(a);let b=await o(a);b.success?(x(b=>b.filter(b=>b.id!==a)),j.toast.success("Location deleted successfully!")):j.toast.error(b.error||"Failed to delete location")}catch(a){console.error("Error deleting location:",a),j.toast.error("An unexpected error occurred")}finally{u(null)}},I=async a=>{if(!D)return void j.toast.error("Please wait for authentication");try{let b=await p(a,D);b.success&&b.location?(x(b=>b.map(b=>({...b,is_default:b.id===a}))),j.toast.success("Default location updated!")):j.toast.error(b.error||"Failed to set default location")}catch(a){console.error("Error setting default location:",a),j.toast.error("An unexpected error occurred")}},J=a=>{A(a),C(!0)},K=()=>{A(null),C(!0)};return a||!D?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Locations"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Manage your saved locations"})]}),(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"flex items-center justify-center py-12",children:(0,b.jsx)(h.Loader2,{className:"w-8 h-8 animate-spin text-muted-foreground"})})})]}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Locations"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Manage your saved locations"})]}),!B&&(0,b.jsxs)(f.Button,{onClick:K,className:"flex items-center gap-2",children:[(0,b.jsx)(i.Plus,{className:"w-4 h-4"}),"Add Location"]})]}),(0,b.jsxs)("div",{className:"grid lg:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Saved Locations"}),0===w.length?(0,b.jsx)(e.Card,{children:(0,b.jsxs)(e.CardContent,{className:"flex flex-col items-center justify-center py-12",children:[(0,b.jsx)(g.MapPin,{className:"w-12 h-12 text-muted-foreground mb-4"}),(0,b.jsx)("p",{className:"text-muted-foreground text-center mb-4",children:"You don't have any saved locations yet."}),(0,b.jsxs)(f.Button,{onClick:K,variant:"outline",children:[(0,b.jsx)(i.Plus,{className:"w-4 h-4 mr-2"}),"Add Your First Location"]})]})}):(0,b.jsx)("div",{className:"space-y-3",children:w.map(a=>(0,b.jsx)(v,{location:a,onEdit:J,onDelete:H,onSetDefault:I,isDeleting:t===a.id},a.id))})]}),(0,b.jsx)("div",{className:"space-y-4",children:B?(0,b.jsx)(z,{initialData:y||void 0,onSubmit:y?G:F,onCancel:()=>{C(!1),A(null)},isLoading:r}):(0,b.jsx)(e.Card,{children:(0,b.jsxs)(e.CardContent,{className:"flex flex-col items-center justify-center py-12",children:[(0,b.jsx)(g.MapPin,{className:"w-12 h-12 text-muted-foreground mb-4"}),(0,b.jsx)("p",{className:"text-muted-foreground text-center",children:0===w.length?"Create a new location to get started":'Click "Add Location" to create a new location'})]})})})]})]})}a.s(["default",()=>A],29789)}];

//# sourceMappingURL=app_dashboard_locations_page_tsx_80930b3a._.js.map