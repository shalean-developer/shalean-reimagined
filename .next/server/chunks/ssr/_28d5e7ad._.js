module.exports=[91119,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(68114);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...c}));e.displayName="Card";let f=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex flex-col space-y-1.5 p-6",a),...c}));f.displayName="CardHeader";let g=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("h3",{ref:e,className:(0,d.cn)("text-2xl font-semibold leading-none tracking-tight",a),...c}));g.displayName="CardTitle";let h=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("p",{ref:e,className:(0,d.cn)("text-sm text-muted-foreground",a),...c}));h.displayName="CardDescription";let i=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("p-6 pt-0",a),...c}));i.displayName="CardContent",c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex items-center p-6 pt-0",a),...c})).displayName="CardFooter",a.s(["Card",()=>e,"CardContent",()=>i,"CardDescription",()=>h,"CardHeader",()=>f,"CardTitle",()=>g])},99570,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(11011),e=a.i(187),f=a.i(68114);let g=(0,e.cva)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-lg text-sm font-semibold ring-offset-background transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-button hover:shadow-lg hover:-translate-y-0.5",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",hero:"bg-primary text-primary-foreground shadow-button hover:shadow-lg hover:-translate-y-0.5 hover:bg-primary/90",heroOutline:"border-2 border-primary bg-transparent text-primary hover:bg-primary hover:text-primary-foreground",cta:"bg-primary text-primary-foreground shadow-button hover:shadow-lg hover:-translate-y-1 hover:bg-primary/90"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-12 rounded-lg px-6",xl:"h-14 rounded-xl px-8 text-base",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),h=c.forwardRef(({className:a,variant:c,size:e,asChild:h=!1,...i},j)=>{let k=h?d.Slot:"button";return(0,b.jsx)(k,{className:(0,f.cn)(g({variant:c,size:e,className:a})),ref:j,...i})});h.displayName="Button",a.s(["Button",()=>h,"buttonVariants",()=>g])},96221,a=>{"use strict";let b=(0,a.i(70106).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],96221)},52100,a=>{"use strict";var b=function(){return(b=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)};function c(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&0>b.indexOf(d)&&(c[d]=a[d]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++)0>b.indexOf(d[e])&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]]);return c}function d(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d.throw(a))}catch(a){f(a)}}function i(a){var b;a.done?e(a.value):((b=a.value)instanceof c?b:new c(function(a){a(b)})).then(g,h)}i((d=d.apply(a,b||[])).next())})}function e(a,b,c){if(c||2==arguments.length)for(var d,e=0,f=b.length;e<f;e++)!d&&e in b||(d||(d=Array.prototype.slice.call(b,0,e)),d[e]=b[e]);return a.concat(d||Array.prototype.slice.call(b))}"function"==typeof SuppressedError&&SuppressedError,a.s(["__assign",()=>b,"__awaiter",()=>d,"__rest",()=>c,"__spreadArray",()=>e])},66718,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(68114);let e=c.forwardRef(({className:a,type:c,...e},f)=>(0,b.jsx)("input",{type:c,className:(0,d.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:f,...e}));e.displayName="Input",a.s(["Input",()=>e])},70430,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(30553),e=c.forwardRef((a,c)=>(0,b.jsx)(d.Primitive.label,{...a,ref:c,onMouseDown:b=>{b.target.closest("button, input, select, textarea")||(a.onMouseDown?.(b),!b.defaultPrevented&&b.detail>1&&b.preventDefault())}}));e.displayName="Label";var f=a.i(187),g=a.i(68114);let h=(0,f.cva)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),i=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)(e,{ref:d,className:(0,g.cn)(h(),a),...c}));i.displayName=e.displayName,a.s(["Label",()=>i],70430)},34604,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(95445);async function f(a,b){try{let c=a.trim(),d=b.trim();if(!c||!d)return{success:!1,error:"Phone number and password are required"};let f=c.replace(/\s+/g,"");f.startsWith("+")||(f=f.startsWith("0")?`+27${f.substring(1)}`:`+27${f}`);let g=f.replace(/\+/g,""),h=`${g}@cleaners.shalean.local`,i=(0,e.createClient)();console.log("[Cleaner Auth] Attempting login:",{inputPhone:c,normalizedPhone:f,phoneForEmail:g,authEmail:h,passwordLength:d.length,passwordFirst3:d.substring(0,3)});let{data:j,error:k}=await i.auth.signInWithPassword({email:h,password:d});if(k){if(console.error("[Cleaner Auth] Authentication failed:",{errorCode:k.status,errorMessage:k.message,attemptedEmail:h,normalizedPhone:f,phoneForEmail:g}),k.message?.includes("Invalid login credentials")||400===k.status)return{success:!1,error:"Invalid phone number or password. Please check your credentials and try again."};return{success:!1,error:k.message||"Invalid phone number or password"}}if(!j.user)return{success:!1,error:"Authentication failed"};let{data:l,error:m}=await i.from("cleaners").select("*").eq("phone",f).eq("is_active",!0).maybeSingle();if(m||!l)return await i.auth.signOut(),{success:!1,error:"Cleaner profile not found"};if(!l.auth_user_id){let{error:a}=await i.from("cleaners").update({auth_user_id:j.user.id}).eq("id",l.id);a&&console.warn("Could not update auth_user_id:",a)}return{success:!0,cleaner:l}}catch(a){return console.error("Error in authenticateCleanerClient:",a),{success:!1,error:a instanceof Error?a.message:"Authentication failed"}}}var g=a.i(99570),h=a.i(66718),i=a.i(70430),j=a.i(91119),k=a.i(96221),l=a.i(70106);let m=(0,l.default)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),n=(0,l.default)("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var o=a.i(23292);function p(){let a=(0,d.useRouter)(),e=(0,d.useSearchParams)(),[l,p]=(0,c.useState)(""),[q,r]=(0,c.useState)(""),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)(!1),w=e.get("redirect")||"/cleaner",x=async b=>{b.preventDefault(),t(!0);try{let b=l.trim(),c=q.trim();if(!b||!c){o.toast.error("Please enter both phone number and password"),t(!1);return}let d=await f(b,c);if(!d.success){o.toast.error(d.error||"Failed to sign in"),t(!1);return}d.cleaner&&(o.toast.success("Signed in successfully"),a.push(w),a.refresh())}catch(a){console.error("Login error:",a),o.toast.error("An unexpected error occurred. Please try again."),t(!1)}};return(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center p-4 bg-muted/30",children:(0,b.jsxs)(j.Card,{className:"w-full max-w-md",children:[(0,b.jsxs)(j.CardHeader,{className:"space-y-1",children:[(0,b.jsx)(j.CardTitle,{className:"text-2xl font-bold text-center",children:"Cleaner Login"}),(0,b.jsx)(j.CardDescription,{className:"text-center",children:"Sign in with your phone number and password"})]}),(0,b.jsxs)(j.CardContent,{children:[(0,b.jsxs)("form",{onSubmit:x,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{htmlFor:"phone",children:"Phone Number"}),(0,b.jsx)(h.Input,{id:"phone",type:"tel",placeholder:"0824644655 or +27824644655",value:l,onChange:a=>p(a.target.value),required:!0,disabled:s,autoComplete:"tel"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Enter your phone number (e.g., 0824644655 or +27824644655)"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{htmlFor:"password",children:"Password"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(h.Input,{id:"password",type:u?"text":"password",placeholder:"••••••••",value:q,onChange:a=>r(a.target.value),required:!0,disabled:s,autoComplete:"current-password",className:"pr-10"}),(0,b.jsx)(g.Button,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>v(!u),disabled:s,children:u?(0,b.jsx)(n,{className:"h-4 w-4 text-muted-foreground"}):(0,b.jsx)(m,{className:"h-4 w-4 text-muted-foreground"})})]})]}),(0,b.jsx)(g.Button,{type:"submit",className:"w-full",disabled:s,children:s?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Signing in..."]}):"Sign in"})]}),(0,b.jsxs)("div",{className:"mt-4 text-center text-sm",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Need help? "}),(0,b.jsx)("span",{className:"text-muted-foreground",children:"Contact your administrator"})]})]})]})})}function q(){return(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center p-4 bg-muted/30",children:(0,b.jsxs)(j.Card,{className:"w-full max-w-md",children:[(0,b.jsxs)(j.CardHeader,{className:"space-y-1",children:[(0,b.jsx)(j.CardTitle,{className:"text-2xl font-bold text-center",children:"Cleaner Login"}),(0,b.jsx)(j.CardDescription,{className:"text-center",children:"Sign in with your phone number and password"})]}),(0,b.jsx)(j.CardContent,{children:(0,b.jsx)("div",{className:"flex justify-center py-8",children:(0,b.jsx)(k.Loader2,{className:"h-6 w-6 animate-spin text-muted-foreground"})})})]})}),children:(0,b.jsx)(p,{})})}a.s(["default",()=>q],34604)}];

//# sourceMappingURL=_28d5e7ad._.js.map